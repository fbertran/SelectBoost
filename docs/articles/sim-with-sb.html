<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulation Tools Provided With the Selectboost Package • SelectBoost</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Simulation Tools Provided With the Selectboost Package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SelectBoost</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/benchmarking-selectboost-networks.html">Benchmarking the SelectBoost Package for Network Reverse Engineering</a>
    </li>
    <li>
      <a href="../articles/confidence-indices-Cascade-networks.html">Towards confidence estimates in Cascade Networks using the SelectBoost package</a>
    </li>
    <li>
      <a href="../articles/sim-with-sb.html">Simulation Tools Provided With the Selectboost Package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fbertran/SelectBoost">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Simulation Tools Provided With the Selectboost Package</h1>
                        <h4 class="author">Frédéric Bertrand</h4>
            <address class="author_afil">
      Université de Strasbourg and CNRS<br><a class="author_email" href="mailto:#"></a><a href="mailto:frederic.bertrand@math.unistra.fr" class="email">frederic.bertrand@math.unistra.fr</a>
      </address>
                  
            <h4 class="date">2019-05-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/fbertran/SelectBoost/blob/master/vignettes/sim-with-sb.Rmd"><code>vignettes/sim-with-sb.Rmd</code></a></small>
      <div class="hidden name"><code>sim-with-sb.Rmd</code></div>

    </div>

    
    
<div id="contents" class="section level1">
<h1 class="hasAnchor">
<a href="#contents" class="anchor"></a>Contents</h1>
<p>This vignette details the simulations tools provided with the selectboost package by providing five examples of use.</p>
<p>If you are a Linux/Unix or a Macos user, you can install a version of SelectBoost with support for <code>doMC</code> from <a href="https://github.com">github</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"fbertran/SelectBoost"</span>, <span class="dt">ref =</span> <span class="st">"doMC"</span>)</a></code></pre></div>
</div>
<div id="first-example" class="section level1">
<h1 class="hasAnchor">
<a href="#first-example" class="anchor"></a>First example</h1>
<div id="aim" class="section level2">
<h2 class="hasAnchor">
<a href="#aim" class="anchor"></a>Aim</h2>
<p>We want to creates <span class="math inline">\(NDatasets=200\)</span> datasets with <span class="math inline">\(\textrm{length}(group)=10\)</span> variables and <span class="math inline">\(N=10\)</span> observations. In that example we want <span class="math inline">\(9\)</span> groups:</p>
<ul>
<li>
<span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_{10}\)</span> belong to the first group and the intra-group Pearson correlation for this group is equal to <span class="math inline">\(.95\)</span>,</li>
<li>
<span class="math inline">\(x_2\)</span> belongs to the second group,</li>
<li>
<span class="math inline">\(x_3\)</span> belongs to the third group,</li>
<li>…</li>
<li>
<span class="math inline">\(x_9\)</span> belongs to the ninth group.</li>
</ul>
</div>
<div id="correlation-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#correlation-structure" class="anchor"></a>Correlation structure</h2>
<p>The correlation structure of the explanatory variables of the dataset is provided by <code>group</code> and the intra-group Pearson correlation value for each of the groups by <code>cor_group</code>. A value must be provided even for single variable groups and the number of variables is length of the <code>group</code> vector. Use the <code>simulation_cor</code> function to create the correlation matrix (<code>CM</code>).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(SelectBoost)</a>
<a class="sourceLine" id="cb2-2" title="2">group&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>,<span class="dv">1</span>) <span class="co">#10 variables</span></a>
<a class="sourceLine" id="cb2-3" title="3">cor_group&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="fl">0.95</span>,<span class="dv">9</span>)</a>
<a class="sourceLine" id="cb2-4" title="4">CM&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_cor</a></span>(group,cor_group)</a>
<a class="sourceLine" id="cb2-5" title="5">CM</a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt;  [1,] 1.00    0    0    0    0    0    0    0    0  0.95</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt;  [2,] 0.00    1    0    0    0    0    0    0    0  0.00</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt;  [3,] 0.00    0    1    0    0    0    0    0    0  0.00</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt;  [4,] 0.00    0    0    1    0    0    0    0    0  0.00</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt;  [5,] 0.00    0    0    0    1    0    0    0    0  0.00</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt;  [6,] 0.00    0    0    0    0    1    0    0    0  0.00</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt;  [7,] 0.00    0    0    0    0    0    1    0    0  0.00</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">#&gt;  [8,] 0.00    0    0    0    0    0    0    1    0  0.00</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">#&gt;  [9,] 0.00    0    0    0    0    0    0    0    1  0.00</span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co">#&gt; [10,] 0.95    0    0    0    0    0    0    0    0  1.00</span></a></code></pre></div>
</div>
<div id="explanatory-dataset-generation" class="section level2">
<h2 class="hasAnchor">
<a href="#explanatory-dataset-generation" class="anchor"></a>Explanatory dataset generation</h2>
<p>Then generation of an explanatory dataset with <span class="math inline">\(N=10\)</span> observations is made by the <code>simulation_X</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">3141</span>)</a>
<a class="sourceLine" id="cb3-2" title="2">N&lt;-<span class="dv">10</span></a>
<a class="sourceLine" id="cb3-3" title="3">X&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_X</a></span>(N,CM)</a>
<a class="sourceLine" id="cb3-4" title="4">X</a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt;              [,1]       [,2]        [,3]       [,4]        [,5]</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt;  [1,]  0.69029599 -1.7343187  0.38993973  0.7530345  0.73462394</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt;  [2,] -0.55429733  1.5236359 -0.44435298 -0.8293970  0.02137105</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt;  [3,] -0.65277340 -0.2365804 -0.33365748  1.6144115 -1.38882044</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt;  [4,]  0.06979050 -0.1798988 -0.01576611 -1.6377538 -0.85286458</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt;  [5,] -0.58450206 -1.7411024 -0.13801223 -0.4512545 -0.14449068</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt;  [6,] -1.26045088  0.2087882 -0.72491869  0.6856348 -0.43163916</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt;  [7,]  0.03836372  0.4497529 -0.14266131 -0.6019886  1.36552523</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt;  [8,] -0.52083678 -0.7626927  0.12068723 -1.6146444  0.79777307</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt;  [9,]  0.30631735  0.9848562 -0.73193720 -1.2236526 -0.59785470</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt; [10,] -1.67366702  0.8709858 -0.80617294 -0.7559627  1.76655800</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt;              [,6]        [,7]       [,8]       [,9]       [,10]</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">#&gt;  [1,]  1.91645527  0.23481727 -0.2019611 -1.0254989  0.97524648</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">#&gt;  [2,]  1.62014297 -0.11230652  1.7600720  1.4330532 -0.46696929</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">#&gt;  [3,]  1.18979400  1.80315380 -0.7423216 -0.3679811 -0.83315697</span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="co">#&gt;  [4,]  0.07352177 -0.30160066  0.6676371  2.0313025 -0.07749897</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="co">#&gt;  [5,] -0.77910581  0.04835639  0.8040776 -0.2039855 -0.75413152</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="co">#&gt;  [6,] -1.62517684  0.56503309 -0.1387350 -0.4091602 -1.09688456</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co">#&gt;  [7,]  0.14761767  1.17868940  0.5279960 -0.5626160 -0.09706896</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="co">#&gt;  [8,]  2.41326136 -1.64916614 -0.6481176  1.7608488 -0.69320924</span></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="co">#&gt;  [9,] -0.13138414 -0.44649730  0.4507879  1.4486604  0.60032266</span></a>
<a class="sourceLine" id="cb3-26" title="26"><span class="co">#&gt; [10,]  0.58235105 -1.48612450  0.1245139 -0.9288625 -1.10028291</span></a></code></pre></div>
</div>
<div id="response-derivation" class="section level2">
<h2 class="hasAnchor">
<a href="#response-derivation" class="anchor"></a>Response derivation</h2>
<p>A response can now be added to the dataset by the <code>simulation_Data</code> function. We have to specifiy the support of the response, i.e. the explanatory variables that will be used in the linear model created to compute the response. The support is given by the <code>supp</code> vector whose entries are either <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>. The length of the <code>supp</code> vector must be equal to the number of explanatory variables and if the <span class="math inline">\(i\)</span>entry is equal to <span class="math inline">\(1\)</span>, it means that the <span class="math inline">\(i\)</span>variable will be used to derive the response value, whereas if the <span class="math inline">\(i\)</span>entry is equal to <span class="math inline">\(0\)</span>, it means that the <span class="math inline">\(i\)</span>variable will not be used to derive the response value (<code>beta&lt;-rep(0,length(supp))</code>). The values of the coefficients for the explanatory variables that are in the support of the response are random (either absolute value and sign) and given by <code>beta[which(supp==1)]&lt;-runif(sum(supp),minB,maxB)*(rbinom(sum(supp),1,.5)*2-1)</code>. Hence, the user can specify their minimal absolute value with the <code>minB</code> option and their maximal absolute value with the <code>maxB</code> option. The <code>stn</code> option is a scaling factor for the noise added to the response vector (<code>(t(beta)%*%var(X)%*%beta)/stn</code>, with <code>X</code> the matrix of explanatory variables). The higher the <code>stn</code> value, the smaller the noise: for instance for a given <code>X</code> dataset, an <code>stn</code> value <span class="math inline">\(\alpha\)</span> times larger will result in a noise exactly <span class="math inline">\(\sqrt{\alpha}\)</span> times smaller.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">3141</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">supp&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb4-3" title="3">minB&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb4-4" title="4">maxB&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb4-5" title="5">stn&lt;-<span class="dv">50</span></a>
<a class="sourceLine" id="cb4-6" title="6">firstdataset=<span class="kw"><a href="../reference/simulation.html">simulation_DATA</a></span>(X,supp,minB,maxB,stn)</a>
<a class="sourceLine" id="cb4-7" title="7">firstdataset</a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#&gt; $X</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt;              [,1]       [,2]        [,3]       [,4]        [,5]</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt;  [1,]  0.69029599 -1.7343187  0.38993973  0.7530345  0.73462394</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#&gt;  [2,] -0.55429733  1.5236359 -0.44435298 -0.8293970  0.02137105</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">#&gt;  [3,] -0.65277340 -0.2365804 -0.33365748  1.6144115 -1.38882044</span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">#&gt;  [4,]  0.06979050 -0.1798988 -0.01576611 -1.6377538 -0.85286458</span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="co">#&gt;  [5,] -0.58450206 -1.7411024 -0.13801223 -0.4512545 -0.14449068</span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="co">#&gt;  [6,] -1.26045088  0.2087882 -0.72491869  0.6856348 -0.43163916</span></a>
<a class="sourceLine" id="cb4-16" title="16"><span class="co">#&gt;  [7,]  0.03836372  0.4497529 -0.14266131 -0.6019886  1.36552523</span></a>
<a class="sourceLine" id="cb4-17" title="17"><span class="co">#&gt;  [8,] -0.52083678 -0.7626927  0.12068723 -1.6146444  0.79777307</span></a>
<a class="sourceLine" id="cb4-18" title="18"><span class="co">#&gt;  [9,]  0.30631735  0.9848562 -0.73193720 -1.2236526 -0.59785470</span></a>
<a class="sourceLine" id="cb4-19" title="19"><span class="co">#&gt; [10,] -1.67366702  0.8709858 -0.80617294 -0.7559627  1.76655800</span></a>
<a class="sourceLine" id="cb4-20" title="20"><span class="co">#&gt;              [,6]        [,7]       [,8]       [,9]       [,10]</span></a>
<a class="sourceLine" id="cb4-21" title="21"><span class="co">#&gt;  [1,]  1.91645527  0.23481727 -0.2019611 -1.0254989  0.97524648</span></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="co">#&gt;  [2,]  1.62014297 -0.11230652  1.7600720  1.4330532 -0.46696929</span></a>
<a class="sourceLine" id="cb4-23" title="23"><span class="co">#&gt;  [3,]  1.18979400  1.80315380 -0.7423216 -0.3679811 -0.83315697</span></a>
<a class="sourceLine" id="cb4-24" title="24"><span class="co">#&gt;  [4,]  0.07352177 -0.30160066  0.6676371  2.0313025 -0.07749897</span></a>
<a class="sourceLine" id="cb4-25" title="25"><span class="co">#&gt;  [5,] -0.77910581  0.04835639  0.8040776 -0.2039855 -0.75413152</span></a>
<a class="sourceLine" id="cb4-26" title="26"><span class="co">#&gt;  [6,] -1.62517684  0.56503309 -0.1387350 -0.4091602 -1.09688456</span></a>
<a class="sourceLine" id="cb4-27" title="27"><span class="co">#&gt;  [7,]  0.14761767  1.17868940  0.5279960 -0.5626160 -0.09706896</span></a>
<a class="sourceLine" id="cb4-28" title="28"><span class="co">#&gt;  [8,]  2.41326136 -1.64916614 -0.6481176  1.7608488 -0.69320924</span></a>
<a class="sourceLine" id="cb4-29" title="29"><span class="co">#&gt;  [9,] -0.13138414 -0.44649730  0.4507879  1.4486604  0.60032266</span></a>
<a class="sourceLine" id="cb4-30" title="30"><span class="co">#&gt; [10,]  0.58235105 -1.48612450  0.1245139 -0.9288625 -1.10028291</span></a>
<a class="sourceLine" id="cb4-31" title="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-32" title="32"><span class="co">#&gt; $Y</span></a>
<a class="sourceLine" id="cb4-33" title="33"><span class="co">#&gt;  [1] -4.2132936  3.5039588  0.3332549 -0.4924011 -2.5391834  1.8674007</span></a>
<a class="sourceLine" id="cb4-34" title="34"><span class="co">#&gt;  [7]  0.6678607 -0.4589311  0.6353867  3.8091855</span></a>
<a class="sourceLine" id="cb4-35" title="35"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-36" title="36"><span class="co">#&gt; $support</span></a>
<a class="sourceLine" id="cb4-37" title="37"><span class="co">#&gt;  [1] 1 1 1 0 0 0 0 0 0 0</span></a>
<a class="sourceLine" id="cb4-38" title="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-39" title="39"><span class="co">#&gt; $beta</span></a>
<a class="sourceLine" id="cb4-40" title="40"><span class="co">#&gt;  [1] -1.754996  1.964992  1.041431  0.000000  0.000000  0.000000  0.000000</span></a>
<a class="sourceLine" id="cb4-41" title="41"><span class="co">#&gt;  [8]  0.000000  0.000000  0.000000</span></a>
<a class="sourceLine" id="cb4-42" title="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-43" title="43"><span class="co">#&gt; $stn</span></a>
<a class="sourceLine" id="cb4-44" title="44"><span class="co">#&gt; [1] 50</span></a>
<a class="sourceLine" id="cb4-45" title="45"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-46" title="46"><span class="co">#&gt; $sigma</span></a>
<a class="sourceLine" id="cb4-47" title="47"><span class="co">#&gt;           [,1]</span></a>
<a class="sourceLine" id="cb4-48" title="48"><span class="co">#&gt; [1,] 0.3493447</span></a>
<a class="sourceLine" id="cb4-49" title="49"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-50" title="50"><span class="co">#&gt; attr(,"class")</span></a>
<a class="sourceLine" id="cb4-51" title="51"><span class="co">#&gt; [1] "simuls"</span></a></code></pre></div>
</div>
<div id="multiple-datasets-and-checks" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-datasets-and-checks" class="anchor"></a>Multiple datasets and checks</h2>
<p>To generate multiple datasets, repeat steps 2 and 3, for instance use a <code>for</code> loop. We create <span class="math inline">\(NDatasets=200\)</span> datasets and assign them to the objects <code>DATA_exemple1_nb_1</code> to <code>DATA_exemple1_nb_200</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">3141</span>)</a>
<a class="sourceLine" id="cb5-2" title="2">NDatasets=<span class="dv">200</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb5-4" title="4">X&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_X</a></span>(N,CM)</a>
<a class="sourceLine" id="cb5-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/assign">assign</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>),<span class="kw"><a href="../reference/simulation.html">simulation_DATA</a></span>(X,supp,minB,maxB,stn))</a>
<a class="sourceLine" id="cb5-6" title="6">}</a></code></pre></div>
<p>We now check the correlation structure of the explanatory variable. First we compute the mean correlation matrix.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">corr_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb6-3" title="3">corr_sum=corr_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X)</a>
<a class="sourceLine" id="cb6-4" title="4">}</a>
<a class="sourceLine" id="cb6-5" title="5">corr_mean=corr_sum<span class="op">/</span>NDatasets</a></code></pre></div>
<p>Then we display and plot that the mean correlation matrix.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">corr_mean</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#&gt;                [,1]          [,2]          [,3]          [,4]         [,5]</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#&gt;  [1,]  1.0000000000 -0.0008611262  0.0193872629  0.0192496952 -0.012147407</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt;  [2,] -0.0008611262  1.0000000000 -0.0520800766  0.0144798781  0.006237499</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt;  [3,]  0.0193872629 -0.0520800766  1.0000000000  0.0008693002 -0.021373842</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt;  [4,]  0.0192496952  0.0144798781  0.0008693002  1.0000000000  0.007753693</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt;  [5,] -0.0121474071  0.0062374994 -0.0213738420  0.0077536931  1.000000000</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt;  [6,] -0.0089756967 -0.0404111300  0.0344817040  0.0081889675  0.018018674</span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#&gt;  [7,] -0.0082911544  0.0072612885 -0.0233188445 -0.0380192689  0.023833224</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">#&gt;  [8,]  0.0272233550 -0.0066654749 -0.0487035643  0.0172624295  0.043181249</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">#&gt;  [9,] -0.0145986545  0.0071146338  0.0364868095 -0.0020153080 -0.027733046</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">#&gt; [10,]  0.9422544272 -0.0071281448  0.0264886880  0.0221950354 -0.003811061</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#&gt;               [,6]         [,7]         [,8]         [,9]        [,10]</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="co">#&gt;  [1,] -0.008975697 -0.008291154  0.027223355 -0.014598655  0.942254427</span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">#&gt;  [2,] -0.040411130  0.007261289 -0.006665475  0.007114634 -0.007128145</span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="co">#&gt;  [3,]  0.034481704 -0.023318845 -0.048703564  0.036486809  0.026488688</span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="co">#&gt;  [4,]  0.008188968 -0.038019269  0.017262430 -0.002015308  0.022195035</span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="co">#&gt;  [5,]  0.018018674  0.023833224  0.043181249 -0.027733046 -0.003811061</span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="co">#&gt;  [6,]  1.000000000 -0.015449494 -0.004054573  0.006159349  0.003444504</span></a>
<a class="sourceLine" id="cb7-20" title="20"><span class="co">#&gt;  [7,] -0.015449494  1.000000000 -0.002105066  0.005052182 -0.018230902</span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co">#&gt;  [8,] -0.004054573 -0.002105066  1.000000000 -0.003169857  0.021688766</span></a>
<a class="sourceLine" id="cb7-22" title="22"><span class="co">#&gt;  [9,]  0.006159349  0.005052182 -0.003169857  1.000000000 -0.013388952</span></a>
<a class="sourceLine" id="cb7-23" title="23"><span class="co">#&gt; [10,]  0.003444504 -0.018230902  0.021688766 -0.013388952  1.000000000</span></a>
<a class="sourceLine" id="cb7-24" title="24"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(corr_mean))</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">coef_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb8-3" title="3">error_counter=<span class="dv">0</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb8-5" title="5">tempdf=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="dt">Y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y,</a>
<a class="sourceLine" id="cb8-6" title="6">                        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X))</a>
<a class="sourceLine" id="cb8-7" title="7">tempcoef=<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(Y<span class="op">~</span>.<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>tempdf))</a>
<a class="sourceLine" id="cb8-8" title="8"><span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(tempcoef)){</a>
<a class="sourceLine" id="cb8-9" title="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"Error in lm fit, skip coefficients</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb8-10" title="10">error_counter=error_counter<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb8-11" title="11">  } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb8-12" title="12">coef_sum=coef_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(tempcoef)</a>
<a class="sourceLine" id="cb8-13" title="13">}</a>
<a class="sourceLine" id="cb8-14" title="14">}</a>
<a class="sourceLine" id="cb8-15" title="15">error_counter</a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb8-17" title="17">coef_mean=coef_sum<span class="op">/</span>NDatasets</a></code></pre></div>
<p>All fits were sucessful. Then we display and plot that the mean coefficient vector values.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">coef_mean</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co">#&gt;           x1           x2           x3           x4           x5 </span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#&gt; 1.508327e+00 1.518967e+00 1.491694e+00 1.437883e-15 1.857978e-15 </span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#&gt;           x6           x7           x8           x9          x10 </span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">#&gt; 2.524863e-15 1.848380e-15 2.314167e-15 2.601342e-15 6.269818e-15</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_mean)</a>
<a class="sourceLine" id="cb9-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Reduce the noise in the response for the new responses by a factor <span class="math inline">\(\sqrt{5000/50}=10\)</span>. <span class="math inline">\(1/stn\cdot \beta_{support}^t\mathrm{Var}(X)\beta_{support}\)</span> where <span class="math inline">\(\beta_{support}\)</span> is the vector of coefficients wh</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">3141</span>)</a>
<a class="sourceLine" id="cb10-2" title="2">stn &lt;-<span class="st"> </span><span class="dv">5000</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb10-4" title="4">X&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_X</a></span>(N,CM)</a>
<a class="sourceLine" id="cb10-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/assign">assign</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_bis_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>),<span class="kw"><a href="../reference/simulation.html">simulation_DATA</a></span>(X,supp,minB,maxB,stn))</a>
<a class="sourceLine" id="cb10-6" title="6">}</a></code></pre></div>
<p>Since it is the same explanatory dataset for response generation, we can compare the <span class="math inline">\(\sigma\)</span> between those <span class="math inline">\(NDatasets=200\)</span> datasets.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">stn_ratios=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,NDatasets)</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb11-3" title="3">stn_ratios[i]&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>sigma<span class="op">/</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_bis_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>sigma</a>
<a class="sourceLine" id="cb11-5" title="5">}</a>
<a class="sourceLine" id="cb11-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all">all</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(stn_ratios,all.equal,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>All the ratios are equal to 10 as anticipated.</p>
<p>Since, the correlation structure is the same as before, we do not need to check it again. As befor, we infer the coefficients values of a linear model using the <code>lm</code> function.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">coef_sum_bis=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_sum_bis)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb12-3" title="3">error_counter_bis=<span class="dv">0</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb12-5" title="5">tempdf=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="dt">Y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_bis_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y,</a>
<a class="sourceLine" id="cb12-6" title="6">                        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_bis_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X))</a>
<a class="sourceLine" id="cb12-7" title="7">tempcoef=<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(Y<span class="op">~</span>.<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>tempdf))</a>
<a class="sourceLine" id="cb12-8" title="8"><span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(tempcoef)){</a>
<a class="sourceLine" id="cb12-9" title="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"Error in lm fit, skip coefficients</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb12-10" title="10">error_counter_bis=error_counte_bisr<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb12-11" title="11">  } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb12-12" title="12">coef_sum_bis=coef_sum_bis<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(tempcoef)</a>
<a class="sourceLine" id="cb12-13" title="13">}</a>
<a class="sourceLine" id="cb12-14" title="14">}</a>
<a class="sourceLine" id="cb12-15" title="15">error_counter_bis</a>
<a class="sourceLine" id="cb12-16" title="16"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb12-17" title="17">coef_mean_bis=coef_sum_bis<span class="op">/</span>NDatasets</a></code></pre></div>
<p>All fits were sucessful. Then we display and plot that the mean coefficient vector values. As expected, the noise reduction enhances the retrieval of the <code>true</code> mean coefficient absolute values by the models.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">coef_mean_bis</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co">#&gt;           x1           x2           x3           x4           x5 </span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="co">#&gt; 1.508327e+00 1.518967e+00 1.491694e+00 1.437883e-15 1.857978e-15 </span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co">#&gt;           x6           x7           x8           x9          x10 </span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="co">#&gt; 2.524863e-15 1.848380e-15 2.314167e-15 2.601342e-15 6.269818e-15</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_mean_bis)</a>
<a class="sourceLine" id="cb13-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>The simulation process looks sucessfull. What are the confidence indices for those variables?</p>
</div>
</div>
<div id="second-example" class="section level1">
<h1 class="hasAnchor">
<a href="#second-example" class="anchor"></a>Second example</h1>
<div id="aim-1" class="section level2">
<h2 class="hasAnchor">
<a href="#aim-1" class="anchor"></a>Aim</h2>
<p>We want to creates <span class="math inline">\(NDatasets=200\)</span> datasets with <span class="math inline">\(\textrm{length}(group)=50\)</span> variables and <span class="math inline">\(N=20\)</span> observations. In that example we want <span class="math inline">\(1\)</span> group:</p>
<ul>
<li>
<span class="math inline">\(x_1\)</span>, , <span class="math inline">\(x_{50}\)</span> belong to the same group and the intra-group Pearson correlation for this group is equal to <span class="math inline">\(.5\)</span>.</li>
<li>only the first five variables <span class="math inline">\(x_1\)</span>, , <span class="math inline">\(x_{5}\)</span> are explanatory variables for the response.</li>
</ul>
</div>
<div id="correlation-structure-1" class="section level2">
<h2 class="hasAnchor">
<a href="#correlation-structure-1" class="anchor"></a>Correlation structure</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">group&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">1</span>,<span class="dv">50</span>) <span class="co">#50 variables</span></a>
<a class="sourceLine" id="cb14-2" title="2">cor_group&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="fl">0.5</span>,<span class="dv">1</span>)</a></code></pre></div>
</div>
<div id="explanatory-variables-and-response" class="section level2">
<h2 class="hasAnchor">
<a href="#explanatory-variables-and-response" class="anchor"></a>Explanatory variables and response</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">3141</span>)</a>
<a class="sourceLine" id="cb15-2" title="2">N&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb15-3" title="3">supp&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="dv">45</span>))</a>
<a class="sourceLine" id="cb15-4" title="4">minB&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb15-5" title="5">maxB&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb15-6" title="6">stn&lt;-<span class="dv">50</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">200</span>){</a>
<a class="sourceLine" id="cb15-8" title="8">C&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_cor</a></span>(group,cor_group)</a>
<a class="sourceLine" id="cb15-9" title="9">X&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_X</a></span>(N,C)</a>
<a class="sourceLine" id="cb15-10" title="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/assign">assign</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple2_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>),<span class="kw"><a href="../reference/simulation.html">simulation_DATA</a></span>(X,supp,minB,maxB,stn))</a>
<a class="sourceLine" id="cb15-11" title="11">}</a></code></pre></div>
</div>
<div id="checks" class="section level2">
<h2 class="hasAnchor">
<a href="#checks" class="anchor"></a>Checks</h2>
<p>We now check the correlation structure of the explanatory variable. First we compute the mean correlation matrix.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">corr_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb16-3" title="3">corr_sum=corr_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple2_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X)</a>
<a class="sourceLine" id="cb16-4" title="4">}</a>
<a class="sourceLine" id="cb16-5" title="5">corr_mean=corr_sum<span class="op">/</span>NDatasets</a></code></pre></div>
<p>Then we display and plot that the mean correlation matrix.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">corr_mean[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co">#&gt;            [,1]      [,2]      [,3]      [,4]      [,5]      [,6]</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co">#&gt;  [1,] 1.0000000 0.4875195 0.4774265 0.4739869 0.4796578 0.4927521</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co">#&gt;  [2,] 0.4875195 1.0000000 0.4750680 0.4940743 0.4842295 0.4988293</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="co">#&gt;  [3,] 0.4774265 0.4750680 1.0000000 0.4799584 0.4690139 0.4831884</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">#&gt;  [4,] 0.4739869 0.4940743 0.4799584 1.0000000 0.4990798 0.4995625</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">#&gt;  [5,] 0.4796578 0.4842295 0.4690139 0.4990798 1.0000000 0.4890548</span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="co">#&gt;  [6,] 0.4927521 0.4988293 0.4831884 0.4995625 0.4890548 1.0000000</span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="co">#&gt;  [7,] 0.4898313 0.4937678 0.4765315 0.4928739 0.4839137 0.4980120</span></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="co">#&gt;  [8,] 0.4786241 0.4904904 0.4871110 0.4799335 0.4807772 0.5015775</span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="co">#&gt;  [9,] 0.4821186 0.4801270 0.4648431 0.4774361 0.4657147 0.4942747</span></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="co">#&gt; [10,] 0.4875410 0.4690954 0.4669033 0.4832185 0.4781301 0.4873754</span></a>
<a class="sourceLine" id="cb17-13" title="13"><span class="co">#&gt;            [,7]      [,8]      [,9]     [,10]</span></a>
<a class="sourceLine" id="cb17-14" title="14"><span class="co">#&gt;  [1,] 0.4898313 0.4786241 0.4821186 0.4875410</span></a>
<a class="sourceLine" id="cb17-15" title="15"><span class="co">#&gt;  [2,] 0.4937678 0.4904904 0.4801270 0.4690954</span></a>
<a class="sourceLine" id="cb17-16" title="16"><span class="co">#&gt;  [3,] 0.4765315 0.4871110 0.4648431 0.4669033</span></a>
<a class="sourceLine" id="cb17-17" title="17"><span class="co">#&gt;  [4,] 0.4928739 0.4799335 0.4774361 0.4832185</span></a>
<a class="sourceLine" id="cb17-18" title="18"><span class="co">#&gt;  [5,] 0.4839137 0.4807772 0.4657147 0.4781301</span></a>
<a class="sourceLine" id="cb17-19" title="19"><span class="co">#&gt;  [6,] 0.4980120 0.5015775 0.4942747 0.4873754</span></a>
<a class="sourceLine" id="cb17-20" title="20"><span class="co">#&gt;  [7,] 1.0000000 0.4766888 0.4786140 0.4825714</span></a>
<a class="sourceLine" id="cb17-21" title="21"><span class="co">#&gt;  [8,] 0.4766888 1.0000000 0.4783224 0.4832658</span></a>
<a class="sourceLine" id="cb17-22" title="22"><span class="co">#&gt;  [9,] 0.4786140 0.4783224 1.0000000 0.4769654</span></a>
<a class="sourceLine" id="cb17-23" title="23"><span class="co">#&gt; [10,] 0.4825714 0.4832658 0.4769654 1.0000000</span></a>
<a class="sourceLine" id="cb17-24" title="24"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(corr_mean))</a></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">coef_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb18-2" title="2">coef_lasso_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb18-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb18-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_lasso_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb18-5" title="5">error_counter=<span class="dv">0</span></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb18-7" title="7">tempdf=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="dt">Y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple2_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y,</a>
<a class="sourceLine" id="cb18-8" title="8">                        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple2_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X))</a>
<a class="sourceLine" id="cb18-9" title="9">tempcoef=<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(Y<span class="op">~</span>.<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>tempdf))</a>
<a class="sourceLine" id="cb18-10" title="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(lars)</a>
<a class="sourceLine" id="cb18-11" title="11">lasso<span class="fl">.1</span> &lt;-<span class="st"> </span>lars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/lars/topics/lars">lars</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple2_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb18-12" title="12">              <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple2_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y, <span class="dt">type=</span><span class="st">"lasso"</span>, </a>
<a class="sourceLine" id="cb18-13" title="13">              <span class="dt">trace=</span><span class="ot">FALSE</span>, <span class="dt">normalize=</span><span class="ot">FALSE</span>, <span class="dt">intercept =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb18-14" title="14"><span class="co"># cv.lars() uses crossvalidation to estimate optimal position in path</span></a>
<a class="sourceLine" id="cb18-15" title="15">cv.lasso<span class="fl">.1</span> &lt;-<span class="st"> </span>lars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/lars/topics/cv.lars">cv.lars</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple2_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb18-16" title="16">              <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple2_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y, </a>
<a class="sourceLine" id="cb18-17" title="17">              <span class="dt">plot.it=</span><span class="ot">FALSE</span>, <span class="dt">type=</span><span class="st">"lasso"</span>)</a>
<a class="sourceLine" id="cb18-18" title="18"><span class="co"># Use the "+1SE rule" to find best model: </span></a>
<a class="sourceLine" id="cb18-19" title="19"><span class="co">#    Take the min CV and add its SE ("limit").  </span></a>
<a class="sourceLine" id="cb18-20" title="20"><span class="co">#    Find smallest model that has its own CV within this limit (at "s.cv.1")</span></a>
<a class="sourceLine" id="cb18-21" title="21">limit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv) <span class="op">+</span><span class="st"> </span>cv.lasso<span class="fl">.1</span><span class="op">$</span>cv.error[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which.min">which.min</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv)]</a>
<a class="sourceLine" id="cb18-22" title="22">s.cv<span class="fl">.1</span> &lt;-<span class="st"> </span>cv.lasso<span class="fl">.1</span><span class="op">$</span>index[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv <span class="op">&lt;</span><span class="st"> </span>limit))]</a>
<a class="sourceLine" id="cb18-23" title="23"><span class="co"># Print out coefficients at optimal s.</span></a>
<a class="sourceLine" id="cb18-24" title="24">coef_lasso_sum=coef_lasso_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(lasso<span class="fl">.1</span>, <span class="dt">s=</span>s.cv<span class="fl">.1</span>, <span class="dt">mode=</span><span class="st">"fraction"</span>))</a>
<a class="sourceLine" id="cb18-25" title="25"><span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(tempcoef)){</a>
<a class="sourceLine" id="cb18-26" title="26"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"Error in lm fit, skip coefficients</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb18-27" title="27">error_counter=error_counter<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb18-28" title="28">  } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb18-29" title="29">coef_sum=coef_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(tempcoef)</a>
<a class="sourceLine" id="cb18-30" title="30">}</a>
<a class="sourceLine" id="cb18-31" title="31">}</a>
<a class="sourceLine" id="cb18-32" title="32"><span class="co">#&gt; Le chargement a nécessité le package : lars</span></a>
<a class="sourceLine" id="cb18-33" title="33"><span class="co">#&gt; Loaded lars 1.2</span></a>
<a class="sourceLine" id="cb18-34" title="34">error_counter</a>
<a class="sourceLine" id="cb18-35" title="35"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb18-36" title="36">coef_mean=coef_sum<span class="op">/</span>NDatasets</a>
<a class="sourceLine" id="cb18-37" title="37">coef_lasso_mean=coef_lasso_sum<span class="op">/</span>NDatasets</a></code></pre></div>
<p>With regular least squares and lasso estimators all fits were sucessful, yet only 20 variables coefficients could be estimated with regular least squares estimates for the linear model. Then we display and plot that the mean coefficient vector values for the least squares estimates.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">coef_mean</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="co">#&gt;           x1           x2           x3           x4           x5 </span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="co">#&gt; 1.500084e+00 1.492942e+00 1.496050e+00 1.528043e+00 1.497537e+00 </span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="co">#&gt;           x6           x7           x8           x9          x10 </span></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="co">#&gt; 2.577168e-15 6.820231e-15 3.386509e-15 4.297997e-15 7.216331e-15 </span></a>
<a class="sourceLine" id="cb19-6" title="6"><span class="co">#&gt;          x11          x12          x13          x14          x15 </span></a>
<a class="sourceLine" id="cb19-7" title="7"><span class="co">#&gt; 3.528058e-15 1.001056e-14 6.068207e-15 9.640427e-15 5.351262e-15 </span></a>
<a class="sourceLine" id="cb19-8" title="8"><span class="co">#&gt;          x16          x17          x18          x19          x20 </span></a>
<a class="sourceLine" id="cb19-9" title="9"><span class="co">#&gt; 9.276245e-15 5.295417e-15 8.227904e-15 5.860229e-15 4.724224e-15 </span></a>
<a class="sourceLine" id="cb19-10" title="10"><span class="co">#&gt;          x21          x22          x23          x24          x25 </span></a>
<a class="sourceLine" id="cb19-11" title="11"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb19-12" title="12"><span class="co">#&gt;          x26          x27          x28          x29          x30 </span></a>
<a class="sourceLine" id="cb19-13" title="13"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb19-14" title="14"><span class="co">#&gt;          x31          x32          x33          x34          x35 </span></a>
<a class="sourceLine" id="cb19-15" title="15"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb19-16" title="16"><span class="co">#&gt;          x36          x37          x38          x39          x40 </span></a>
<a class="sourceLine" id="cb19-17" title="17"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb19-18" title="18"><span class="co">#&gt;          x41          x42          x43          x44          x45 </span></a>
<a class="sourceLine" id="cb19-19" title="19"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb19-20" title="20"><span class="co">#&gt;          x46          x47          x48          x49          x50 </span></a>
<a class="sourceLine" id="cb19-21" title="21"><span class="co">#&gt;           NA           NA           NA           NA           NA</span></a>
<a class="sourceLine" id="cb19-22" title="22"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_mean)</a>
<a class="sourceLine" id="cb19-23" title="23"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">coef_lasso_mean</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="co">#&gt;          x1          x2          x3          x4          x5          x6 </span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="co">#&gt; 1.040812405 1.024444248 1.065905971 1.058866701 0.996624348 0.007811962 </span></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="co">#&gt;          x7          x8          x9         x10         x11         x12 </span></a>
<a class="sourceLine" id="cb20-5" title="5"><span class="co">#&gt; 0.015952857 0.010284528 0.025145014 0.019259508 0.014825470 0.023340488 </span></a>
<a class="sourceLine" id="cb20-6" title="6"><span class="co">#&gt;         x13         x14         x15         x16         x17         x18 </span></a>
<a class="sourceLine" id="cb20-7" title="7"><span class="co">#&gt; 0.015909217 0.013040568 0.012039290 0.007597800 0.009091856 0.016135853 </span></a>
<a class="sourceLine" id="cb20-8" title="8"><span class="co">#&gt;         x19         x20         x21         x22         x23         x24 </span></a>
<a class="sourceLine" id="cb20-9" title="9"><span class="co">#&gt; 0.006510554 0.017700262 0.024024125 0.026401587 0.016510921 0.006350005 </span></a>
<a class="sourceLine" id="cb20-10" title="10"><span class="co">#&gt;         x25         x26         x27         x28         x29         x30 </span></a>
<a class="sourceLine" id="cb20-11" title="11"><span class="co">#&gt; 0.015389373 0.013108940 0.022619351 0.008526745 0.003851395 0.026688493 </span></a>
<a class="sourceLine" id="cb20-12" title="12"><span class="co">#&gt;         x31         x32         x33         x34         x35         x36 </span></a>
<a class="sourceLine" id="cb20-13" title="13"><span class="co">#&gt; 0.013608283 0.010260901 0.019494725 0.008485431 0.008627058 0.019809449 </span></a>
<a class="sourceLine" id="cb20-14" title="14"><span class="co">#&gt;         x37         x38         x39         x40         x41         x42 </span></a>
<a class="sourceLine" id="cb20-15" title="15"><span class="co">#&gt; 0.015047270 0.007562486 0.005826465 0.008270178 0.009596887 0.016556957 </span></a>
<a class="sourceLine" id="cb20-16" title="16"><span class="co">#&gt;         x43         x44         x45         x46         x47         x48 </span></a>
<a class="sourceLine" id="cb20-17" title="17"><span class="co">#&gt; 0.014522021 0.016432803 0.003504785 0.008892051 0.012878671 0.011623352 </span></a>
<a class="sourceLine" id="cb20-18" title="18"><span class="co">#&gt;         x49         x50 </span></a>
<a class="sourceLine" id="cb20-19" title="19"><span class="co">#&gt; 0.004653053 0.010384327</span></a>
<a class="sourceLine" id="cb20-20" title="20"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_lasso_mean,<span class="dt">ylim=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb20-21" title="21"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>The simulation process looks sucessfull: the lasso estimates retrives mostly the correct variables, yet the other ones are also selected sometimes. What are the confidence indices for those variables?</p>
</div>
</div>
<div id="third-example" class="section level1">
<h1 class="hasAnchor">
<a href="#third-example" class="anchor"></a>Third Example</h1>
<div id="aim-2" class="section level2">
<h2 class="hasAnchor">
<a href="#aim-2" class="anchor"></a>Aim</h2>
<p>We want to creates <span class="math inline">\(NDatasets=200\)</span> datasets with <span class="math inline">\(\textrm{length}(supp)=100\)</span> variables and <span class="math inline">\(N=24\)</span> observations. In that example we use real data for the <code>X</code> variables that we sample from all the <span class="math inline">\(1650\)</span> probesets that are differentially expressed between the two conditions US and S. The main interest of that simulation is that the correlation structure of the <code>X</code> dataset will be a real one.</p>
</div>
<div id="data-and-response-generations" class="section level2">
<h2 class="hasAnchor">
<a href="#data-and-response-generations" class="anchor"></a>Data and response generations</h2>
<p>First retrieve the datasets and get the differentially expressed probesets. Run the code to get additionnal plots.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(CascadeData)</a>
<a class="sourceLine" id="cb21-2" title="2"><span class="co">#&gt; Le chargement a nécessité le package : CascadeData</span></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(micro_S)</a>
<a class="sourceLine" id="cb21-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(micro_US)</a>
<a class="sourceLine" id="cb21-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(Cascade)</a>
<a class="sourceLine" id="cb21-6" title="6"><span class="co">#&gt; Le chargement a nécessité le package : Cascade</span></a>
<a class="sourceLine" id="cb21-7" title="7">micro_US&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/Cascade/topics/as.micro_array">as.micro_array</a></span>(micro_US,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">60</span>,<span class="dv">90</span>,<span class="dv">240</span>,<span class="dv">390</span>),<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb21-8" title="8">micro_S&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/Cascade/topics/as.micro_array">as.micro_array</a></span>(micro_S,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">60</span>,<span class="dv">90</span>,<span class="dv">240</span>,<span class="dv">390</span>),<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb21-9" title="9">S&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/Cascade/topics/genePeakSelection-methods">geneSelection</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(micro_S,micro_US),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="st">"condition"</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">1</span>),<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-10" title="10"><span class="co">#&gt; Le chargement a nécessité le package : limma</span></a>
<a class="sourceLine" id="cb21-11" title="11">Sel&lt;-micro_S<span class="op">@</span>microarray[S<span class="op">@</span>name,]</a></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(S)</a>
<a class="sourceLine" id="cb22-2" title="2"><span class="co">#&gt; Le chargement a nécessité le package : cluster</span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="co">#&gt;    N1_US_T60          N1_US_T90           N1_US_T210       </span></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="co">#&gt;  Min.   :-3.24588   Min.   :-2.740840   Min.   :-4.056378  </span></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="co">#&gt;  1st Qu.:-0.13240   1st Qu.:-0.116239   1st Qu.:-0.298263  </span></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="co">#&gt;  Median :-0.04406   Median : 0.007188   Median :-0.002423  </span></a>
<a class="sourceLine" id="cb22-7" title="7"><span class="co">#&gt;  Mean   : 0.02723   Mean   : 0.008828   Mean   :-0.062663  </span></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="co">#&gt;  3rd Qu.: 0.07049   3rd Qu.: 0.143812   3rd Qu.: 0.218037  </span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="co">#&gt;  Max.   : 3.00403   Max.   : 2.581014   Max.   : 3.068053  </span></a>
<a class="sourceLine" id="cb22-10" title="10"><span class="co">#&gt;    N1_US_T390        N2_US_T60         N2_US_T90          N2_US_T210      </span></a>
<a class="sourceLine" id="cb22-11" title="11"><span class="co">#&gt;  Min.   :-4.6843   Min.   :-3.1490   Min.   :-3.26105   Min.   :-3.69272  </span></a>
<a class="sourceLine" id="cb22-12" title="12"><span class="co">#&gt;  1st Qu.:-0.4123   1st Qu.: 0.1957   1st Qu.:-0.20630   1st Qu.:-0.18419  </span></a>
<a class="sourceLine" id="cb22-13" title="13"><span class="co">#&gt;  Median :-0.1167   Median : 0.3917   Median :-0.10981   Median : 0.03299  </span></a>
<a class="sourceLine" id="cb22-14" title="14"><span class="co">#&gt;  Mean   :-0.1144   Mean   : 0.4016   Mean   :-0.13583   Mean   : 0.01174  </span></a>
<a class="sourceLine" id="cb22-15" title="15"><span class="co">#&gt;  3rd Qu.: 0.1270   3rd Qu.: 0.5908   3rd Qu.:-0.02678   3rd Qu.: 0.22894  </span></a>
<a class="sourceLine" id="cb22-16" title="16"><span class="co">#&gt;  Max.   : 3.1434   Max.   : 3.7878   Max.   : 3.54337   Max.   : 2.46752  </span></a>
<a class="sourceLine" id="cb22-17" title="17"><span class="co">#&gt;    N2_US_T390         N3_US_T60          N3_US_T90       </span></a>
<a class="sourceLine" id="cb22-18" title="18"><span class="co">#&gt;  Min.   :-4.61130   Min.   :-3.66185   Min.   :-3.44746  </span></a>
<a class="sourceLine" id="cb22-19" title="19"><span class="co">#&gt;  1st Qu.:-0.21195   1st Qu.:-0.16978   1st Qu.:-0.07454  </span></a>
<a class="sourceLine" id="cb22-20" title="20"><span class="co">#&gt;  Median :-0.01994   Median :-0.03868   Median : 0.04864  </span></a>
<a class="sourceLine" id="cb22-21" title="21"><span class="co">#&gt;  Mean   :-0.04728   Mean   :-0.05892   Mean   : 0.01881  </span></a>
<a class="sourceLine" id="cb22-22" title="22"><span class="co">#&gt;  3rd Qu.: 0.16975   3rd Qu.: 0.07801   3rd Qu.: 0.15696  </span></a>
<a class="sourceLine" id="cb22-23" title="23"><span class="co">#&gt;  Max.   : 2.36837   Max.   : 3.17208   Max.   : 2.22462  </span></a>
<a class="sourceLine" id="cb22-24" title="24"><span class="co">#&gt;    N3_US_T210        N3_US_T390         N4_US_T60       </span></a>
<a class="sourceLine" id="cb22-25" title="25"><span class="co">#&gt;  Min.   :-4.2709   Min.   :-4.73460   Min.   :-1.80952  </span></a>
<a class="sourceLine" id="cb22-26" title="26"><span class="co">#&gt;  1st Qu.:-0.6869   1st Qu.:-0.21676   1st Qu.:-0.08733  </span></a>
<a class="sourceLine" id="cb22-27" title="27"><span class="co">#&gt;  Median :-0.2507   Median : 0.04391   Median :-0.03024  </span></a>
<a class="sourceLine" id="cb22-28" title="28"><span class="co">#&gt;  Mean   :-0.2593   Mean   : 0.02288   Mean   :-0.02583  </span></a>
<a class="sourceLine" id="cb22-29" title="29"><span class="co">#&gt;  3rd Qu.: 0.1073   3rd Qu.: 0.28173   3rd Qu.: 0.02099  </span></a>
<a class="sourceLine" id="cb22-30" title="30"><span class="co">#&gt;  Max.   : 3.2871   Max.   : 3.67975   Max.   : 2.20727  </span></a>
<a class="sourceLine" id="cb22-31" title="31"><span class="co">#&gt;    N4_US_T90           N4_US_T210         N4_US_T390      </span></a>
<a class="sourceLine" id="cb22-32" title="32"><span class="co">#&gt;  Min.   :-3.555348   Min.   :-2.95869   Min.   :-3.21158  </span></a>
<a class="sourceLine" id="cb22-33" title="33"><span class="co">#&gt;  1st Qu.: 0.001517   1st Qu.:-0.23332   1st Qu.:-0.17235  </span></a>
<a class="sourceLine" id="cb22-34" title="34"><span class="co">#&gt;  Median : 0.076508   Median :-0.09978   Median :-0.05177  </span></a>
<a class="sourceLine" id="cb22-35" title="35"><span class="co">#&gt;  Mean   : 0.055968   Mean   :-0.11058   Mean   :-0.06072  </span></a>
<a class="sourceLine" id="cb22-36" title="36"><span class="co">#&gt;  3rd Qu.: 0.147247   3rd Qu.: 0.02792   3rd Qu.: 0.05336  </span></a>
<a class="sourceLine" id="cb22-37" title="37"><span class="co">#&gt;  Max.   : 1.719786   Max.   : 2.91531   Max.   : 2.15722  </span></a>
<a class="sourceLine" id="cb22-38" title="38"><span class="co">#&gt;    N5_US_T60          N5_US_T90          N5_US_T210      </span></a>
<a class="sourceLine" id="cb22-39" title="39"><span class="co">#&gt;  Min.   :-2.04861   Min.   :-2.14086   Min.   :-3.61826  </span></a>
<a class="sourceLine" id="cb22-40" title="40"><span class="co">#&gt;  1st Qu.: 0.01025   1st Qu.:-0.10201   1st Qu.:-0.22499  </span></a>
<a class="sourceLine" id="cb22-41" title="41"><span class="co">#&gt;  Median : 0.09644   Median :-0.01021   Median :-0.06266  </span></a>
<a class="sourceLine" id="cb22-42" title="42"><span class="co">#&gt;  Mean   : 0.06829   Mean   :-0.02281   Mean   :-0.08268  </span></a>
<a class="sourceLine" id="cb22-43" title="43"><span class="co">#&gt;  3rd Qu.: 0.17637   3rd Qu.: 0.06101   3rd Qu.: 0.08834  </span></a>
<a class="sourceLine" id="cb22-44" title="44"><span class="co">#&gt;  Max.   : 2.23614   Max.   : 2.62104   Max.   : 2.81091  </span></a>
<a class="sourceLine" id="cb22-45" title="45"><span class="co">#&gt;    N5_US_T390         N6_US_T60           N6_US_T90       </span></a>
<a class="sourceLine" id="cb22-46" title="46"><span class="co">#&gt;  Min.   :-3.42995   Min.   :-2.814716   Min.   :-2.46213  </span></a>
<a class="sourceLine" id="cb22-47" title="47"><span class="co">#&gt;  1st Qu.:-0.11192   1st Qu.:-0.054682   1st Qu.:-0.10794  </span></a>
<a class="sourceLine" id="cb22-48" title="48"><span class="co">#&gt;  Median : 0.05497   Median : 0.008866   Median :-0.01223  </span></a>
<a class="sourceLine" id="cb22-49" title="49"><span class="co">#&gt;  Mean   : 0.02813   Mean   : 0.008599   Mean   : 0.01019  </span></a>
<a class="sourceLine" id="cb22-50" title="50"><span class="co">#&gt;  3rd Qu.: 0.20603   3rd Qu.: 0.077924   3rd Qu.: 0.09869  </span></a>
<a class="sourceLine" id="cb22-51" title="51"><span class="co">#&gt;  Max.   : 3.38922   Max.   : 2.789490   Max.   : 2.58776  </span></a>
<a class="sourceLine" id="cb22-52" title="52"><span class="co">#&gt;    N6_US_T210         N6_US_T390      </span></a>
<a class="sourceLine" id="cb22-53" title="53"><span class="co">#&gt;  Min.   :-2.89696   Min.   :-4.15575  </span></a>
<a class="sourceLine" id="cb22-54" title="54"><span class="co">#&gt;  1st Qu.:-0.17750   1st Qu.:-0.24111  </span></a>
<a class="sourceLine" id="cb22-55" title="55"><span class="co">#&gt;  Median : 0.02146   Median :-0.03612  </span></a>
<a class="sourceLine" id="cb22-56" title="56"><span class="co">#&gt;  Mean   :-0.01274   Mean   :-0.06744  </span></a>
<a class="sourceLine" id="cb22-57" title="57"><span class="co">#&gt;  3rd Qu.: 0.19801   3rd Qu.: 0.14960  </span></a>
<a class="sourceLine" id="cb22-58" title="58"><span class="co">#&gt;  Max.   : 2.08709   Max.   : 2.97212</span></a></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(S)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>Generates the datasets sampling for each of them 100 probesets expressions among the 1650 that were selected and linking the response to the expressions of the first five probesets.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">3141</span>)</a>
<a class="sourceLine" id="cb24-2" title="2">supp&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="dv">95</span>))</a>
<a class="sourceLine" id="cb24-3" title="3">minB&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb24-4" title="4">maxB&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb24-5" title="5">stn&lt;-<span class="dv">50</span></a>
<a class="sourceLine" id="cb24-6" title="6">NDatasets=<span class="dv">200</span></a>
<a class="sourceLine" id="cb24-7" title="7"></a>
<a class="sourceLine" id="cb24-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb24-9" title="9">X&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">as.matrix</a></span>(Sel[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(Sel),<span class="dv">100</span>),]))</a>
<a class="sourceLine" id="cb24-10" title="10">Xnorm&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(X)<span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">sqrt</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colSums">colSums</a></span>(X<span class="op">*</span>X)))</a>
<a class="sourceLine" id="cb24-11" title="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/assign">assign</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple3_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>),<span class="kw"><a href="../reference/simulation.html">simulation_DATA</a></span>(Xnorm,supp,minB,maxB,stn))</a>
<a class="sourceLine" id="cb24-12" title="12">}</a></code></pre></div>
</div>
<div id="checks-1" class="section level2">
<h2 class="hasAnchor">
<a href="#checks-1" class="anchor"></a>Checks</h2>
<p>Here are the plots of an example of correlation structure, namely for <code>DATA_exemple3_nb_200$X</code>. Run the code to get the graphics.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(Xnorm))</a>
<a class="sourceLine" id="cb25-2" title="2">mixOmics<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/mixOmics/topics/cim">cim</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(Xnorm))</a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">coef_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(supp))</a>
<a class="sourceLine" id="cb26-2" title="2">coef_lasso_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(supp))</a>
<a class="sourceLine" id="cb26-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(supp),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb26-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_lasso_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(supp),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb26-5" title="5">error_counter=<span class="dv">0</span></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb26-7" title="7">tempdf=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="dt">Y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple3_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y,</a>
<a class="sourceLine" id="cb26-8" title="8">                        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple3_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X))</a>
<a class="sourceLine" id="cb26-9" title="9">tempcoef=<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(Y<span class="op">~</span>.<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>tempdf))</a>
<a class="sourceLine" id="cb26-10" title="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(lars)</a>
<a class="sourceLine" id="cb26-11" title="11">lasso<span class="fl">.1</span> &lt;-<span class="st"> </span>lars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/lars/topics/lars">lars</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple3_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb26-12" title="12">              <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple3_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y, <span class="dt">type=</span><span class="st">"lasso"</span>, </a>
<a class="sourceLine" id="cb26-13" title="13">              <span class="dt">trace=</span><span class="ot">FALSE</span>, <span class="dt">normalize=</span><span class="ot">FALSE</span>, <span class="dt">intercept =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb26-14" title="14"><span class="co"># cv.lars() uses crossvalidation to estimate optimal position in path</span></a>
<a class="sourceLine" id="cb26-15" title="15">cv.lasso<span class="fl">.1</span> &lt;-<span class="st"> </span>lars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/lars/topics/cv.lars">cv.lars</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple3_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb26-16" title="16">              <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple3_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y, </a>
<a class="sourceLine" id="cb26-17" title="17">              <span class="dt">plot.it=</span><span class="ot">FALSE</span>, <span class="dt">normalize=</span><span class="ot">FALSE</span>, <span class="dt">intercept =</span> <span class="ot">FALSE</span>, <span class="dt">type=</span><span class="st">"lasso"</span>)</a>
<a class="sourceLine" id="cb26-18" title="18"><span class="co"># Use the "+1SE rule" to find best model: </span></a>
<a class="sourceLine" id="cb26-19" title="19"><span class="co">#    Take the min CV and add its SE ("limit").  </span></a>
<a class="sourceLine" id="cb26-20" title="20"><span class="co">#    Find smallest model that has its own CV within this limit (at "s.cv.1")</span></a>
<a class="sourceLine" id="cb26-21" title="21">limit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv) <span class="op">+</span><span class="st"> </span>cv.lasso<span class="fl">.1</span><span class="op">$</span>cv.error[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which.min">which.min</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv)]</a>
<a class="sourceLine" id="cb26-22" title="22">s.cv<span class="fl">.1</span> &lt;-<span class="st"> </span>cv.lasso<span class="fl">.1</span><span class="op">$</span>index[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv <span class="op">&lt;</span><span class="st"> </span>limit))]</a>
<a class="sourceLine" id="cb26-23" title="23"><span class="co"># Print out coefficients at optimal s.</span></a>
<a class="sourceLine" id="cb26-24" title="24">coef_lasso_sum=coef_lasso_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(lasso<span class="fl">.1</span>, <span class="dt">s=</span>s.cv<span class="fl">.1</span>, <span class="dt">mode=</span><span class="st">"fraction"</span>))</a>
<a class="sourceLine" id="cb26-25" title="25"><span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(tempcoef)){</a>
<a class="sourceLine" id="cb26-26" title="26"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"Error in lm fit, skip coefficients</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb26-27" title="27">error_counter=error_counter<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb26-28" title="28">  } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb26-29" title="29">coef_sum=coef_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(tempcoef)</a>
<a class="sourceLine" id="cb26-30" title="30">}</a>
<a class="sourceLine" id="cb26-31" title="31">}</a>
<a class="sourceLine" id="cb26-32" title="32">error_counter</a>
<a class="sourceLine" id="cb26-33" title="33"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb26-34" title="34">coef_mean=coef_sum<span class="op">/</span>NDatasets</a>
<a class="sourceLine" id="cb26-35" title="35">coef_lasso_mean=coef_lasso_sum<span class="op">/</span>NDatasets</a></code></pre></div>
<p>With regular least squares and lasso estimators all fits were sucessful, yet only 20 variables coefficients could be estimated with regular least squares estimates for the linear model. Then we display and plot that the mean coefficient vector values for the least squares estimates.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">coef_mean</a>
<a class="sourceLine" id="cb27-2" title="2"><span class="co">#&gt;           x1           x2           x3           x4           x5 </span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="co">#&gt; 1.457741e+00 1.488627e+00 1.503719e+00 1.506939e+00 1.481887e+00 </span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="co">#&gt;           x6           x7           x8           x9          x10 </span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="co">#&gt; 4.783287e-14 3.253540e-14 3.033880e-14 3.386953e-14 5.129063e-14 </span></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="co">#&gt;          x11          x12          x13          x14          x15 </span></a>
<a class="sourceLine" id="cb27-7" title="7"><span class="co">#&gt; 2.171987e-14 3.593990e-14 6.635802e-14 3.740085e-14 4.467427e-14 </span></a>
<a class="sourceLine" id="cb27-8" title="8"><span class="co">#&gt;          x16          x17          x18          x19          x20 </span></a>
<a class="sourceLine" id="cb27-9" title="9"><span class="co">#&gt; 2.678085e-14 3.441995e-14 2.796034e-14 2.978652e-14 2.492476e-14 </span></a>
<a class="sourceLine" id="cb27-10" title="10"><span class="co">#&gt;          x21          x22          x23          x24          x25 </span></a>
<a class="sourceLine" id="cb27-11" title="11"><span class="co">#&gt; 2.808596e-14 2.206820e-14 3.824975e-14 3.346627e-14           NA </span></a>
<a class="sourceLine" id="cb27-12" title="12"><span class="co">#&gt;          x26          x27          x28          x29          x30 </span></a>
<a class="sourceLine" id="cb27-13" title="13"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb27-14" title="14"><span class="co">#&gt;          x31          x32          x33          x34          x35 </span></a>
<a class="sourceLine" id="cb27-15" title="15"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb27-16" title="16"><span class="co">#&gt;          x36          x37          x38          x39          x40 </span></a>
<a class="sourceLine" id="cb27-17" title="17"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb27-18" title="18"><span class="co">#&gt;          x41          x42          x43          x44          x45 </span></a>
<a class="sourceLine" id="cb27-19" title="19"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb27-20" title="20"><span class="co">#&gt;          x46          x47          x48          x49          x50 </span></a>
<a class="sourceLine" id="cb27-21" title="21"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb27-22" title="22"><span class="co">#&gt;          x51          x52          x53          x54          x55 </span></a>
<a class="sourceLine" id="cb27-23" title="23"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb27-24" title="24"><span class="co">#&gt;          x56          x57          x58          x59          x60 </span></a>
<a class="sourceLine" id="cb27-25" title="25"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb27-26" title="26"><span class="co">#&gt;          x61          x62          x63          x64          x65 </span></a>
<a class="sourceLine" id="cb27-27" title="27"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb27-28" title="28"><span class="co">#&gt;          x66          x67          x68          x69          x70 </span></a>
<a class="sourceLine" id="cb27-29" title="29"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb27-30" title="30"><span class="co">#&gt;          x71          x72          x73          x74          x75 </span></a>
<a class="sourceLine" id="cb27-31" title="31"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb27-32" title="32"><span class="co">#&gt;          x76          x77          x78          x79          x80 </span></a>
<a class="sourceLine" id="cb27-33" title="33"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb27-34" title="34"><span class="co">#&gt;          x81          x82          x83          x84          x85 </span></a>
<a class="sourceLine" id="cb27-35" title="35"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb27-36" title="36"><span class="co">#&gt;          x86          x87          x88          x89          x90 </span></a>
<a class="sourceLine" id="cb27-37" title="37"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb27-38" title="38"><span class="co">#&gt;          x91          x92          x93          x94          x95 </span></a>
<a class="sourceLine" id="cb27-39" title="39"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb27-40" title="40"><span class="co">#&gt;          x96          x97          x98          x99         x100 </span></a>
<a class="sourceLine" id="cb27-41" title="41"><span class="co">#&gt;           NA           NA           NA           NA           NA</span></a>
<a class="sourceLine" id="cb27-42" title="42"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_mean)</a>
<a class="sourceLine" id="cb27-43" title="43"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">coef_lasso_mean</a>
<a class="sourceLine" id="cb28-2" title="2"><span class="co">#&gt;          x1          x2          x3          x4          x5          x6 </span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="co">#&gt; 0.637209930 0.664930735 0.704791558 0.699788446 0.708957352 0.026974567 </span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="co">#&gt;          x7          x8          x9         x10         x11         x12 </span></a>
<a class="sourceLine" id="cb28-5" title="5"><span class="co">#&gt; 0.023487857 0.009919040 0.011058633 0.010031720 0.016771602 0.010042126 </span></a>
<a class="sourceLine" id="cb28-6" title="6"><span class="co">#&gt;         x13         x14         x15         x16         x17         x18 </span></a>
<a class="sourceLine" id="cb28-7" title="7"><span class="co">#&gt; 0.021205099 0.017549985 0.012900827 0.018584630 0.023346476 0.010608447 </span></a>
<a class="sourceLine" id="cb28-8" title="8"><span class="co">#&gt;         x19         x20         x21         x22         x23         x24 </span></a>
<a class="sourceLine" id="cb28-9" title="9"><span class="co">#&gt; 0.019021097 0.014329658 0.038015434 0.018848081 0.024050393 0.023265893 </span></a>
<a class="sourceLine" id="cb28-10" title="10"><span class="co">#&gt;         x25         x26         x27         x28         x29         x30 </span></a>
<a class="sourceLine" id="cb28-11" title="11"><span class="co">#&gt; 0.021527789 0.025728325 0.018939560 0.016298912 0.017970262 0.012682511 </span></a>
<a class="sourceLine" id="cb28-12" title="12"><span class="co">#&gt;         x31         x32         x33         x34         x35         x36 </span></a>
<a class="sourceLine" id="cb28-13" title="13"><span class="co">#&gt; 0.025418463 0.022593725 0.013102577 0.022873574 0.009968251 0.019946689 </span></a>
<a class="sourceLine" id="cb28-14" title="14"><span class="co">#&gt;         x37         x38         x39         x40         x41         x42 </span></a>
<a class="sourceLine" id="cb28-15" title="15"><span class="co">#&gt; 0.017837080 0.014291701 0.038368829 0.012130424 0.014915569 0.019767104 </span></a>
<a class="sourceLine" id="cb28-16" title="16"><span class="co">#&gt;         x43         x44         x45         x46         x47         x48 </span></a>
<a class="sourceLine" id="cb28-17" title="17"><span class="co">#&gt; 0.014077032 0.019515928 0.018308034 0.023001590 0.023608520 0.023254216 </span></a>
<a class="sourceLine" id="cb28-18" title="18"><span class="co">#&gt;         x49         x50         x51         x52         x53         x54 </span></a>
<a class="sourceLine" id="cb28-19" title="19"><span class="co">#&gt; 0.027810565 0.020526328 0.021684967 0.017601886 0.015140221 0.014786294 </span></a>
<a class="sourceLine" id="cb28-20" title="20"><span class="co">#&gt;         x55         x56         x57         x58         x59         x60 </span></a>
<a class="sourceLine" id="cb28-21" title="21"><span class="co">#&gt; 0.015782671 0.021593288 0.017002037 0.010170505 0.014032097 0.018771402 </span></a>
<a class="sourceLine" id="cb28-22" title="22"><span class="co">#&gt;         x61         x62         x63         x64         x65         x66 </span></a>
<a class="sourceLine" id="cb28-23" title="23"><span class="co">#&gt; 0.021602370 0.015063636 0.017964267 0.008458907 0.025593764 0.015068537 </span></a>
<a class="sourceLine" id="cb28-24" title="24"><span class="co">#&gt;         x67         x68         x69         x70         x71         x72 </span></a>
<a class="sourceLine" id="cb28-25" title="25"><span class="co">#&gt; 0.026420849 0.027444423 0.012679975 0.016202908 0.023457459 0.013357638 </span></a>
<a class="sourceLine" id="cb28-26" title="26"><span class="co">#&gt;         x73         x74         x75         x76         x77         x78 </span></a>
<a class="sourceLine" id="cb28-27" title="27"><span class="co">#&gt; 0.019508482 0.019488113 0.020121936 0.038249554 0.020394668 0.022021328 </span></a>
<a class="sourceLine" id="cb28-28" title="28"><span class="co">#&gt;         x79         x80         x81         x82         x83         x84 </span></a>
<a class="sourceLine" id="cb28-29" title="29"><span class="co">#&gt; 0.017333107 0.011867270 0.013594937 0.009380064 0.011832266 0.015219820 </span></a>
<a class="sourceLine" id="cb28-30" title="30"><span class="co">#&gt;         x85         x86         x87         x88         x89         x90 </span></a>
<a class="sourceLine" id="cb28-31" title="31"><span class="co">#&gt; 0.020711292 0.015979236 0.014798893 0.008586843 0.015322780 0.012577586 </span></a>
<a class="sourceLine" id="cb28-32" title="32"><span class="co">#&gt;         x91         x92         x93         x94         x95         x96 </span></a>
<a class="sourceLine" id="cb28-33" title="33"><span class="co">#&gt; 0.015768535 0.018415016 0.029014530 0.019916314 0.012457481 0.028478157 </span></a>
<a class="sourceLine" id="cb28-34" title="34"><span class="co">#&gt;         x97         x98         x99        x100 </span></a>
<a class="sourceLine" id="cb28-35" title="35"><span class="co">#&gt; 0.009748370 0.009669022 0.032595465 0.012964933</span></a>
<a class="sourceLine" id="cb28-36" title="36"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_lasso_mean,<span class="dt">ylim=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb28-37" title="37"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<p>The simulation process looks sucessfull: the lasso estimates retrives mostly the correct variables, yet the other ones are also selected sometimes. What are the confidence indices for those variables?</p>
</div>
</div>
<div id="fourth-example" class="section level1">
<h1 class="hasAnchor">
<a href="#fourth-example" class="anchor"></a>Fourth Example</h1>
<div id="aim-3" class="section level2">
<h2 class="hasAnchor">
<a href="#aim-3" class="anchor"></a>Aim</h2>
<p>We want to creates <span class="math inline">\(NDatasets=101\)</span> datasets with <span class="math inline">\(\textrm{length}(supp)=100\)</span> variables and <span class="math inline">\(N=18\)</span> observations. In that example we use real data for the variables that are the <span class="math inline">\(101\)</span> probesets that are the more differentially expressed between the two conditions US and S. We create <span class="math inline">\(101\)</span> datasets by leaving one of the variables out each time and using it as the response that shall be predicted. We also only use for the explanatory variables the observations that are the measurements for the 1st, 2nd and 3rd timepoints and for the responses the observations that are the measurements of the same variables for the 2nd, 3rd and 4th timepoints. The main interest of that simulation is that the correlation structure of the <code>X</code> dataset will be a real one and that it is a typical setting for cascade network reverse-engineering in genomics or proteomics, see the <code>Cascade</code> package for more details.</p>
</div>
<div id="data-and-response-generations-1" class="section level2">
<h2 class="hasAnchor">
<a href="#data-and-response-generations-1" class="anchor"></a>Data and response generations</h2>
<p>First retrieve the datasets and get the differentially expressed probesets. Run the code to get additionnal plots.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(CascadeData)</a>
<a class="sourceLine" id="cb29-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(micro_S)</a>
<a class="sourceLine" id="cb29-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(micro_US)</a>
<a class="sourceLine" id="cb29-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(Cascade)</a>
<a class="sourceLine" id="cb29-5" title="5">micro_US&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/Cascade/topics/as.micro_array">as.micro_array</a></span>(micro_US,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">60</span>,<span class="dv">90</span>,<span class="dv">240</span>,<span class="dv">390</span>),<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb29-6" title="6">micro_S&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/Cascade/topics/as.micro_array">as.micro_array</a></span>(micro_S,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">60</span>,<span class="dv">90</span>,<span class="dv">240</span>,<span class="dv">390</span>),<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb29-7" title="7">S&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/Cascade/topics/genePeakSelection-methods">geneSelection</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(micro_S,micro_US),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="st">"condition"</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">1</span>),<span class="dv">101</span>)</a>
<a class="sourceLine" id="cb29-8" title="8">Sel&lt;-micro_S<span class="op">@</span>microarray[S<span class="op">@</span>name,]</a></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(S)</a>
<a class="sourceLine" id="cb30-2" title="2"><span class="co">#&gt;    N1_US_T60          N1_US_T90           N1_US_T210       </span></a>
<a class="sourceLine" id="cb30-3" title="3"><span class="co">#&gt;  Min.   :-0.89276   Min.   :-0.773190   Min.   :-2.079442  </span></a>
<a class="sourceLine" id="cb30-4" title="4"><span class="co">#&gt;  1st Qu.:-0.11132   1st Qu.:-0.082888   1st Qu.:-0.283990  </span></a>
<a class="sourceLine" id="cb30-5" title="5"><span class="co">#&gt;  Median :-0.03030   Median :-0.002073   Median : 0.006005  </span></a>
<a class="sourceLine" id="cb30-6" title="6"><span class="co">#&gt;  Mean   : 0.04941   Mean   : 0.015356   Mean   :-0.074991  </span></a>
<a class="sourceLine" id="cb30-7" title="7"><span class="co">#&gt;  3rd Qu.: 0.08370   3rd Qu.: 0.127301   3rd Qu.: 0.204382  </span></a>
<a class="sourceLine" id="cb30-8" title="8"><span class="co">#&gt;  Max.   : 2.53897   Max.   : 0.938891   Max.   : 1.155634  </span></a>
<a class="sourceLine" id="cb30-9" title="9"><span class="co">#&gt;    N1_US_T390         N2_US_T60         N2_US_T90       </span></a>
<a class="sourceLine" id="cb30-10" title="10"><span class="co">#&gt;  Min.   :-1.30745   Min.   :-1.6422   Min.   :-3.26105  </span></a>
<a class="sourceLine" id="cb30-11" title="11"><span class="co">#&gt;  1st Qu.:-0.44631   1st Qu.: 0.1499   1st Qu.:-0.21748  </span></a>
<a class="sourceLine" id="cb30-12" title="12"><span class="co">#&gt;  Median :-0.10464   Median : 0.3358   Median :-0.12623  </span></a>
<a class="sourceLine" id="cb30-13" title="13"><span class="co">#&gt;  Mean   :-0.03396   Mean   : 0.3331   Mean   :-0.13730  </span></a>
<a class="sourceLine" id="cb30-14" title="14"><span class="co">#&gt;  3rd Qu.: 0.23266   3rd Qu.: 0.5210   3rd Qu.:-0.04215  </span></a>
<a class="sourceLine" id="cb30-15" title="15"><span class="co">#&gt;  Max.   : 2.96588   Max.   : 2.7005   Max.   : 1.56541  </span></a>
<a class="sourceLine" id="cb30-16" title="16"><span class="co">#&gt;    N2_US_T210         N2_US_T390         N3_US_T60       </span></a>
<a class="sourceLine" id="cb30-17" title="17"><span class="co">#&gt;  Min.   :-2.55852   Min.   :-2.71910   Min.   :-2.37749  </span></a>
<a class="sourceLine" id="cb30-18" title="18"><span class="co">#&gt;  1st Qu.:-0.16896   1st Qu.:-0.31993   1st Qu.:-0.18448  </span></a>
<a class="sourceLine" id="cb30-19" title="19"><span class="co">#&gt;  Median : 0.01873   Median :-0.02216   Median :-0.06051  </span></a>
<a class="sourceLine" id="cb30-20" title="20"><span class="co">#&gt;  Mean   :-0.01445   Mean   :-0.08521   Mean   :-0.06439  </span></a>
<a class="sourceLine" id="cb30-21" title="21"><span class="co">#&gt;  3rd Qu.: 0.16535   3rd Qu.: 0.18161   3rd Qu.: 0.08545  </span></a>
<a class="sourceLine" id="cb30-22" title="22"><span class="co">#&gt;  Max.   : 1.16299   Max.   : 0.95946   Max.   : 1.00636  </span></a>
<a class="sourceLine" id="cb30-23" title="23"><span class="co">#&gt;    N3_US_T90          N3_US_T210        N3_US_T390       </span></a>
<a class="sourceLine" id="cb30-24" title="24"><span class="co">#&gt;  Min.   :-0.76029   Min.   :-1.9716   Min.   :-3.225327  </span></a>
<a class="sourceLine" id="cb30-25" title="25"><span class="co">#&gt;  1st Qu.:-0.03858   1st Qu.:-0.6713   1st Qu.:-0.258856  </span></a>
<a class="sourceLine" id="cb30-26" title="26"><span class="co">#&gt;  Median : 0.03977   Median :-0.1636   Median :-0.017611  </span></a>
<a class="sourceLine" id="cb30-27" title="27"><span class="co">#&gt;  Mean   : 0.03449   Mean   :-0.2324   Mean   :-0.004301  </span></a>
<a class="sourceLine" id="cb30-28" title="28"><span class="co">#&gt;  3rd Qu.: 0.14177   3rd Qu.: 0.2057   3rd Qu.: 0.287566  </span></a>
<a class="sourceLine" id="cb30-29" title="29"><span class="co">#&gt;  Max.   : 0.52193   Max.   : 1.3350   Max.   : 3.679747  </span></a>
<a class="sourceLine" id="cb30-30" title="30"><span class="co">#&gt;    N4_US_T60           N4_US_T90          N4_US_T210      </span></a>
<a class="sourceLine" id="cb30-31" title="31"><span class="co">#&gt;  Min.   :-0.376767   Min.   :-0.52425   Min.   :-1.38629  </span></a>
<a class="sourceLine" id="cb30-32" title="32"><span class="co">#&gt;  1st Qu.:-0.095907   1st Qu.:-0.01274   1st Qu.:-0.23321  </span></a>
<a class="sourceLine" id="cb30-33" title="33"><span class="co">#&gt;  Median :-0.032177   Median : 0.07226   Median :-0.12920  </span></a>
<a class="sourceLine" id="cb30-34" title="34"><span class="co">#&gt;  Mean   :-0.007576   Mean   : 0.06410   Mean   :-0.12071  </span></a>
<a class="sourceLine" id="cb30-35" title="35"><span class="co">#&gt;  3rd Qu.: 0.024612   3rd Qu.: 0.15332   3rd Qu.: 0.02794  </span></a>
<a class="sourceLine" id="cb30-36" title="36"><span class="co">#&gt;  Max.   : 0.734820   Max.   : 0.52910   Max.   : 0.57303  </span></a>
<a class="sourceLine" id="cb30-37" title="37"><span class="co">#&gt;    N4_US_T390         N5_US_T60          N5_US_T90        </span></a>
<a class="sourceLine" id="cb30-38" title="38"><span class="co">#&gt;  Min.   :-0.65678   Min.   :-0.92734   Min.   :-2.025374  </span></a>
<a class="sourceLine" id="cb30-39" title="39"><span class="co">#&gt;  1st Qu.:-0.19730   1st Qu.:-0.03818   1st Qu.:-0.080528  </span></a>
<a class="sourceLine" id="cb30-40" title="40"><span class="co">#&gt;  Median :-0.05158   Median : 0.05680   Median : 0.004812  </span></a>
<a class="sourceLine" id="cb30-41" title="41"><span class="co">#&gt;  Mean   :-0.07142   Mean   : 0.01675   Mean   :-0.025334  </span></a>
<a class="sourceLine" id="cb30-42" title="42"><span class="co">#&gt;  3rd Qu.: 0.07118   3rd Qu.: 0.14034   3rd Qu.: 0.055367  </span></a>
<a class="sourceLine" id="cb30-43" title="43"><span class="co">#&gt;  Max.   : 0.74194   Max.   : 0.35555   Max.   : 1.193922  </span></a>
<a class="sourceLine" id="cb30-44" title="44"><span class="co">#&gt;    N5_US_T210         N5_US_T390          N6_US_T60       </span></a>
<a class="sourceLine" id="cb30-45" title="45"><span class="co">#&gt;  Min.   :-0.87925   Min.   :-1.791759   Min.   :-1.30077  </span></a>
<a class="sourceLine" id="cb30-46" title="46"><span class="co">#&gt;  1st Qu.:-0.23615   1st Qu.:-0.167992   1st Qu.:-0.03809  </span></a>
<a class="sourceLine" id="cb30-47" title="47"><span class="co">#&gt;  Median :-0.08791   Median : 0.001692   Median : 0.01202  </span></a>
<a class="sourceLine" id="cb30-48" title="48"><span class="co">#&gt;  Mean   :-0.04003   Mean   :-0.008130   Mean   : 0.02745  </span></a>
<a class="sourceLine" id="cb30-49" title="49"><span class="co">#&gt;  3rd Qu.: 0.11900   3rd Qu.: 0.165985   3rd Qu.: 0.08639  </span></a>
<a class="sourceLine" id="cb30-50" title="50"><span class="co">#&gt;  Max.   : 2.80103   Max.   : 2.280781   Max.   : 1.29689  </span></a>
<a class="sourceLine" id="cb30-51" title="51"><span class="co">#&gt;    N6_US_T90           N6_US_T210         N6_US_T390       </span></a>
<a class="sourceLine" id="cb30-52" title="52"><span class="co">#&gt;  Min.   :-0.606136   Min.   :-1.96944   Min.   :-0.835295  </span></a>
<a class="sourceLine" id="cb30-53" title="53"><span class="co">#&gt;  1st Qu.:-0.096129   1st Qu.:-0.17553   1st Qu.:-0.282883  </span></a>
<a class="sourceLine" id="cb30-54" title="54"><span class="co">#&gt;  Median : 0.003016   Median :-0.00207   Median : 0.002766  </span></a>
<a class="sourceLine" id="cb30-55" title="55"><span class="co">#&gt;  Mean   : 0.023406   Mean   :-0.01794   Mean   :-0.046176  </span></a>
<a class="sourceLine" id="cb30-56" title="56"><span class="co">#&gt;  3rd Qu.: 0.072245   3rd Qu.: 0.20799   3rd Qu.: 0.186650  </span></a>
<a class="sourceLine" id="cb30-57" title="57"><span class="co">#&gt;  Max.   : 0.971099   Max.   : 0.96286   Max.   : 1.098612</span></a></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(S)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">suppt&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb32-2" title="2">supp&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="dv">95</span>)) <span class="co">#not used since we use one of the probeset expressions as response</span></a>
<a class="sourceLine" id="cb32-3" title="3">minB&lt;-<span class="dv">1</span> <span class="co">#not used since we use one of the probeset expressions as response</span></a>
<a class="sourceLine" id="cb32-4" title="4">maxB&lt;-<span class="dv">2</span> <span class="co">#not used since we use one of the probeset expressions as response</span></a>
<a class="sourceLine" id="cb32-5" title="5">stn&lt;-<span class="dv">50</span> <span class="co">#not used since we use one of the probeset expressions as response</span></a>
<a class="sourceLine" id="cb32-6" title="6">NDatasets&lt;-<span class="dv">101</span></a>
<a class="sourceLine" id="cb32-7" title="7"></a>
<a class="sourceLine" id="cb32-8" title="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">3141</span>)</a>
<a class="sourceLine" id="cb32-9" title="9"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb32-10" title="10">  <span class="co">#the explanatory variables are the values for the 1st, 2nd and 3rd timepoints</span></a>
<a class="sourceLine" id="cb32-11" title="11">  X&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">as.matrix</a></span>(Sel[<span class="op">-</span>i,suppt<span class="op">!=</span><span class="dv">4</span>]))</a>
<a class="sourceLine" id="cb32-12" title="12">  Xnorm&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(X)<span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">sqrt</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colSums">colSums</a></span>(X<span class="op">*</span>X)))</a>
<a class="sourceLine" id="cb32-13" title="13">  DATA&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_DATA</a></span>(Xnorm,supp,minB,maxB,stn)</a>
<a class="sourceLine" id="cb32-14" title="14">  <span class="co">#the reponses are the values for the 2nd, 3rd and 4th timepoints</span></a>
<a class="sourceLine" id="cb32-15" title="15">  DATA<span class="op">$</span>Y&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/vector">as.vector</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(Sel[i,suppt<span class="op">!=</span><span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb32-16" title="16">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/assign">assign</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple4_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>),DATA)</a>
<a class="sourceLine" id="cb32-17" title="17">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rm">rm</a></span>(DATA)</a>
<a class="sourceLine" id="cb32-18" title="18">}</a></code></pre></div>
</div>
<div id="checks-2" class="section level2">
<h2 class="hasAnchor">
<a href="#checks-2" class="anchor"></a>Checks</h2>
<p>Here are the plots of an example of correlation structure, namely for <code>DATA_exemple3_nb_200$X</code>. Run the code to get the graphics.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(Xnorm))</a>
<a class="sourceLine" id="cb33-2" title="2">mixOmics<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/mixOmics/topics/cim">cim</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(Xnorm))</a></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">coef_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(supp)<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb34-2" title="2">coef_lasso_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(supp)<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb34-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(supp)<span class="op">+</span><span class="dv">1</span>),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb34-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_lasso_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(supp)<span class="op">+</span><span class="dv">1</span>),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb34-5" title="5">error_counter=<span class="dv">0</span></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb34-7" title="7">tempdf=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="dt">Y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple4_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y,</a>
<a class="sourceLine" id="cb34-8" title="8">                        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple4_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X))</a>
<a class="sourceLine" id="cb34-9" title="9">tempcoef=<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(Y<span class="op">~</span>.<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>tempdf))</a>
<a class="sourceLine" id="cb34-10" title="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(lars)</a>
<a class="sourceLine" id="cb34-11" title="11">lasso<span class="fl">.1</span> &lt;-<span class="st"> </span>lars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/lars/topics/lars">lars</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple4_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb34-12" title="12">              <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple4_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y, <span class="dt">type=</span><span class="st">"lasso"</span>, </a>
<a class="sourceLine" id="cb34-13" title="13">              <span class="dt">trace=</span><span class="ot">FALSE</span>, <span class="dt">normalize=</span><span class="ot">FALSE</span>, <span class="dt">intercept =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb34-14" title="14"><span class="co"># cv.lars() uses crossvalidation to estimate optimal position in path</span></a>
<a class="sourceLine" id="cb34-15" title="15">cv.lasso<span class="fl">.1</span> &lt;-<span class="st"> </span>lars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/lars/topics/cv.lars">cv.lars</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple4_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb34-16" title="16">              <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple4_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y, </a>
<a class="sourceLine" id="cb34-17" title="17">              <span class="dt">plot.it=</span><span class="ot">FALSE</span>, <span class="dt">normalize=</span><span class="ot">FALSE</span>, <span class="dt">intercept =</span> <span class="ot">FALSE</span>, <span class="dt">type=</span><span class="st">"lasso"</span>)</a>
<a class="sourceLine" id="cb34-18" title="18"><span class="co"># Use the "+1SE rule" to find best model: </span></a>
<a class="sourceLine" id="cb34-19" title="19"><span class="co">#    Take the min CV and add its SE ("limit").  </span></a>
<a class="sourceLine" id="cb34-20" title="20"><span class="co">#    Find smallest model that has its own CV within this limit (at "s.cv.1")</span></a>
<a class="sourceLine" id="cb34-21" title="21">limit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv) <span class="op">+</span><span class="st"> </span>cv.lasso<span class="fl">.1</span><span class="op">$</span>cv.error[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which.min">which.min</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv)]</a>
<a class="sourceLine" id="cb34-22" title="22">s.cv<span class="fl">.1</span> &lt;-<span class="st"> </span>cv.lasso<span class="fl">.1</span><span class="op">$</span>index[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv <span class="op">&lt;</span><span class="st"> </span>limit))]</a>
<a class="sourceLine" id="cb34-23" title="23"><span class="co"># Print out coefficients at optimal s.</span></a>
<a class="sourceLine" id="cb34-24" title="24">coef_lasso_sum[<span class="op">-</span>i]=coef_lasso_sum[<span class="op">-</span>i]<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(lasso<span class="fl">.1</span>, <span class="dt">s=</span>s.cv<span class="fl">.1</span>, <span class="dt">mode=</span><span class="st">"fraction"</span>))</a>
<a class="sourceLine" id="cb34-25" title="25"><span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(tempcoef)){</a>
<a class="sourceLine" id="cb34-26" title="26"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"Error in lm fit, skip coefficients</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb34-27" title="27">error_counter=error_counter<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb34-28" title="28">  } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb34-29" title="29">coef_sum[<span class="op">-</span>i]=coef_sum[<span class="op">-</span>i]<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(tempcoef)</a>
<a class="sourceLine" id="cb34-30" title="30">}</a>
<a class="sourceLine" id="cb34-31" title="31">}</a>
<a class="sourceLine" id="cb34-32" title="32">error_counter</a>
<a class="sourceLine" id="cb34-33" title="33"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb34-34" title="34">coef_mean=coef_sum<span class="op">/</span>NDatasets</a>
<a class="sourceLine" id="cb34-35" title="35">coef_lasso_mean=coef_lasso_sum<span class="op">/</span>NDatasets</a></code></pre></div>
<p>With regular least squares and lasso estimators all fits were sucessful, yet only 20 variables coefficients could be estimated with regular least squares estimates for the linear model. Then we display and plot that the mean coefficient vector values for the least squares estimates.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(coef_mean, <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb35-2" title="2"><span class="co">#&gt;         x1         x2         x3         x4         x5         x6 </span></a>
<a class="sourceLine" id="cb35-3" title="3"><span class="co">#&gt; 14349.4269  8154.5511 14420.0396  5840.7360 15688.8442 12563.4724 </span></a>
<a class="sourceLine" id="cb35-4" title="4"><span class="co">#&gt;         x7         x8         x9        x10        x11        x12 </span></a>
<a class="sourceLine" id="cb35-5" title="5"><span class="co">#&gt;   603.4098  8310.8567 13063.4258  9127.8669  6589.8195  6108.8444 </span></a>
<a class="sourceLine" id="cb35-6" title="6"><span class="co">#&gt;        x13        x14        x15        x16        x17        x18 </span></a>
<a class="sourceLine" id="cb35-7" title="7"><span class="co">#&gt; 17045.1586  1160.3101 13911.5637  1626.6271  7104.9765 22361.0928 </span></a>
<a class="sourceLine" id="cb35-8" title="8"><span class="co">#&gt;        x19        x20        x21        x22        x23        x24 </span></a>
<a class="sourceLine" id="cb35-9" title="9"><span class="co">#&gt;         NA         NA         NA         NA         NA         NA </span></a>
<a class="sourceLine" id="cb35-10" title="10"><span class="co">#&gt;        x25        x26        x27        x28        x29        x30 </span></a>
<a class="sourceLine" id="cb35-11" title="11"><span class="co">#&gt;         NA         NA         NA         NA         NA         NA </span></a>
<a class="sourceLine" id="cb35-12" title="12"><span class="co">#&gt;        x31        x32        x33        x34        x35        x36 </span></a>
<a class="sourceLine" id="cb35-13" title="13"><span class="co">#&gt;         NA         NA         NA         NA         NA         NA </span></a>
<a class="sourceLine" id="cb35-14" title="14"><span class="co">#&gt;        x37        x38        x39        x40 </span></a>
<a class="sourceLine" id="cb35-15" title="15"><span class="co">#&gt;         NA         NA         NA         NA</span></a>
<a class="sourceLine" id="cb35-16" title="16"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_mean)</a>
<a class="sourceLine" id="cb35-17" title="17"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-35-1.png" width="700"></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(coef_lasso_mean, <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb36-2" title="2"><span class="co">#&gt;          x1          x2          x3          x4          x5          x6 </span></a>
<a class="sourceLine" id="cb36-3" title="3"><span class="co">#&gt;  29.0504131   5.2642895  20.5041967  22.5116563   0.0000000   5.2894815 </span></a>
<a class="sourceLine" id="cb36-4" title="4"><span class="co">#&gt;          x7          x8          x9         x10         x11         x12 </span></a>
<a class="sourceLine" id="cb36-5" title="5"><span class="co">#&gt;  71.0918236   2.2726129   3.9801932   4.7184860  15.9162259   1.5542485 </span></a>
<a class="sourceLine" id="cb36-6" title="6"><span class="co">#&gt;         x13         x14         x15         x16         x17         x18 </span></a>
<a class="sourceLine" id="cb36-7" title="7"><span class="co">#&gt;   0.1028558  49.3976044   0.0000000  59.8909719   0.5831222   5.8827624 </span></a>
<a class="sourceLine" id="cb36-8" title="8"><span class="co">#&gt;         x19         x20         x21         x22         x23         x24 </span></a>
<a class="sourceLine" id="cb36-9" title="9"><span class="co">#&gt;   6.9380044   3.6694840   0.0000000  11.0675899   0.2983584  16.7356084 </span></a>
<a class="sourceLine" id="cb36-10" title="10"><span class="co">#&gt;         x25         x26         x27         x28         x29         x30 </span></a>
<a class="sourceLine" id="cb36-11" title="11"><span class="co">#&gt;   8.1478577   0.6178652  49.3027867   0.6186457  35.3589748   1.2841470 </span></a>
<a class="sourceLine" id="cb36-12" title="12"><span class="co">#&gt;         x31         x32         x33         x34         x35         x36 </span></a>
<a class="sourceLine" id="cb36-13" title="13"><span class="co">#&gt; 164.0056926  39.4302759   0.0000000   1.7432612  35.4478409   8.4377981 </span></a>
<a class="sourceLine" id="cb36-14" title="14"><span class="co">#&gt;         x37         x38         x39         x40 </span></a>
<a class="sourceLine" id="cb36-15" title="15"><span class="co">#&gt; 138.3060762  12.1775167   5.5399093   0.0000000</span></a>
<a class="sourceLine" id="cb36-16" title="16"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_lasso_mean)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-36-1.png" width="700"></p>
<p>Some probesets seem explanatory for many other ones (=hubs). What are the confidence indices for those variables?</p>
</div>
</div>
<div id="fifth-example" class="section level1">
<h1 class="hasAnchor">
<a href="#fifth-example" class="anchor"></a>Fifth Example</h1>
<div id="aim-4" class="section level2">
<h2 class="hasAnchor">
<a href="#aim-4" class="anchor"></a>Aim</h2>
<p>We want to creates <span class="math inline">\(NDatasets=200\)</span> datasets with <span class="math inline">\(\textrm{length}(group)=500\)</span> variables and <span class="math inline">\(N=25\)</span> observations. In that example we want <span class="math inline">\(1\)</span> group:</p>
<ul>
<li>
<span class="math inline">\(x_1\)</span>, , <span class="math inline">\(x_{500}\)</span> belong to the same group and the intra-group Pearson correlation for this group is equal to <span class="math inline">\(.5\)</span>.</li>
<li>only the first five variables <span class="math inline">\(x_1\)</span>, , <span class="math inline">\(x_{5}\)</span> are explanatory variables for the response.</li>
</ul>
</div>
<div id="correlation-structure-2" class="section level2">
<h2 class="hasAnchor">
<a href="#correlation-structure-2" class="anchor"></a>Correlation structure</h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">  group&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">1</span>,<span class="dv">500</span>) <span class="co">#500 variables</span></a>
<a class="sourceLine" id="cb37-2" title="2">  cor_group&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="fl">0.5</span>,<span class="dv">1</span>)</a></code></pre></div>
</div>
<div id="explanatory-variables-and-response-1" class="section level2">
<h2 class="hasAnchor">
<a href="#explanatory-variables-and-response-1" class="anchor"></a>Explanatory variables and response</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">3141</span>)</a>
<a class="sourceLine" id="cb38-2" title="2">N&lt;-<span class="dv">25</span></a>
<a class="sourceLine" id="cb38-3" title="3">supp&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="dv">495</span>))</a>
<a class="sourceLine" id="cb38-4" title="4">minB&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb38-5" title="5">maxB&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb38-6" title="6">stn&lt;-<span class="dv">50</span></a>
<a class="sourceLine" id="cb38-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb38-8" title="8">  C&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_cor</a></span>(group,cor_group)</a>
<a class="sourceLine" id="cb38-9" title="9">  X&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_X</a></span>(N,C)</a>
<a class="sourceLine" id="cb38-10" title="10">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/assign">assign</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple5_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>),<span class="kw"><a href="../reference/simulation.html">simulation_DATA</a></span>(X,supp,minB,maxB,stn))</a>
<a class="sourceLine" id="cb38-11" title="11">}</a></code></pre></div>
</div>
<div id="checks-3" class="section level2">
<h2 class="hasAnchor">
<a href="#checks-3" class="anchor"></a>Checks</h2>
<p>We now check the correlation structure of the explanatory variable. First we compute the mean correlation matrix.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">corr_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb39-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb39-3" title="3">corr_sum=corr_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple5_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X)</a>
<a class="sourceLine" id="cb39-4" title="4">}</a>
<a class="sourceLine" id="cb39-5" title="5">corr_mean=corr_sum<span class="op">/</span>NDatasets</a></code></pre></div>
<p>Then we display and plot that the mean correlation matrix.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">corr_mean[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a>
<a class="sourceLine" id="cb40-2" title="2"><span class="co">#&gt;            [,1]      [,2]      [,3]      [,4]      [,5]      [,6]</span></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="co">#&gt;  [1,] 1.0000000 0.4684444 0.4944331 0.4628645 0.4961487 0.4956996</span></a>
<a class="sourceLine" id="cb40-4" title="4"><span class="co">#&gt;  [2,] 0.4684444 1.0000000 0.5102506 0.5026134 0.4960774 0.4948349</span></a>
<a class="sourceLine" id="cb40-5" title="5"><span class="co">#&gt;  [3,] 0.4944331 0.5102506 1.0000000 0.4853991 0.4907725 0.5089649</span></a>
<a class="sourceLine" id="cb40-6" title="6"><span class="co">#&gt;  [4,] 0.4628645 0.5026134 0.4853991 1.0000000 0.4670240 0.4837113</span></a>
<a class="sourceLine" id="cb40-7" title="7"><span class="co">#&gt;  [5,] 0.4961487 0.4960774 0.4907725 0.4670240 1.0000000 0.4932811</span></a>
<a class="sourceLine" id="cb40-8" title="8"><span class="co">#&gt;  [6,] 0.4956996 0.4948349 0.5089649 0.4837113 0.4932811 1.0000000</span></a>
<a class="sourceLine" id="cb40-9" title="9"><span class="co">#&gt;  [7,] 0.4654665 0.4813972 0.4925889 0.4948130 0.4723250 0.4759705</span></a>
<a class="sourceLine" id="cb40-10" title="10"><span class="co">#&gt;  [8,] 0.4890355 0.5001703 0.4838451 0.4782784 0.4867136 0.4750897</span></a>
<a class="sourceLine" id="cb40-11" title="11"><span class="co">#&gt;  [9,] 0.4815475 0.4979561 0.4917091 0.4906115 0.4726156 0.4944805</span></a>
<a class="sourceLine" id="cb40-12" title="12"><span class="co">#&gt; [10,] 0.4834349 0.4830943 0.4945958 0.4778387 0.4763692 0.5051952</span></a>
<a class="sourceLine" id="cb40-13" title="13"><span class="co">#&gt;            [,7]      [,8]      [,9]     [,10]</span></a>
<a class="sourceLine" id="cb40-14" title="14"><span class="co">#&gt;  [1,] 0.4654665 0.4890355 0.4815475 0.4834349</span></a>
<a class="sourceLine" id="cb40-15" title="15"><span class="co">#&gt;  [2,] 0.4813972 0.5001703 0.4979561 0.4830943</span></a>
<a class="sourceLine" id="cb40-16" title="16"><span class="co">#&gt;  [3,] 0.4925889 0.4838451 0.4917091 0.4945958</span></a>
<a class="sourceLine" id="cb40-17" title="17"><span class="co">#&gt;  [4,] 0.4948130 0.4782784 0.4906115 0.4778387</span></a>
<a class="sourceLine" id="cb40-18" title="18"><span class="co">#&gt;  [5,] 0.4723250 0.4867136 0.4726156 0.4763692</span></a>
<a class="sourceLine" id="cb40-19" title="19"><span class="co">#&gt;  [6,] 0.4759705 0.4750897 0.4944805 0.5051952</span></a>
<a class="sourceLine" id="cb40-20" title="20"><span class="co">#&gt;  [7,] 1.0000000 0.4680615 0.4906298 0.4770014</span></a>
<a class="sourceLine" id="cb40-21" title="21"><span class="co">#&gt;  [8,] 0.4680615 1.0000000 0.4959996 0.4743232</span></a>
<a class="sourceLine" id="cb40-22" title="22"><span class="co">#&gt;  [9,] 0.4906298 0.4959996 1.0000000 0.4932802</span></a>
<a class="sourceLine" id="cb40-23" title="23"><span class="co">#&gt; [10,] 0.4770014 0.4743232 0.4932802 1.0000000</span></a>
<a class="sourceLine" id="cb40-24" title="24"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(corr_mean))</a></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">coef_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb41-2" title="2">coef_lasso_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb41-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb41-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_lasso_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb41-5" title="5">error_counter=<span class="dv">0</span></a>
<a class="sourceLine" id="cb41-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb41-7" title="7">tempdf=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="dt">Y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple5_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y,</a>
<a class="sourceLine" id="cb41-8" title="8">                        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple5_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X))</a>
<a class="sourceLine" id="cb41-9" title="9">tempcoef=<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(Y<span class="op">~</span>.<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>tempdf))</a>
<a class="sourceLine" id="cb41-10" title="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(lars)</a>
<a class="sourceLine" id="cb41-11" title="11">lasso<span class="fl">.1</span> &lt;-<span class="st"> </span>lars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/lars/topics/lars">lars</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple5_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb41-12" title="12">              <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple5_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y, <span class="dt">type=</span><span class="st">"lasso"</span>, </a>
<a class="sourceLine" id="cb41-13" title="13">              <span class="dt">trace=</span><span class="ot">FALSE</span>, <span class="dt">normalize=</span><span class="ot">FALSE</span>, <span class="dt">intercept =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb41-14" title="14"><span class="co"># cv.lars() uses crossvalidation to estimate optimal position in path</span></a>
<a class="sourceLine" id="cb41-15" title="15">cv.lasso<span class="fl">.1</span> &lt;-<span class="st"> </span>lars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/lars/topics/cv.lars">cv.lars</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple5_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb41-16" title="16">              <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple5_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y, </a>
<a class="sourceLine" id="cb41-17" title="17">              <span class="dt">plot.it=</span><span class="ot">FALSE</span>, <span class="dt">type=</span><span class="st">"lasso"</span>)</a>
<a class="sourceLine" id="cb41-18" title="18"><span class="co"># Use the "+1SE rule" to find best model: </span></a>
<a class="sourceLine" id="cb41-19" title="19"><span class="co">#    Take the min CV and add its SE ("limit").  </span></a>
<a class="sourceLine" id="cb41-20" title="20"><span class="co">#    Find smallest model that has its own CV within this limit (at "s.cv.1")</span></a>
<a class="sourceLine" id="cb41-21" title="21">limit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv) <span class="op">+</span><span class="st"> </span>cv.lasso<span class="fl">.1</span><span class="op">$</span>cv.error[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which.min">which.min</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv)]</a>
<a class="sourceLine" id="cb41-22" title="22">s.cv<span class="fl">.1</span> &lt;-<span class="st"> </span>cv.lasso<span class="fl">.1</span><span class="op">$</span>index[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv <span class="op">&lt;</span><span class="st"> </span>limit))]</a>
<a class="sourceLine" id="cb41-23" title="23"><span class="co"># Print out coefficients at optimal s.</span></a>
<a class="sourceLine" id="cb41-24" title="24">coef_lasso_sum=coef_lasso_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(lasso<span class="fl">.1</span>, <span class="dt">s=</span>s.cv<span class="fl">.1</span>, <span class="dt">mode=</span><span class="st">"fraction"</span>))</a>
<a class="sourceLine" id="cb41-25" title="25"><span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(tempcoef)){</a>
<a class="sourceLine" id="cb41-26" title="26"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"Error in lm fit, skip coefficients</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb41-27" title="27">error_counter=error_counter<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb41-28" title="28">  } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb41-29" title="29">coef_sum=coef_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(tempcoef)</a>
<a class="sourceLine" id="cb41-30" title="30">}</a>
<a class="sourceLine" id="cb41-31" title="31">}</a>
<a class="sourceLine" id="cb41-32" title="32">error_counter</a>
<a class="sourceLine" id="cb41-33" title="33"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb41-34" title="34">coef_mean=coef_sum<span class="op">/</span>NDatasets</a>
<a class="sourceLine" id="cb41-35" title="35">coef_lasso_mean=coef_lasso_sum<span class="op">/</span>NDatasets</a></code></pre></div>
<p>With regular least squares and lasso estimators all fits were sucessful, yet only 20 variables coefficients could be estimated with regular least squares estimates for the linear model. Then we display and plot that the mean coefficient vector values for the least squares estimates.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(coef_mean, <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb42-2" title="2"><span class="co">#&gt;           x1           x2           x3           x4           x5 </span></a>
<a class="sourceLine" id="cb42-3" title="3"><span class="co">#&gt; 1.503770e+00 1.535116e+00 1.484148e+00 1.509255e+00 1.514028e+00 </span></a>
<a class="sourceLine" id="cb42-4" title="4"><span class="co">#&gt;           x6           x7           x8           x9          x10 </span></a>
<a class="sourceLine" id="cb42-5" title="5"><span class="co">#&gt; 3.173485e-15 3.037102e-15 2.889551e-15 3.154865e-15 7.183429e-15 </span></a>
<a class="sourceLine" id="cb42-6" title="6"><span class="co">#&gt;          x11          x12          x13          x14          x15 </span></a>
<a class="sourceLine" id="cb42-7" title="7"><span class="co">#&gt; 3.394267e-15 2.841336e-15 3.716311e-15 3.182421e-15 3.427576e-15 </span></a>
<a class="sourceLine" id="cb42-8" title="8"><span class="co">#&gt;          x16          x17          x18          x19          x20 </span></a>
<a class="sourceLine" id="cb42-9" title="9"><span class="co">#&gt; 3.919400e-15 4.673144e-15 3.955783e-15 3.303872e-15 5.303571e-15 </span></a>
<a class="sourceLine" id="cb42-10" title="10"><span class="co">#&gt;          x21          x22          x23          x24          x25 </span></a>
<a class="sourceLine" id="cb42-11" title="11"><span class="co">#&gt; 5.550495e-15 3.081008e-15 2.254520e-15 3.381582e-15 3.730642e-15 </span></a>
<a class="sourceLine" id="cb42-12" title="12"><span class="co">#&gt;          x26          x27          x28          x29          x30 </span></a>
<a class="sourceLine" id="cb42-13" title="13"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb42-14" title="14"><span class="co">#&gt;          x31          x32          x33          x34          x35 </span></a>
<a class="sourceLine" id="cb42-15" title="15"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb42-16" title="16"><span class="co">#&gt;          x36          x37          x38          x39          x40 </span></a>
<a class="sourceLine" id="cb42-17" title="17"><span class="co">#&gt;           NA           NA           NA           NA           NA</span></a>
<a class="sourceLine" id="cb42-18" title="18"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_mean)</a>
<a class="sourceLine" id="cb42-19" title="19"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-42-1.png" width="700"></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(coef_lasso_mean, <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb43-2" title="2"><span class="co">#&gt;           x1           x2           x3           x4           x5 </span></a>
<a class="sourceLine" id="cb43-3" title="3"><span class="co">#&gt; 3.163481e-01 2.992011e-01 2.460792e-01 2.619038e-01 3.138343e-01 </span></a>
<a class="sourceLine" id="cb43-4" title="4"><span class="co">#&gt;           x6           x7           x8           x9          x10 </span></a>
<a class="sourceLine" id="cb43-5" title="5"><span class="co">#&gt; 1.633413e-03 8.285933e-03 2.664676e-03 1.286248e-03 2.328200e-03 </span></a>
<a class="sourceLine" id="cb43-6" title="6"><span class="co">#&gt;          x11          x12          x13          x14          x15 </span></a>
<a class="sourceLine" id="cb43-7" title="7"><span class="co">#&gt; 8.799246e-04 8.072028e-03 4.276199e-03 6.158855e-03 2.491027e-03 </span></a>
<a class="sourceLine" id="cb43-8" title="8"><span class="co">#&gt;          x16          x17          x18          x19          x20 </span></a>
<a class="sourceLine" id="cb43-9" title="9"><span class="co">#&gt; 0.000000e+00 6.908800e-04 1.025494e-03 5.153866e-04 1.810606e-04 </span></a>
<a class="sourceLine" id="cb43-10" title="10"><span class="co">#&gt;          x21          x22          x23          x24          x25 </span></a>
<a class="sourceLine" id="cb43-11" title="11"><span class="co">#&gt; 2.887157e-03 1.164730e-02 3.420346e-03 0.000000e+00 0.000000e+00 </span></a>
<a class="sourceLine" id="cb43-12" title="12"><span class="co">#&gt;          x26          x27          x28          x29          x30 </span></a>
<a class="sourceLine" id="cb43-13" title="13"><span class="co">#&gt; 1.058844e-02 2.764924e-03 0.000000e+00 0.000000e+00 0.000000e+00 </span></a>
<a class="sourceLine" id="cb43-14" title="14"><span class="co">#&gt;          x31          x32          x33          x34          x35 </span></a>
<a class="sourceLine" id="cb43-15" title="15"><span class="co">#&gt; 2.711486e-03 3.698186e-03 3.852792e-05 3.575717e-03 0.000000e+00 </span></a>
<a class="sourceLine" id="cb43-16" title="16"><span class="co">#&gt;          x36          x37          x38          x39          x40 </span></a>
<a class="sourceLine" id="cb43-17" title="17"><span class="co">#&gt; 1.036557e-02 1.824428e-03 6.567690e-03 1.557148e-03 8.436719e-03</span></a>
<a class="sourceLine" id="cb43-18" title="18"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_lasso_mean,<span class="dt">ylim=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb43-19" title="19"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-43-1.png" width="700"></p>
<p>The simulation process looks sucessfull: the lasso estimates retrives mostly the correct variables, yet the other ones are also selected sometimes. What are the confidence indices for those variables?</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#contents">Contents</a></li>
      <li>
<a href="#first-example">First example</a><ul class="nav nav-pills nav-stacked">
<li><a href="#aim">Aim</a></li>
      <li><a href="#correlation-structure">Correlation structure</a></li>
      <li><a href="#explanatory-dataset-generation">Explanatory dataset generation</a></li>
      <li><a href="#response-derivation">Response derivation</a></li>
      <li><a href="#multiple-datasets-and-checks">Multiple datasets and checks</a></li>
      </ul>
</li>
      <li>
<a href="#second-example">Second example</a><ul class="nav nav-pills nav-stacked">
<li><a href="#aim-1">Aim</a></li>
      <li><a href="#correlation-structure-1">Correlation structure</a></li>
      <li><a href="#explanatory-variables-and-response">Explanatory variables and response</a></li>
      <li><a href="#checks">Checks</a></li>
      </ul>
</li>
      <li>
<a href="#third-example">Third Example</a><ul class="nav nav-pills nav-stacked">
<li><a href="#aim-2">Aim</a></li>
      <li><a href="#data-and-response-generations">Data and response generations</a></li>
      <li><a href="#checks-1">Checks</a></li>
      </ul>
</li>
      <li>
<a href="#fourth-example">Fourth Example</a><ul class="nav nav-pills nav-stacked">
<li><a href="#aim-3">Aim</a></li>
      <li><a href="#data-and-response-generations-1">Data and response generations</a></li>
      <li><a href="#checks-2">Checks</a></li>
      </ul>
</li>
      <li>
<a href="#fifth-example">Fifth Example</a><ul class="nav nav-pills nav-stacked">
<li><a href="#aim-4">Aim</a></li>
      <li><a href="#correlation-structure-2">Correlation structure</a></li>
      <li><a href="#explanatory-variables-and-response-1">Explanatory variables and response</a></li>
      <li><a href="#checks-3">Checks</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Frederic Bertrand, Myriam Maumy-Bertrand.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
