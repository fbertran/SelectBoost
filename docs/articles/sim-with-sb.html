<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulation Tools Provided With the Selectboost Package • SelectBoost</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Simulation Tools Provided With the Selectboost Package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SelectBoost</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/benchmarking-selectboost-networks.html">Benchmarking the SelectBoost Package for Network Reverse Engineering</a>
    </li>
    <li>
      <a href="../articles/confidence-indices-Cascade-networks.html">Towards confidence estimates in Cascade Networks using the SelectBoost package</a>
    </li>
    <li>
      <a href="../articles/sim-with-sb.html">Simulation Tools Provided With the Selectboost Package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fbertran/SelectBoost">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Simulation Tools Provided With the Selectboost Package</h1>
                        <h4 class="author">Frédéric Bertrand</h4>
            <address class="author_afil">
      Université de Strasbourg and CNRS<br><a class="author_email" href="mailto:#"></a><a href="mailto:frederic.bertrand@math.unistra.fr" class="email">frederic.bertrand@math.unistra.fr</a>
      </address>
                  
            <h4 class="date">2019-05-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/fbertran/SelectBoost/blob/master/vignettes/sim-with-sb.Rmd"><code>vignettes/sim-with-sb.Rmd</code></a></small>
      <div class="hidden name"><code>sim-with-sb.Rmd</code></div>

    </div>

    
    
<div id="contents" class="section level1">
<h1 class="hasAnchor">
<a href="#contents" class="anchor"></a>Contents</h1>
<p>This vignette details the simulations tools provided with the selectboost package by providing five examples of use.</p>
</div>
<div id="first-example" class="section level1">
<h1 class="hasAnchor">
<a href="#first-example" class="anchor"></a>First example</h1>
<div id="aim" class="section level2">
<h2 class="hasAnchor">
<a href="#aim" class="anchor"></a>Aim</h2>
<p>We want to creates <span class="math inline">\(NDatasets=200\)</span> datasets with <span class="math inline">\(\textrm{length}(group)=10\)</span> variables and <span class="math inline">\(N=10\)</span> observations. In that example we want <span class="math inline">\(9\)</span> groups:</p>
<ul>
<li>
<span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_{10}\)</span> belong to the first group and the intra-group Pearson correlation for this group is equal to <span class="math inline">\(.95\)</span>,</li>
<li>
<span class="math inline">\(x_2\)</span> belongs to the second group,</li>
<li>
<span class="math inline">\(x_3\)</span> belongs to the third group,</li>
<li>…</li>
<li>
<span class="math inline">\(x_9\)</span> belongs to the ninth group.</li>
</ul>
</div>
<div id="correlation-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#correlation-structure" class="anchor"></a>Correlation structure</h2>
<p>The correlation structure of the explanatory variables of the dataset is provided by <code>group</code> and the intra-group Pearson correlation value for each of the groups by <code>cor_group</code>. A value must be provided even for single variable groups and the number of variables is length of the <code>group</code> vector. Use the <code>simulation_cor</code> function to create the correlation matrix (<code>CM</code>).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(SelectBoost)</a>
<a class="sourceLine" id="cb1-2" title="2">group&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>,<span class="dv">1</span>) <span class="co">#10 variables</span></a>
<a class="sourceLine" id="cb1-3" title="3">cor_group&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="fl">0.95</span>,<span class="dv">9</span>)</a>
<a class="sourceLine" id="cb1-4" title="4">CM&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_cor</a></span>(group,cor_group)</a>
<a class="sourceLine" id="cb1-5" title="5">CM</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt;  [1,] 1.00    0    0    0    0    0    0    0    0  0.95</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#&gt;  [2,] 0.00    1    0    0    0    0    0    0    0  0.00</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt;  [3,] 0.00    0    1    0    0    0    0    0    0  0.00</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt;  [4,] 0.00    0    0    1    0    0    0    0    0  0.00</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt;  [5,] 0.00    0    0    0    1    0    0    0    0  0.00</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">#&gt;  [6,] 0.00    0    0    0    0    1    0    0    0  0.00</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co">#&gt;  [7,] 0.00    0    0    0    0    0    1    0    0  0.00</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co">#&gt;  [8,] 0.00    0    0    0    0    0    0    1    0  0.00</span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="co">#&gt;  [9,] 0.00    0    0    0    0    0    0    0    1  0.00</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="co">#&gt; [10,] 0.95    0    0    0    0    0    0    0    0  1.00</span></a></code></pre></div>
</div>
<div id="explanatory-dataset-generation" class="section level2">
<h2 class="hasAnchor">
<a href="#explanatory-dataset-generation" class="anchor"></a>Explanatory dataset generation</h2>
<p>Then generation of an explanatory dataset with <span class="math inline">\(N=10\)</span> observations is made by the <code>simulation_X</code> function.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">3141</span>)</a>
<a class="sourceLine" id="cb2-2" title="2">N&lt;-<span class="dv">10</span></a>
<a class="sourceLine" id="cb2-3" title="3">X&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_X</a></span>(N,CM)</a>
<a class="sourceLine" id="cb2-4" title="4">X</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt;              [,1]       [,2]        [,3]       [,4]        [,5]</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt;  [1,]  0.69029599 -1.7343187  0.38993973  0.7530345  0.73462394</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt;  [2,] -0.55429733  1.5236359 -0.44435298 -0.8293970  0.02137105</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt;  [3,] -0.65277340 -0.2365804 -0.33365748  1.6144115 -1.38882044</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt;  [4,]  0.06979050 -0.1798988 -0.01576611 -1.6377538 -0.85286458</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt;  [5,] -0.58450206 -1.7411024 -0.13801223 -0.4512545 -0.14449068</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt;  [6,] -1.26045088  0.2087882 -0.72491869  0.6856348 -0.43163916</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt;  [7,]  0.03836372  0.4497529 -0.14266131 -0.6019886  1.36552523</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt;  [8,] -0.52083678 -0.7626927  0.12068723 -1.6146444  0.79777307</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">#&gt;  [9,]  0.30631735  0.9848562 -0.73193720 -1.2236526 -0.59785470</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">#&gt; [10,] -1.67366702  0.8709858 -0.80617294 -0.7559627  1.76655800</span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co">#&gt;              [,6]        [,7]       [,8]       [,9]       [,10]</span></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="co">#&gt;  [1,]  1.91645527  0.23481727 -0.2019611 -1.0254989  0.97524648</span></a>
<a class="sourceLine" id="cb2-18" title="18"><span class="co">#&gt;  [2,]  1.62014297 -0.11230652  1.7600720  1.4330532 -0.46696929</span></a>
<a class="sourceLine" id="cb2-19" title="19"><span class="co">#&gt;  [3,]  1.18979400  1.80315380 -0.7423216 -0.3679811 -0.83315697</span></a>
<a class="sourceLine" id="cb2-20" title="20"><span class="co">#&gt;  [4,]  0.07352177 -0.30160066  0.6676371  2.0313025 -0.07749897</span></a>
<a class="sourceLine" id="cb2-21" title="21"><span class="co">#&gt;  [5,] -0.77910581  0.04835639  0.8040776 -0.2039855 -0.75413152</span></a>
<a class="sourceLine" id="cb2-22" title="22"><span class="co">#&gt;  [6,] -1.62517684  0.56503309 -0.1387350 -0.4091602 -1.09688456</span></a>
<a class="sourceLine" id="cb2-23" title="23"><span class="co">#&gt;  [7,]  0.14761767  1.17868940  0.5279960 -0.5626160 -0.09706896</span></a>
<a class="sourceLine" id="cb2-24" title="24"><span class="co">#&gt;  [8,]  2.41326136 -1.64916614 -0.6481176  1.7608488 -0.69320924</span></a>
<a class="sourceLine" id="cb2-25" title="25"><span class="co">#&gt;  [9,] -0.13138414 -0.44649730  0.4507879  1.4486604  0.60032266</span></a>
<a class="sourceLine" id="cb2-26" title="26"><span class="co">#&gt; [10,]  0.58235105 -1.48612450  0.1245139 -0.9288625 -1.10028291</span></a></code></pre></div>
</div>
<div id="response-derivation" class="section level2">
<h2 class="hasAnchor">
<a href="#response-derivation" class="anchor"></a>Response derivation</h2>
<p>A response can now be added to the dataset by the <code>simulation_Data</code> function. We have to specifiy the support of the response, i.e. the explanatory variables that will be used in the linear model created to compute the response. The support is given by the <code>supp</code> vector whose entries are either <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>. The length of the <code>supp</code> vector must be equal to the number of explanatory variables and if the <span class="math inline">\(i\)</span>entry is equal to <span class="math inline">\(1\)</span>, it means that the <span class="math inline">\(i\)</span>variable will be used to derive the response value, whereas if the <span class="math inline">\(i\)</span>entry is equal to <span class="math inline">\(0\)</span>, it means that the <span class="math inline">\(i\)</span>variable will not be used to derive the response value (<code>beta&lt;-rep(0,length(supp))</code>). The values of the coefficients for the explanatory variables that are in the support of the response are random (either absolute value and sign) and given by <code>beta[which(supp==1)]&lt;-runif(sum(supp),minB,maxB)*(rbinom(sum(supp),1,.5)*2-1)</code>. Hence, the user can specify their minimal absolute value with the <code>minB</code> option and their maximal absolute value with the <code>maxB</code> option. The <code>stn</code> option is a scaling factor for the noise added to the response vector (<code>(t(beta)%*%var(X)%*%beta)/stn</code>, with <code>X</code> the matrix of explanatory variables). The higher the <code>stn</code> value, the smaller the noise: for instance for a given <code>X</code> dataset, an <code>stn</code> value <span class="math inline">\(\alpha\)</span> times larger will result in a noise exactly <span class="math inline">\(\sqrt{\alpha}\)</span> times smaller.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">3141</span>)</a>
<a class="sourceLine" id="cb3-2" title="2">supp&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb3-3" title="3">minB&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb3-4" title="4">maxB&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb3-5" title="5">stn&lt;-<span class="dv">50</span></a>
<a class="sourceLine" id="cb3-6" title="6">firstdataset=<span class="kw"><a href="../reference/simulation.html">simulation_DATA</a></span>(X,supp,minB,maxB,stn)</a>
<a class="sourceLine" id="cb3-7" title="7">firstdataset</a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt; $X</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt;              [,1]       [,2]        [,3]       [,4]        [,5]</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt;  [1,]  0.69029599 -1.7343187  0.38993973  0.7530345  0.73462394</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt;  [2,] -0.55429733  1.5236359 -0.44435298 -0.8293970  0.02137105</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt;  [3,] -0.65277340 -0.2365804 -0.33365748  1.6144115 -1.38882044</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt;  [4,]  0.06979050 -0.1798988 -0.01576611 -1.6377538 -0.85286458</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt;  [5,] -0.58450206 -1.7411024 -0.13801223 -0.4512545 -0.14449068</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt;  [6,] -1.26045088  0.2087882 -0.72491869  0.6856348 -0.43163916</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt;  [7,]  0.03836372  0.4497529 -0.14266131 -0.6019886  1.36552523</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">#&gt;  [8,] -0.52083678 -0.7626927  0.12068723 -1.6146444  0.79777307</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">#&gt;  [9,]  0.30631735  0.9848562 -0.73193720 -1.2236526 -0.59785470</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">#&gt; [10,] -1.67366702  0.8709858 -0.80617294 -0.7559627  1.76655800</span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="co">#&gt;              [,6]        [,7]       [,8]       [,9]       [,10]</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="co">#&gt;  [1,]  1.91645527  0.23481727 -0.2019611 -1.0254989  0.97524648</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="co">#&gt;  [2,]  1.62014297 -0.11230652  1.7600720  1.4330532 -0.46696929</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co">#&gt;  [3,]  1.18979400  1.80315380 -0.7423216 -0.3679811 -0.83315697</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="co">#&gt;  [4,]  0.07352177 -0.30160066  0.6676371  2.0313025 -0.07749897</span></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="co">#&gt;  [5,] -0.77910581  0.04835639  0.8040776 -0.2039855 -0.75413152</span></a>
<a class="sourceLine" id="cb3-26" title="26"><span class="co">#&gt;  [6,] -1.62517684  0.56503309 -0.1387350 -0.4091602 -1.09688456</span></a>
<a class="sourceLine" id="cb3-27" title="27"><span class="co">#&gt;  [7,]  0.14761767  1.17868940  0.5279960 -0.5626160 -0.09706896</span></a>
<a class="sourceLine" id="cb3-28" title="28"><span class="co">#&gt;  [8,]  2.41326136 -1.64916614 -0.6481176  1.7608488 -0.69320924</span></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="co">#&gt;  [9,] -0.13138414 -0.44649730  0.4507879  1.4486604  0.60032266</span></a>
<a class="sourceLine" id="cb3-30" title="30"><span class="co">#&gt; [10,]  0.58235105 -1.48612450  0.1245139 -0.9288625 -1.10028291</span></a>
<a class="sourceLine" id="cb3-31" title="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-32" title="32"><span class="co">#&gt; $Y</span></a>
<a class="sourceLine" id="cb3-33" title="33"><span class="co">#&gt;  [1] -4.2132936  3.5039588  0.3332549 -0.4924011 -2.5391834  1.8674007</span></a>
<a class="sourceLine" id="cb3-34" title="34"><span class="co">#&gt;  [7]  0.6678607 -0.4589311  0.6353867  3.8091855</span></a>
<a class="sourceLine" id="cb3-35" title="35"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-36" title="36"><span class="co">#&gt; $support</span></a>
<a class="sourceLine" id="cb3-37" title="37"><span class="co">#&gt;  [1] 1 1 1 0 0 0 0 0 0 0</span></a>
<a class="sourceLine" id="cb3-38" title="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-39" title="39"><span class="co">#&gt; $beta</span></a>
<a class="sourceLine" id="cb3-40" title="40"><span class="co">#&gt;  [1] -1.754996  1.964992  1.041431  0.000000  0.000000  0.000000  0.000000</span></a>
<a class="sourceLine" id="cb3-41" title="41"><span class="co">#&gt;  [8]  0.000000  0.000000  0.000000</span></a>
<a class="sourceLine" id="cb3-42" title="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-43" title="43"><span class="co">#&gt; $stn</span></a>
<a class="sourceLine" id="cb3-44" title="44"><span class="co">#&gt; [1] 50</span></a>
<a class="sourceLine" id="cb3-45" title="45"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-46" title="46"><span class="co">#&gt; $sigma</span></a>
<a class="sourceLine" id="cb3-47" title="47"><span class="co">#&gt;           [,1]</span></a>
<a class="sourceLine" id="cb3-48" title="48"><span class="co">#&gt; [1,] 0.3493447</span></a>
<a class="sourceLine" id="cb3-49" title="49"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-50" title="50"><span class="co">#&gt; attr(,"class")</span></a>
<a class="sourceLine" id="cb3-51" title="51"><span class="co">#&gt; [1] "simuls"</span></a></code></pre></div>
</div>
<div id="multiple-datasets-and-checks" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-datasets-and-checks" class="anchor"></a>Multiple datasets and checks</h2>
<p>To generate multiple datasets, repeat steps 2 and 3, for instance use a <code>for</code> loop. We create <span class="math inline">\(NDatasets=200\)</span> datasets and assign them to the objects <code>DATA_exemple1_nb_1</code> to <code>DATA_exemple1_nb_200</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">3141</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">NDatasets=<span class="dv">200</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb4-4" title="4">X&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_X</a></span>(N,CM)</a>
<a class="sourceLine" id="cb4-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/assign">assign</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>),<span class="kw"><a href="../reference/simulation.html">simulation_DATA</a></span>(X,supp,minB,maxB,stn))</a>
<a class="sourceLine" id="cb4-6" title="6">}</a></code></pre></div>
<p>We now check the correlation structure of the explanatory variable. First we compute the mean correlation matrix.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">corr_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb5-3" title="3">corr_sum=corr_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X)</a>
<a class="sourceLine" id="cb5-4" title="4">}</a>
<a class="sourceLine" id="cb5-5" title="5">corr_mean=corr_sum<span class="op">/</span>NDatasets</a></code></pre></div>
<p>Then we display and plot that the mean correlation matrix.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">corr_mean</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">#&gt;                [,1]          [,2]          [,3]          [,4]         [,5]</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">#&gt;  [1,]  1.0000000000 -0.0008611262  0.0193872629  0.0192496952 -0.012147407</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt;  [2,] -0.0008611262  1.0000000000 -0.0520800766  0.0144798781  0.006237499</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#&gt;  [3,]  0.0193872629 -0.0520800766  1.0000000000  0.0008693002 -0.021373842</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt;  [4,]  0.0192496952  0.0144798781  0.0008693002  1.0000000000  0.007753693</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt;  [5,] -0.0121474071  0.0062374994 -0.0213738420  0.0077536931  1.000000000</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt;  [6,] -0.0089756967 -0.0404111300  0.0344817040  0.0081889675  0.018018674</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt;  [7,] -0.0082911544  0.0072612885 -0.0233188445 -0.0380192689  0.023833224</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt;  [8,]  0.0272233550 -0.0066654749 -0.0487035643  0.0172624295  0.043181249</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt;  [9,] -0.0145986545  0.0071146338  0.0364868095 -0.0020153080 -0.027733046</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">#&gt; [10,]  0.9422544272 -0.0071281448  0.0264886880  0.0221950354 -0.003811061</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">#&gt;               [,6]         [,7]         [,8]         [,9]        [,10]</span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">#&gt;  [1,] -0.008975697 -0.008291154  0.027223355 -0.014598655  0.942254427</span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">#&gt;  [2,] -0.040411130  0.007261289 -0.006665475  0.007114634 -0.007128145</span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="co">#&gt;  [3,]  0.034481704 -0.023318845 -0.048703564  0.036486809  0.026488688</span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co">#&gt;  [4,]  0.008188968 -0.038019269  0.017262430 -0.002015308  0.022195035</span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">#&gt;  [5,]  0.018018674  0.023833224  0.043181249 -0.027733046 -0.003811061</span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="co">#&gt;  [6,]  1.000000000 -0.015449494 -0.004054573  0.006159349  0.003444504</span></a>
<a class="sourceLine" id="cb6-20" title="20"><span class="co">#&gt;  [7,] -0.015449494  1.000000000 -0.002105066  0.005052182 -0.018230902</span></a>
<a class="sourceLine" id="cb6-21" title="21"><span class="co">#&gt;  [8,] -0.004054573 -0.002105066  1.000000000 -0.003169857  0.021688766</span></a>
<a class="sourceLine" id="cb6-22" title="22"><span class="co">#&gt;  [9,]  0.006159349  0.005052182 -0.003169857  1.000000000 -0.013388952</span></a>
<a class="sourceLine" id="cb6-23" title="23"><span class="co">#&gt; [10,]  0.003444504 -0.018230902  0.021688766 -0.013388952  1.000000000</span></a>
<a class="sourceLine" id="cb6-24" title="24"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(corr_mean))</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">coef_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb7-3" title="3">error_counter=<span class="dv">0</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb7-5" title="5">tempdf=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="dt">Y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y,</a>
<a class="sourceLine" id="cb7-6" title="6">                        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X))</a>
<a class="sourceLine" id="cb7-7" title="7">tempcoef=<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(Y<span class="op">~</span>.<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>tempdf))</a>
<a class="sourceLine" id="cb7-8" title="8"><span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(tempcoef)){</a>
<a class="sourceLine" id="cb7-9" title="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"Error in lm fit, skip coefficients</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb7-10" title="10">error_counter=error_counter<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb7-11" title="11">  } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb7-12" title="12">coef_sum=coef_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(tempcoef)</a>
<a class="sourceLine" id="cb7-13" title="13">}</a>
<a class="sourceLine" id="cb7-14" title="14">}</a>
<a class="sourceLine" id="cb7-15" title="15">error_counter</a>
<a class="sourceLine" id="cb7-16" title="16"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb7-17" title="17">coef_mean=coef_sum<span class="op">/</span>NDatasets</a></code></pre></div>
<p>All fits were sucessful. Then we display and plot that the mean coefficient vector values.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">coef_mean</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt;           x1           x2           x3           x4           x5 </span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt; 1.508327e+00 1.518967e+00 1.491694e+00 1.437883e-15 1.857978e-15 </span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt;           x6           x7           x8           x9          x10 </span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#&gt; 2.524863e-15 1.848380e-15 2.314167e-15 2.601342e-15 6.269818e-15</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_mean)</a>
<a class="sourceLine" id="cb8-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Reduce the noise in the response for the new responses by a factor <span class="math inline">\(\sqrt{5000/50}=10\)</span>. <span class="math inline">\(1/stn\cdot \beta_{support}^t\mathrm{Var}(X)\beta_{support}\)</span> where <span class="math inline">\(\beta_{support}\)</span> is the vector of coefficients wh</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">3141</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">stn &lt;-<span class="st"> </span><span class="dv">5000</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb9-4" title="4">X&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_X</a></span>(N,CM)</a>
<a class="sourceLine" id="cb9-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/assign">assign</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_bis_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>),<span class="kw"><a href="../reference/simulation.html">simulation_DATA</a></span>(X,supp,minB,maxB,stn))</a>
<a class="sourceLine" id="cb9-6" title="6">}</a></code></pre></div>
<p>Since it is the same explanatory dataset for response generation, we can compare the <span class="math inline">\(\sigma\)</span> between those <span class="math inline">\(NDatasets=200\)</span> datasets.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">stn_ratios=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,NDatasets)</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb10-3" title="3">stn_ratios[i]&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>sigma<span class="op">/</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_bis_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>sigma</a>
<a class="sourceLine" id="cb10-5" title="5">}</a>
<a class="sourceLine" id="cb10-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all">all</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(stn_ratios,all.equal,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>All the ratios are equal to 10 as anticipated.</p>
<p>Since, the correlation structure is the same as before, we do not need to check it again. As befor, we infer the coefficients values of a linear model using the <code>lm</code> function.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">coef_sum_bis=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_sum_bis)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb11-3" title="3">error_counter_bis=<span class="dv">0</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb11-5" title="5">tempdf=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="dt">Y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_bis_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y,</a>
<a class="sourceLine" id="cb11-6" title="6">                        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple1_bis_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X))</a>
<a class="sourceLine" id="cb11-7" title="7">tempcoef=<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(Y<span class="op">~</span>.<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>tempdf))</a>
<a class="sourceLine" id="cb11-8" title="8"><span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(tempcoef)){</a>
<a class="sourceLine" id="cb11-9" title="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"Error in lm fit, skip coefficients</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb11-10" title="10">error_counter_bis=error_counte_bisr<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb11-11" title="11">  } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb11-12" title="12">coef_sum_bis=coef_sum_bis<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(tempcoef)</a>
<a class="sourceLine" id="cb11-13" title="13">}</a>
<a class="sourceLine" id="cb11-14" title="14">}</a>
<a class="sourceLine" id="cb11-15" title="15">error_counter_bis</a>
<a class="sourceLine" id="cb11-16" title="16"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb11-17" title="17">coef_mean_bis=coef_sum_bis<span class="op">/</span>NDatasets</a></code></pre></div>
<p>All fits were sucessful. Then we display and plot that the mean coefficient vector values. As expected, the noise reduction enhances the retrieval of the <code>true</code> mean coefficient absolute values by the models.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">coef_mean_bis</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">#&gt;           x1           x2           x3           x4           x5 </span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="co">#&gt; 1.508327e+00 1.518967e+00 1.491694e+00 1.437883e-15 1.857978e-15 </span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="co">#&gt;           x6           x7           x8           x9          x10 </span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="co">#&gt; 2.524863e-15 1.848380e-15 2.314167e-15 2.601342e-15 6.269818e-15</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_mean_bis)</a>
<a class="sourceLine" id="cb12-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>The simulation process looks sucessfull. What are the confidence indices for those variables?</p>
</div>
</div>
<div id="second-example" class="section level1">
<h1 class="hasAnchor">
<a href="#second-example" class="anchor"></a>Second example</h1>
<div id="aim-1" class="section level2">
<h2 class="hasAnchor">
<a href="#aim-1" class="anchor"></a>Aim</h2>
<p>We want to creates <span class="math inline">\(NDatasets=200\)</span> datasets with <span class="math inline">\(\textrm{length}(group)=50\)</span> variables and <span class="math inline">\(N=20\)</span> observations. In that example we want <span class="math inline">\(1\)</span> group:</p>
<ul>
<li>
<span class="math inline">\(x_1\)</span>, , <span class="math inline">\(x_{50}\)</span> belong to the same group and the intra-group Pearson correlation for this group is equal to <span class="math inline">\(.5\)</span>.</li>
<li>only the first five variables <span class="math inline">\(x_1\)</span>, , <span class="math inline">\(x_{5}\)</span> are explanatory variables for the response.</li>
</ul>
</div>
<div id="correlation-structure-1" class="section level2">
<h2 class="hasAnchor">
<a href="#correlation-structure-1" class="anchor"></a>Correlation structure</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">group&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">1</span>,<span class="dv">50</span>) <span class="co">#50 variables</span></a>
<a class="sourceLine" id="cb13-2" title="2">cor_group&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="fl">0.5</span>,<span class="dv">1</span>)</a></code></pre></div>
</div>
<div id="explanatory-variables-and-response" class="section level2">
<h2 class="hasAnchor">
<a href="#explanatory-variables-and-response" class="anchor"></a>Explanatory variables and response</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">3141</span>)</a>
<a class="sourceLine" id="cb14-2" title="2">N&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb14-3" title="3">supp&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="dv">45</span>))</a>
<a class="sourceLine" id="cb14-4" title="4">minB&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb14-5" title="5">maxB&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb14-6" title="6">stn&lt;-<span class="dv">50</span></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">200</span>){</a>
<a class="sourceLine" id="cb14-8" title="8">C&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_cor</a></span>(group,cor_group)</a>
<a class="sourceLine" id="cb14-9" title="9">X&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_X</a></span>(N,C)</a>
<a class="sourceLine" id="cb14-10" title="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/assign">assign</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple2_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>),<span class="kw"><a href="../reference/simulation.html">simulation_DATA</a></span>(X,supp,minB,maxB,stn))</a>
<a class="sourceLine" id="cb14-11" title="11">}</a></code></pre></div>
</div>
<div id="checks" class="section level2">
<h2 class="hasAnchor">
<a href="#checks" class="anchor"></a>Checks</h2>
<p>We now check the correlation structure of the explanatory variable. First we compute the mean correlation matrix.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">corr_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb15-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb15-3" title="3">corr_sum=corr_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple2_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X)</a>
<a class="sourceLine" id="cb15-4" title="4">}</a>
<a class="sourceLine" id="cb15-5" title="5">corr_mean=corr_sum<span class="op">/</span>NDatasets</a></code></pre></div>
<p>Then we display and plot that the mean correlation matrix.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">corr_mean</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="co">#&gt;            [,1]      [,2]      [,3]      [,4]      [,5]      [,6]</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co">#&gt;  [1,] 1.0000000 0.4875195 0.4774265 0.4739869 0.4796578 0.4927521</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co">#&gt;  [2,] 0.4875195 1.0000000 0.4750680 0.4940743 0.4842295 0.4988293</span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="co">#&gt;  [3,] 0.4774265 0.4750680 1.0000000 0.4799584 0.4690139 0.4831884</span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="co">#&gt;  [4,] 0.4739869 0.4940743 0.4799584 1.0000000 0.4990798 0.4995625</span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="co">#&gt;  [5,] 0.4796578 0.4842295 0.4690139 0.4990798 1.0000000 0.4890548</span></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="co">#&gt;  [6,] 0.4927521 0.4988293 0.4831884 0.4995625 0.4890548 1.0000000</span></a>
<a class="sourceLine" id="cb16-9" title="9"><span class="co">#&gt;  [7,] 0.4898313 0.4937678 0.4765315 0.4928739 0.4839137 0.4980120</span></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="co">#&gt;  [8,] 0.4786241 0.4904904 0.4871110 0.4799335 0.4807772 0.5015775</span></a>
<a class="sourceLine" id="cb16-11" title="11"><span class="co">#&gt;  [9,] 0.4821186 0.4801270 0.4648431 0.4774361 0.4657147 0.4942747</span></a>
<a class="sourceLine" id="cb16-12" title="12"><span class="co">#&gt; [10,] 0.4875410 0.4690954 0.4669033 0.4832185 0.4781301 0.4873754</span></a>
<a class="sourceLine" id="cb16-13" title="13"><span class="co">#&gt; [11,] 0.4783657 0.4770548 0.4796298 0.5025294 0.4695987 0.4947963</span></a>
<a class="sourceLine" id="cb16-14" title="14"><span class="co">#&gt; [12,] 0.4576129 0.4687866 0.4600303 0.4594116 0.4642672 0.4701666</span></a>
<a class="sourceLine" id="cb16-15" title="15"><span class="co">#&gt; [13,] 0.4822459 0.4883539 0.4771578 0.4894813 0.4756020 0.4798124</span></a>
<a class="sourceLine" id="cb16-16" title="16"><span class="co">#&gt; [14,] 0.4920481 0.4873377 0.4770949 0.4897802 0.4788390 0.4987037</span></a>
<a class="sourceLine" id="cb16-17" title="17"><span class="co">#&gt; [15,] 0.4782112 0.4778776 0.4682025 0.4967626 0.4853587 0.4876864</span></a>
<a class="sourceLine" id="cb16-18" title="18"><span class="co">#&gt; [16,] 0.4864012 0.4678037 0.4556066 0.4886135 0.4834922 0.4948217</span></a>
<a class="sourceLine" id="cb16-19" title="19"><span class="co">#&gt; [17,] 0.4734487 0.4828857 0.4685047 0.4984130 0.4939708 0.4952123</span></a>
<a class="sourceLine" id="cb16-20" title="20"><span class="co">#&gt; [18,] 0.4859982 0.4722309 0.4530913 0.4972202 0.4672407 0.5002855</span></a>
<a class="sourceLine" id="cb16-21" title="21"><span class="co">#&gt; [19,] 0.4884947 0.4893830 0.4690835 0.4940133 0.4842340 0.4976708</span></a>
<a class="sourceLine" id="cb16-22" title="22"><span class="co">#&gt; [20,] 0.4769456 0.4882431 0.4622852 0.4875306 0.4738559 0.4877937</span></a>
<a class="sourceLine" id="cb16-23" title="23"><span class="co">#&gt; [21,] 0.4845333 0.4729958 0.4723665 0.4980684 0.4828438 0.4968660</span></a>
<a class="sourceLine" id="cb16-24" title="24"><span class="co">#&gt; [22,] 0.4755725 0.4648695 0.4603616 0.4824270 0.4681446 0.4974565</span></a>
<a class="sourceLine" id="cb16-25" title="25"><span class="co">#&gt; [23,] 0.4785721 0.4830047 0.4718748 0.4724900 0.4544924 0.4826462</span></a>
<a class="sourceLine" id="cb16-26" title="26"><span class="co">#&gt; [24,] 0.4812916 0.4860090 0.4700513 0.4931349 0.4815146 0.4950953</span></a>
<a class="sourceLine" id="cb16-27" title="27"><span class="co">#&gt; [25,] 0.4846545 0.4665178 0.4606474 0.4918001 0.4893474 0.4893959</span></a>
<a class="sourceLine" id="cb16-28" title="28"><span class="co">#&gt; [26,] 0.4808411 0.4737219 0.4643057 0.5002998 0.4803186 0.5013771</span></a>
<a class="sourceLine" id="cb16-29" title="29"><span class="co">#&gt; [27,] 0.4891191 0.4908924 0.4654202 0.4885751 0.4779262 0.4930224</span></a>
<a class="sourceLine" id="cb16-30" title="30"><span class="co">#&gt; [28,] 0.4936341 0.4869816 0.4876323 0.4677534 0.4657898 0.4827985</span></a>
<a class="sourceLine" id="cb16-31" title="31"><span class="co">#&gt; [29,] 0.4714080 0.4729929 0.4636616 0.4897793 0.4703940 0.4923885</span></a>
<a class="sourceLine" id="cb16-32" title="32"><span class="co">#&gt; [30,] 0.4917403 0.4850833 0.4945158 0.5115070 0.4901434 0.4877026</span></a>
<a class="sourceLine" id="cb16-33" title="33"><span class="co">#&gt; [31,] 0.4783833 0.4748192 0.4309901 0.4816259 0.4576951 0.4656926</span></a>
<a class="sourceLine" id="cb16-34" title="34"><span class="co">#&gt; [32,] 0.4873584 0.4826642 0.4780154 0.4854468 0.4827977 0.4901430</span></a>
<a class="sourceLine" id="cb16-35" title="35"><span class="co">#&gt; [33,] 0.4640036 0.4813325 0.4652324 0.4990741 0.4855674 0.5095961</span></a>
<a class="sourceLine" id="cb16-36" title="36"><span class="co">#&gt; [34,] 0.4792123 0.4777674 0.4716173 0.4870715 0.4947423 0.4848990</span></a>
<a class="sourceLine" id="cb16-37" title="37"><span class="co">#&gt; [35,] 0.4901280 0.4862023 0.4759520 0.4949398 0.4953567 0.4964275</span></a>
<a class="sourceLine" id="cb16-38" title="38"><span class="co">#&gt; [36,] 0.4725565 0.4894948 0.4625650 0.4954372 0.4948100 0.4765726</span></a>
<a class="sourceLine" id="cb16-39" title="39"><span class="co">#&gt; [37,] 0.4719593 0.4855221 0.4831415 0.4754273 0.4637818 0.4865522</span></a>
<a class="sourceLine" id="cb16-40" title="40"><span class="co">#&gt; [38,] 0.4779563 0.4774590 0.4749940 0.4717642 0.4883992 0.4740700</span></a>
<a class="sourceLine" id="cb16-41" title="41"><span class="co">#&gt; [39,] 0.4721031 0.4674040 0.4705461 0.4714857 0.4787467 0.4947978</span></a>
<a class="sourceLine" id="cb16-42" title="42"><span class="co">#&gt; [40,] 0.4869209 0.4722870 0.4853659 0.4973100 0.4887614 0.4910427</span></a>
<a class="sourceLine" id="cb16-43" title="43"><span class="co">#&gt; [41,] 0.4755148 0.4802082 0.4678359 0.4840367 0.4915594 0.4872499</span></a>
<a class="sourceLine" id="cb16-44" title="44"><span class="co">#&gt; [42,] 0.4933048 0.4961259 0.4716815 0.4952857 0.4705448 0.5021658</span></a>
<a class="sourceLine" id="cb16-45" title="45"><span class="co">#&gt; [43,] 0.4692270 0.4563265 0.4744040 0.4750798 0.4793421 0.4945674</span></a>
<a class="sourceLine" id="cb16-46" title="46"><span class="co">#&gt; [44,] 0.4764247 0.4608961 0.4579432 0.4963250 0.4669837 0.4832757</span></a>
<a class="sourceLine" id="cb16-47" title="47"><span class="co">#&gt; [45,] 0.4899229 0.4851334 0.4746741 0.4920976 0.4682805 0.4816624</span></a>
<a class="sourceLine" id="cb16-48" title="48"><span class="co">#&gt; [46,] 0.4889441 0.4802540 0.4709218 0.4870914 0.4806206 0.4772949</span></a>
<a class="sourceLine" id="cb16-49" title="49"><span class="co">#&gt; [47,] 0.4698197 0.4668164 0.4669458 0.4767222 0.4708015 0.4843022</span></a>
<a class="sourceLine" id="cb16-50" title="50"><span class="co">#&gt; [48,] 0.4764185 0.4806782 0.4692607 0.4887845 0.4810478 0.4804733</span></a>
<a class="sourceLine" id="cb16-51" title="51"><span class="co">#&gt; [49,] 0.4784021 0.4907013 0.4636844 0.4862231 0.4718067 0.4974101</span></a>
<a class="sourceLine" id="cb16-52" title="52"><span class="co">#&gt; [50,] 0.4849035 0.4764679 0.4687569 0.4909447 0.4699619 0.4921324</span></a>
<a class="sourceLine" id="cb16-53" title="53"><span class="co">#&gt;            [,7]      [,8]      [,9]     [,10]     [,11]     [,12]</span></a>
<a class="sourceLine" id="cb16-54" title="54"><span class="co">#&gt;  [1,] 0.4898313 0.4786241 0.4821186 0.4875410 0.4783657 0.4576129</span></a>
<a class="sourceLine" id="cb16-55" title="55"><span class="co">#&gt;  [2,] 0.4937678 0.4904904 0.4801270 0.4690954 0.4770548 0.4687866</span></a>
<a class="sourceLine" id="cb16-56" title="56"><span class="co">#&gt;  [3,] 0.4765315 0.4871110 0.4648431 0.4669033 0.4796298 0.4600303</span></a>
<a class="sourceLine" id="cb16-57" title="57"><span class="co">#&gt;  [4,] 0.4928739 0.4799335 0.4774361 0.4832185 0.5025294 0.4594116</span></a>
<a class="sourceLine" id="cb16-58" title="58"><span class="co">#&gt;  [5,] 0.4839137 0.4807772 0.4657147 0.4781301 0.4695987 0.4642672</span></a>
<a class="sourceLine" id="cb16-59" title="59"><span class="co">#&gt;  [6,] 0.4980120 0.5015775 0.4942747 0.4873754 0.4947963 0.4701666</span></a>
<a class="sourceLine" id="cb16-60" title="60"><span class="co">#&gt;  [7,] 1.0000000 0.4766888 0.4786140 0.4825714 0.4892342 0.4788017</span></a>
<a class="sourceLine" id="cb16-61" title="61"><span class="co">#&gt;  [8,] 0.4766888 1.0000000 0.4783224 0.4832658 0.4763580 0.4674537</span></a>
<a class="sourceLine" id="cb16-62" title="62"><span class="co">#&gt;  [9,] 0.4786140 0.4783224 1.0000000 0.4769654 0.4720242 0.4746469</span></a>
<a class="sourceLine" id="cb16-63" title="63"><span class="co">#&gt; [10,] 0.4825714 0.4832658 0.4769654 1.0000000 0.4918464 0.4709846</span></a>
<a class="sourceLine" id="cb16-64" title="64"><span class="co">#&gt; [11,] 0.4892342 0.4763580 0.4720242 0.4918464 1.0000000 0.4636345</span></a>
<a class="sourceLine" id="cb16-65" title="65"><span class="co">#&gt; [12,] 0.4788017 0.4674537 0.4746469 0.4709846 0.4636345 1.0000000</span></a>
<a class="sourceLine" id="cb16-66" title="66"><span class="co">#&gt; [13,] 0.4808382 0.4956266 0.4823945 0.4936922 0.4731281 0.4801398</span></a>
<a class="sourceLine" id="cb16-67" title="67"><span class="co">#&gt; [14,] 0.4883376 0.4930876 0.4797224 0.5033033 0.4920632 0.4698280</span></a>
<a class="sourceLine" id="cb16-68" title="68"><span class="co">#&gt; [15,] 0.4792324 0.4809700 0.4768434 0.4866386 0.4808335 0.4696827</span></a>
<a class="sourceLine" id="cb16-69" title="69"><span class="co">#&gt; [16,] 0.4868757 0.4895207 0.4721254 0.5011239 0.4674742 0.4619399</span></a>
<a class="sourceLine" id="cb16-70" title="70"><span class="co">#&gt; [17,] 0.4763295 0.4706260 0.4743240 0.4958309 0.4874545 0.4704200</span></a>
<a class="sourceLine" id="cb16-71" title="71"><span class="co">#&gt; [18,] 0.4629523 0.4762839 0.4805138 0.4737332 0.4878792 0.4655437</span></a>
<a class="sourceLine" id="cb16-72" title="72"><span class="co">#&gt; [19,] 0.4817665 0.4944945 0.4875990 0.4829353 0.4844524 0.4773638</span></a>
<a class="sourceLine" id="cb16-73" title="73"><span class="co">#&gt; [20,] 0.4743795 0.4767088 0.4836865 0.4852129 0.4742222 0.4836104</span></a>
<a class="sourceLine" id="cb16-74" title="74"><span class="co">#&gt; [21,] 0.4939446 0.4869934 0.4759185 0.4892903 0.4778314 0.4556323</span></a>
<a class="sourceLine" id="cb16-75" title="75"><span class="co">#&gt; [22,] 0.4763436 0.4799268 0.4822721 0.4856681 0.4666168 0.4766126</span></a>
<a class="sourceLine" id="cb16-76" title="76"><span class="co">#&gt; [23,] 0.4733935 0.4954698 0.4783873 0.4791022 0.4766153 0.4582730</span></a>
<a class="sourceLine" id="cb16-77" title="77"><span class="co">#&gt; [24,] 0.4875954 0.4984575 0.4723351 0.4961801 0.4859154 0.4687650</span></a>
<a class="sourceLine" id="cb16-78" title="78"><span class="co">#&gt; [25,] 0.4739336 0.4701275 0.4612150 0.4739090 0.4766505 0.4615609</span></a>
<a class="sourceLine" id="cb16-79" title="79"><span class="co">#&gt; [26,] 0.4831338 0.4815275 0.4703430 0.4880500 0.4721046 0.4479072</span></a>
<a class="sourceLine" id="cb16-80" title="80"><span class="co">#&gt; [27,] 0.4916385 0.4841950 0.4754536 0.4815638 0.4937348 0.4729812</span></a>
<a class="sourceLine" id="cb16-81" title="81"><span class="co">#&gt; [28,] 0.4770920 0.4781211 0.4770095 0.4780036 0.4775544 0.4595986</span></a>
<a class="sourceLine" id="cb16-82" title="82"><span class="co">#&gt; [29,] 0.4809823 0.4843828 0.4769052 0.4858577 0.4819737 0.4755582</span></a>
<a class="sourceLine" id="cb16-83" title="83"><span class="co">#&gt; [30,] 0.4821198 0.4804490 0.4686953 0.4789211 0.4836126 0.4643350</span></a>
<a class="sourceLine" id="cb16-84" title="84"><span class="co">#&gt; [31,] 0.4771737 0.4757865 0.4646181 0.4743184 0.4703910 0.4486803</span></a>
<a class="sourceLine" id="cb16-85" title="85"><span class="co">#&gt; [32,] 0.4910006 0.4774881 0.4892755 0.4896759 0.4762494 0.4824998</span></a>
<a class="sourceLine" id="cb16-86" title="86"><span class="co">#&gt; [33,] 0.4915774 0.4885218 0.4760087 0.5045791 0.4916346 0.4755129</span></a>
<a class="sourceLine" id="cb16-87" title="87"><span class="co">#&gt; [34,] 0.5020113 0.4831743 0.4828129 0.4958861 0.4857938 0.4755785</span></a>
<a class="sourceLine" id="cb16-88" title="88"><span class="co">#&gt; [35,] 0.4955914 0.5002030 0.5050260 0.4980666 0.4861022 0.4558443</span></a>
<a class="sourceLine" id="cb16-89" title="89"><span class="co">#&gt; [36,] 0.4781649 0.4888230 0.4759993 0.4730603 0.4865827 0.4657525</span></a>
<a class="sourceLine" id="cb16-90" title="90"><span class="co">#&gt; [37,] 0.4781031 0.4791546 0.4750702 0.4784534 0.4849143 0.4556314</span></a>
<a class="sourceLine" id="cb16-91" title="91"><span class="co">#&gt; [38,] 0.4727700 0.4974627 0.4985710 0.4844597 0.4828155 0.4644094</span></a>
<a class="sourceLine" id="cb16-92" title="92"><span class="co">#&gt; [39,] 0.4911010 0.4762907 0.4720078 0.4712645 0.4578978 0.4657783</span></a>
<a class="sourceLine" id="cb16-93" title="93"><span class="co">#&gt; [40,] 0.4820505 0.4817914 0.4738119 0.4930812 0.4830126 0.4656365</span></a>
<a class="sourceLine" id="cb16-94" title="94"><span class="co">#&gt; [41,] 0.4825601 0.4836127 0.4860934 0.4878069 0.4759695 0.4480472</span></a>
<a class="sourceLine" id="cb16-95" title="95"><span class="co">#&gt; [42,] 0.5018230 0.4744781 0.4740408 0.4880989 0.5045427 0.4836311</span></a>
<a class="sourceLine" id="cb16-96" title="96"><span class="co">#&gt; [43,] 0.4735202 0.4580146 0.4619681 0.4641387 0.4643393 0.4672788</span></a>
<a class="sourceLine" id="cb16-97" title="97"><span class="co">#&gt; [44,] 0.4651638 0.4733707 0.4682082 0.4830317 0.4781812 0.4636922</span></a>
<a class="sourceLine" id="cb16-98" title="98"><span class="co">#&gt; [45,] 0.4711068 0.4831673 0.4937510 0.4804080 0.4842292 0.4483362</span></a>
<a class="sourceLine" id="cb16-99" title="99"><span class="co">#&gt; [46,] 0.4655142 0.4876824 0.4871867 0.4599700 0.4759348 0.4721072</span></a>
<a class="sourceLine" id="cb16-100" title="100"><span class="co">#&gt; [47,] 0.4806587 0.4705897 0.4614901 0.4632926 0.4781888 0.4584353</span></a>
<a class="sourceLine" id="cb16-101" title="101"><span class="co">#&gt; [48,] 0.4782227 0.4798805 0.4735808 0.4855319 0.4567081 0.4723551</span></a>
<a class="sourceLine" id="cb16-102" title="102"><span class="co">#&gt; [49,] 0.4801952 0.4833423 0.4692315 0.4660855 0.4922189 0.4715573</span></a>
<a class="sourceLine" id="cb16-103" title="103"><span class="co">#&gt; [50,] 0.4860767 0.4836131 0.4878037 0.4935527 0.4784185 0.4713054</span></a>
<a class="sourceLine" id="cb16-104" title="104"><span class="co">#&gt;           [,13]     [,14]     [,15]     [,16]     [,17]     [,18]</span></a>
<a class="sourceLine" id="cb16-105" title="105"><span class="co">#&gt;  [1,] 0.4822459 0.4920481 0.4782112 0.4864012 0.4734487 0.4859982</span></a>
<a class="sourceLine" id="cb16-106" title="106"><span class="co">#&gt;  [2,] 0.4883539 0.4873377 0.4778776 0.4678037 0.4828857 0.4722309</span></a>
<a class="sourceLine" id="cb16-107" title="107"><span class="co">#&gt;  [3,] 0.4771578 0.4770949 0.4682025 0.4556066 0.4685047 0.4530913</span></a>
<a class="sourceLine" id="cb16-108" title="108"><span class="co">#&gt;  [4,] 0.4894813 0.4897802 0.4967626 0.4886135 0.4984130 0.4972202</span></a>
<a class="sourceLine" id="cb16-109" title="109"><span class="co">#&gt;  [5,] 0.4756020 0.4788390 0.4853587 0.4834922 0.4939708 0.4672407</span></a>
<a class="sourceLine" id="cb16-110" title="110"><span class="co">#&gt;  [6,] 0.4798124 0.4987037 0.4876864 0.4948217 0.4952123 0.5002855</span></a>
<a class="sourceLine" id="cb16-111" title="111"><span class="co">#&gt;  [7,] 0.4808382 0.4883376 0.4792324 0.4868757 0.4763295 0.4629523</span></a>
<a class="sourceLine" id="cb16-112" title="112"><span class="co">#&gt;  [8,] 0.4956266 0.4930876 0.4809700 0.4895207 0.4706260 0.4762839</span></a>
<a class="sourceLine" id="cb16-113" title="113"><span class="co">#&gt;  [9,] 0.4823945 0.4797224 0.4768434 0.4721254 0.4743240 0.4805138</span></a>
<a class="sourceLine" id="cb16-114" title="114"><span class="co">#&gt; [10,] 0.4936922 0.5033033 0.4866386 0.5011239 0.4958309 0.4737332</span></a>
<a class="sourceLine" id="cb16-115" title="115"><span class="co">#&gt; [11,] 0.4731281 0.4920632 0.4808335 0.4674742 0.4874545 0.4878792</span></a>
<a class="sourceLine" id="cb16-116" title="116"><span class="co">#&gt; [12,] 0.4801398 0.4698280 0.4696827 0.4619399 0.4704200 0.4655437</span></a>
<a class="sourceLine" id="cb16-117" title="117"><span class="co">#&gt; [13,] 1.0000000 0.4789032 0.4631489 0.4879294 0.4704248 0.4732588</span></a>
<a class="sourceLine" id="cb16-118" title="118"><span class="co">#&gt; [14,] 0.4789032 1.0000000 0.4845417 0.4980672 0.4937152 0.4854271</span></a>
<a class="sourceLine" id="cb16-119" title="119"><span class="co">#&gt; [15,] 0.4631489 0.4845417 1.0000000 0.4731678 0.4746595 0.4681185</span></a>
<a class="sourceLine" id="cb16-120" title="120"><span class="co">#&gt; [16,] 0.4879294 0.4980672 0.4731678 1.0000000 0.4809930 0.4735428</span></a>
<a class="sourceLine" id="cb16-121" title="121"><span class="co">#&gt; [17,] 0.4704248 0.4937152 0.4746595 0.4809930 1.0000000 0.4720495</span></a>
<a class="sourceLine" id="cb16-122" title="122"><span class="co">#&gt; [18,] 0.4732588 0.4854271 0.4681185 0.4735428 0.4720495 1.0000000</span></a>
<a class="sourceLine" id="cb16-123" title="123"><span class="co">#&gt; [19,] 0.4668812 0.4946057 0.4861018 0.4787652 0.4937523 0.4770071</span></a>
<a class="sourceLine" id="cb16-124" title="124"><span class="co">#&gt; [20,] 0.4971925 0.4825626 0.4604413 0.4844063 0.4817453 0.4948884</span></a>
<a class="sourceLine" id="cb16-125" title="125"><span class="co">#&gt; [21,] 0.4732092 0.4861145 0.4711094 0.4870924 0.4896825 0.4786695</span></a>
<a class="sourceLine" id="cb16-126" title="126"><span class="co">#&gt; [22,] 0.4698735 0.4756805 0.4792106 0.4687424 0.4829915 0.4810291</span></a>
<a class="sourceLine" id="cb16-127" title="127"><span class="co">#&gt; [23,] 0.4841780 0.4852777 0.4738920 0.4703117 0.4682705 0.4761131</span></a>
<a class="sourceLine" id="cb16-128" title="128"><span class="co">#&gt; [24,] 0.4843245 0.5024379 0.4811257 0.4845624 0.4775550 0.4768543</span></a>
<a class="sourceLine" id="cb16-129" title="129"><span class="co">#&gt; [25,] 0.4763987 0.4975271 0.4833403 0.4676995 0.4783171 0.4714961</span></a>
<a class="sourceLine" id="cb16-130" title="130"><span class="co">#&gt; [26,] 0.4883465 0.4971958 0.4664270 0.4924090 0.4559548 0.4819749</span></a>
<a class="sourceLine" id="cb16-131" title="131"><span class="co">#&gt; [27,] 0.4710936 0.5016559 0.4702802 0.4952534 0.4865219 0.4786264</span></a>
<a class="sourceLine" id="cb16-132" title="132"><span class="co">#&gt; [28,] 0.4757798 0.4803859 0.4618633 0.4886671 0.4821822 0.4776424</span></a>
<a class="sourceLine" id="cb16-133" title="133"><span class="co">#&gt; [29,] 0.4617197 0.4854800 0.4615138 0.4797819 0.4650107 0.4562019</span></a>
<a class="sourceLine" id="cb16-134" title="134"><span class="co">#&gt; [30,] 0.4818490 0.4941252 0.4794231 0.4851408 0.4900289 0.4673316</span></a>
<a class="sourceLine" id="cb16-135" title="135"><span class="co">#&gt; [31,] 0.4588550 0.4832689 0.4516348 0.4905987 0.4514776 0.4618579</span></a>
<a class="sourceLine" id="cb16-136" title="136"><span class="co">#&gt; [32,] 0.4773905 0.4778628 0.4875326 0.4885809 0.4862686 0.4833852</span></a>
<a class="sourceLine" id="cb16-137" title="137"><span class="co">#&gt; [33,] 0.4758130 0.4895344 0.4911680 0.4743478 0.5003358 0.4698409</span></a>
<a class="sourceLine" id="cb16-138" title="138"><span class="co">#&gt; [34,] 0.4791247 0.4997541 0.4869399 0.4840939 0.4948702 0.4807103</span></a>
<a class="sourceLine" id="cb16-139" title="139"><span class="co">#&gt; [35,] 0.4973178 0.4864749 0.4723170 0.4806243 0.4990420 0.4759839</span></a>
<a class="sourceLine" id="cb16-140" title="140"><span class="co">#&gt; [36,] 0.4747224 0.4880573 0.4602246 0.4890472 0.4755979 0.4753483</span></a>
<a class="sourceLine" id="cb16-141" title="141"><span class="co">#&gt; [37,] 0.4693889 0.4836012 0.4577902 0.4748452 0.4850622 0.4741645</span></a>
<a class="sourceLine" id="cb16-142" title="142"><span class="co">#&gt; [38,] 0.4806686 0.5029385 0.4685874 0.4912245 0.4858502 0.4780472</span></a>
<a class="sourceLine" id="cb16-143" title="143"><span class="co">#&gt; [39,] 0.4692677 0.4959553 0.4742003 0.4723223 0.4836616 0.4911557</span></a>
<a class="sourceLine" id="cb16-144" title="144"><span class="co">#&gt; [40,] 0.4701200 0.4875910 0.4596650 0.4736314 0.4810183 0.5101570</span></a>
<a class="sourceLine" id="cb16-145" title="145"><span class="co">#&gt; [41,] 0.4793641 0.4791292 0.4799495 0.4678382 0.4750211 0.4529480</span></a>
<a class="sourceLine" id="cb16-146" title="146"><span class="co">#&gt; [42,] 0.4848750 0.5023458 0.4740858 0.4889578 0.4908916 0.4855618</span></a>
<a class="sourceLine" id="cb16-147" title="147"><span class="co">#&gt; [43,] 0.4641609 0.4840716 0.4646359 0.4661313 0.4623347 0.4568615</span></a>
<a class="sourceLine" id="cb16-148" title="148"><span class="co">#&gt; [44,] 0.4798761 0.4907868 0.4823694 0.4871395 0.4749000 0.4611081</span></a>
<a class="sourceLine" id="cb16-149" title="149"><span class="co">#&gt; [45,] 0.4715834 0.4709005 0.4673893 0.4874867 0.4819896 0.4771831</span></a>
<a class="sourceLine" id="cb16-150" title="150"><span class="co">#&gt; [46,] 0.4745566 0.4818530 0.4810260 0.4850721 0.4746443 0.4809699</span></a>
<a class="sourceLine" id="cb16-151" title="151"><span class="co">#&gt; [47,] 0.4748409 0.4693787 0.4617537 0.4773809 0.4615618 0.4701352</span></a>
<a class="sourceLine" id="cb16-152" title="152"><span class="co">#&gt; [48,] 0.4710138 0.4738168 0.4780895 0.4792191 0.4875543 0.4801255</span></a>
<a class="sourceLine" id="cb16-153" title="153"><span class="co">#&gt; [49,] 0.4668038 0.4910078 0.4686349 0.4800444 0.4859594 0.4822453</span></a>
<a class="sourceLine" id="cb16-154" title="154"><span class="co">#&gt; [50,] 0.4795008 0.4920537 0.4783105 0.4997076 0.5038590 0.4980590</span></a>
<a class="sourceLine" id="cb16-155" title="155"><span class="co">#&gt;           [,19]     [,20]     [,21]     [,22]     [,23]     [,24]</span></a>
<a class="sourceLine" id="cb16-156" title="156"><span class="co">#&gt;  [1,] 0.4884947 0.4769456 0.4845333 0.4755725 0.4785721 0.4812916</span></a>
<a class="sourceLine" id="cb16-157" title="157"><span class="co">#&gt;  [2,] 0.4893830 0.4882431 0.4729958 0.4648695 0.4830047 0.4860090</span></a>
<a class="sourceLine" id="cb16-158" title="158"><span class="co">#&gt;  [3,] 0.4690835 0.4622852 0.4723665 0.4603616 0.4718748 0.4700513</span></a>
<a class="sourceLine" id="cb16-159" title="159"><span class="co">#&gt;  [4,] 0.4940133 0.4875306 0.4980684 0.4824270 0.4724900 0.4931349</span></a>
<a class="sourceLine" id="cb16-160" title="160"><span class="co">#&gt;  [5,] 0.4842340 0.4738559 0.4828438 0.4681446 0.4544924 0.4815146</span></a>
<a class="sourceLine" id="cb16-161" title="161"><span class="co">#&gt;  [6,] 0.4976708 0.4877937 0.4968660 0.4974565 0.4826462 0.4950953</span></a>
<a class="sourceLine" id="cb16-162" title="162"><span class="co">#&gt;  [7,] 0.4817665 0.4743795 0.4939446 0.4763436 0.4733935 0.4875954</span></a>
<a class="sourceLine" id="cb16-163" title="163"><span class="co">#&gt;  [8,] 0.4944945 0.4767088 0.4869934 0.4799268 0.4954698 0.4984575</span></a>
<a class="sourceLine" id="cb16-164" title="164"><span class="co">#&gt;  [9,] 0.4875990 0.4836865 0.4759185 0.4822721 0.4783873 0.4723351</span></a>
<a class="sourceLine" id="cb16-165" title="165"><span class="co">#&gt; [10,] 0.4829353 0.4852129 0.4892903 0.4856681 0.4791022 0.4961801</span></a>
<a class="sourceLine" id="cb16-166" title="166"><span class="co">#&gt; [11,] 0.4844524 0.4742222 0.4778314 0.4666168 0.4766153 0.4859154</span></a>
<a class="sourceLine" id="cb16-167" title="167"><span class="co">#&gt; [12,] 0.4773638 0.4836104 0.4556323 0.4766126 0.4582730 0.4687650</span></a>
<a class="sourceLine" id="cb16-168" title="168"><span class="co">#&gt; [13,] 0.4668812 0.4971925 0.4732092 0.4698735 0.4841780 0.4843245</span></a>
<a class="sourceLine" id="cb16-169" title="169"><span class="co">#&gt; [14,] 0.4946057 0.4825626 0.4861145 0.4756805 0.4852777 0.5024379</span></a>
<a class="sourceLine" id="cb16-170" title="170"><span class="co">#&gt; [15,] 0.4861018 0.4604413 0.4711094 0.4792106 0.4738920 0.4811257</span></a>
<a class="sourceLine" id="cb16-171" title="171"><span class="co">#&gt; [16,] 0.4787652 0.4844063 0.4870924 0.4687424 0.4703117 0.4845624</span></a>
<a class="sourceLine" id="cb16-172" title="172"><span class="co">#&gt; [17,] 0.4937523 0.4817453 0.4896825 0.4829915 0.4682705 0.4775550</span></a>
<a class="sourceLine" id="cb16-173" title="173"><span class="co">#&gt; [18,] 0.4770071 0.4948884 0.4786695 0.4810291 0.4761131 0.4768543</span></a>
<a class="sourceLine" id="cb16-174" title="174"><span class="co">#&gt; [19,] 1.0000000 0.4754084 0.5012192 0.4922865 0.4850864 0.5055237</span></a>
<a class="sourceLine" id="cb16-175" title="175"><span class="co">#&gt; [20,] 0.4754084 1.0000000 0.4883997 0.4754209 0.4823155 0.5000072</span></a>
<a class="sourceLine" id="cb16-176" title="176"><span class="co">#&gt; [21,] 0.5012192 0.4883997 1.0000000 0.4746453 0.4747263 0.4857632</span></a>
<a class="sourceLine" id="cb16-177" title="177"><span class="co">#&gt; [22,] 0.4922865 0.4754209 0.4746453 1.0000000 0.4733554 0.4743848</span></a>
<a class="sourceLine" id="cb16-178" title="178"><span class="co">#&gt; [23,] 0.4850864 0.4823155 0.4747263 0.4733554 1.0000000 0.4816693</span></a>
<a class="sourceLine" id="cb16-179" title="179"><span class="co">#&gt; [24,] 0.5055237 0.5000072 0.4857632 0.4743848 0.4816693 1.0000000</span></a>
<a class="sourceLine" id="cb16-180" title="180"><span class="co">#&gt; [25,] 0.4678465 0.4618952 0.4752482 0.4609920 0.4700499 0.4848413</span></a>
<a class="sourceLine" id="cb16-181" title="181"><span class="co">#&gt; [26,] 0.4937717 0.4707192 0.4771535 0.4729034 0.4704727 0.4886300</span></a>
<a class="sourceLine" id="cb16-182" title="182"><span class="co">#&gt; [27,] 0.4875837 0.4813291 0.4849836 0.4901881 0.4780250 0.4872373</span></a>
<a class="sourceLine" id="cb16-183" title="183"><span class="co">#&gt; [28,] 0.4915920 0.4803344 0.4886029 0.4687718 0.4674699 0.4769543</span></a>
<a class="sourceLine" id="cb16-184" title="184"><span class="co">#&gt; [29,] 0.4693262 0.4819931 0.4732389 0.4787710 0.4798845 0.4821392</span></a>
<a class="sourceLine" id="cb16-185" title="185"><span class="co">#&gt; [30,] 0.4900084 0.4673584 0.4846656 0.4762996 0.4733886 0.4846783</span></a>
<a class="sourceLine" id="cb16-186" title="186"><span class="co">#&gt; [31,] 0.4702068 0.4594470 0.4675036 0.4617597 0.4592595 0.4574785</span></a>
<a class="sourceLine" id="cb16-187" title="187"><span class="co">#&gt; [32,] 0.5072811 0.4933209 0.4838239 0.4951008 0.4774900 0.4925186</span></a>
<a class="sourceLine" id="cb16-188" title="188"><span class="co">#&gt; [33,] 0.4940233 0.4997758 0.4748050 0.4849792 0.4847441 0.5066660</span></a>
<a class="sourceLine" id="cb16-189" title="189"><span class="co">#&gt; [34,] 0.4812755 0.4850456 0.4972202 0.4837688 0.4830551 0.4900148</span></a>
<a class="sourceLine" id="cb16-190" title="190"><span class="co">#&gt; [35,] 0.4926150 0.4876836 0.4947651 0.4791834 0.4831424 0.4924625</span></a>
<a class="sourceLine" id="cb16-191" title="191"><span class="co">#&gt; [36,] 0.4892957 0.4816092 0.4724310 0.4592440 0.4592336 0.4761788</span></a>
<a class="sourceLine" id="cb16-192" title="192"><span class="co">#&gt; [37,] 0.4851519 0.4752952 0.4922674 0.4720202 0.4775273 0.4971348</span></a>
<a class="sourceLine" id="cb16-193" title="193"><span class="co">#&gt; [38,] 0.4699658 0.4929048 0.4846303 0.4632892 0.4934966 0.4914950</span></a>
<a class="sourceLine" id="cb16-194" title="194"><span class="co">#&gt; [39,] 0.4909705 0.4788635 0.4943722 0.4716981 0.4677916 0.4767960</span></a>
<a class="sourceLine" id="cb16-195" title="195"><span class="co">#&gt; [40,] 0.4756236 0.4945769 0.4789939 0.4635965 0.4816470 0.4782357</span></a>
<a class="sourceLine" id="cb16-196" title="196"><span class="co">#&gt; [41,] 0.4853911 0.4753834 0.4896893 0.4770920 0.4851498 0.4930042</span></a>
<a class="sourceLine" id="cb16-197" title="197"><span class="co">#&gt; [42,] 0.4958182 0.4939242 0.5008919 0.4702595 0.4792359 0.5029623</span></a>
<a class="sourceLine" id="cb16-198" title="198"><span class="co">#&gt; [43,] 0.4606220 0.4573481 0.4703628 0.4663938 0.4512981 0.4700375</span></a>
<a class="sourceLine" id="cb16-199" title="199"><span class="co">#&gt; [44,] 0.4819451 0.4825397 0.4845454 0.4760472 0.4596196 0.4857422</span></a>
<a class="sourceLine" id="cb16-200" title="200"><span class="co">#&gt; [45,] 0.4997653 0.4751397 0.4875842 0.4772941 0.4666272 0.4778772</span></a>
<a class="sourceLine" id="cb16-201" title="201"><span class="co">#&gt; [46,] 0.4797301 0.4709663 0.4696477 0.4715926 0.4824859 0.4881119</span></a>
<a class="sourceLine" id="cb16-202" title="202"><span class="co">#&gt; [47,] 0.4684864 0.4576279 0.4692205 0.4584452 0.4809925 0.4583363</span></a>
<a class="sourceLine" id="cb16-203" title="203"><span class="co">#&gt; [48,] 0.4934419 0.4960229 0.4860214 0.4770425 0.4724308 0.4865465</span></a>
<a class="sourceLine" id="cb16-204" title="204"><span class="co">#&gt; [49,] 0.5032821 0.4704966 0.4712555 0.4919867 0.4832319 0.4999334</span></a>
<a class="sourceLine" id="cb16-205" title="205"><span class="co">#&gt; [50,] 0.4915269 0.4757791 0.4872415 0.4909845 0.4680224 0.4811636</span></a>
<a class="sourceLine" id="cb16-206" title="206"><span class="co">#&gt;           [,25]     [,26]     [,27]     [,28]     [,29]     [,30]</span></a>
<a class="sourceLine" id="cb16-207" title="207"><span class="co">#&gt;  [1,] 0.4846545 0.4808411 0.4891191 0.4936341 0.4714080 0.4917403</span></a>
<a class="sourceLine" id="cb16-208" title="208"><span class="co">#&gt;  [2,] 0.4665178 0.4737219 0.4908924 0.4869816 0.4729929 0.4850833</span></a>
<a class="sourceLine" id="cb16-209" title="209"><span class="co">#&gt;  [3,] 0.4606474 0.4643057 0.4654202 0.4876323 0.4636616 0.4945158</span></a>
<a class="sourceLine" id="cb16-210" title="210"><span class="co">#&gt;  [4,] 0.4918001 0.5002998 0.4885751 0.4677534 0.4897793 0.5115070</span></a>
<a class="sourceLine" id="cb16-211" title="211"><span class="co">#&gt;  [5,] 0.4893474 0.4803186 0.4779262 0.4657898 0.4703940 0.4901434</span></a>
<a class="sourceLine" id="cb16-212" title="212"><span class="co">#&gt;  [6,] 0.4893959 0.5013771 0.4930224 0.4827985 0.4923885 0.4877026</span></a>
<a class="sourceLine" id="cb16-213" title="213"><span class="co">#&gt;  [7,] 0.4739336 0.4831338 0.4916385 0.4770920 0.4809823 0.4821198</span></a>
<a class="sourceLine" id="cb16-214" title="214"><span class="co">#&gt;  [8,] 0.4701275 0.4815275 0.4841950 0.4781211 0.4843828 0.4804490</span></a>
<a class="sourceLine" id="cb16-215" title="215"><span class="co">#&gt;  [9,] 0.4612150 0.4703430 0.4754536 0.4770095 0.4769052 0.4686953</span></a>
<a class="sourceLine" id="cb16-216" title="216"><span class="co">#&gt; [10,] 0.4739090 0.4880500 0.4815638 0.4780036 0.4858577 0.4789211</span></a>
<a class="sourceLine" id="cb16-217" title="217"><span class="co">#&gt; [11,] 0.4766505 0.4721046 0.4937348 0.4775544 0.4819737 0.4836126</span></a>
<a class="sourceLine" id="cb16-218" title="218"><span class="co">#&gt; [12,] 0.4615609 0.4479072 0.4729812 0.4595986 0.4755582 0.4643350</span></a>
<a class="sourceLine" id="cb16-219" title="219"><span class="co">#&gt; [13,] 0.4763987 0.4883465 0.4710936 0.4757798 0.4617197 0.4818490</span></a>
<a class="sourceLine" id="cb16-220" title="220"><span class="co">#&gt; [14,] 0.4975271 0.4971958 0.5016559 0.4803859 0.4854800 0.4941252</span></a>
<a class="sourceLine" id="cb16-221" title="221"><span class="co">#&gt; [15,] 0.4833403 0.4664270 0.4702802 0.4618633 0.4615138 0.4794231</span></a>
<a class="sourceLine" id="cb16-222" title="222"><span class="co">#&gt; [16,] 0.4676995 0.4924090 0.4952534 0.4886671 0.4797819 0.4851408</span></a>
<a class="sourceLine" id="cb16-223" title="223"><span class="co">#&gt; [17,] 0.4783171 0.4559548 0.4865219 0.4821822 0.4650107 0.4900289</span></a>
<a class="sourceLine" id="cb16-224" title="224"><span class="co">#&gt; [18,] 0.4714961 0.4819749 0.4786264 0.4776424 0.4562019 0.4673316</span></a>
<a class="sourceLine" id="cb16-225" title="225"><span class="co">#&gt; [19,] 0.4678465 0.4937717 0.4875837 0.4915920 0.4693262 0.4900084</span></a>
<a class="sourceLine" id="cb16-226" title="226"><span class="co">#&gt; [20,] 0.4618952 0.4707192 0.4813291 0.4803344 0.4819931 0.4673584</span></a>
<a class="sourceLine" id="cb16-227" title="227"><span class="co">#&gt; [21,] 0.4752482 0.4771535 0.4849836 0.4886029 0.4732389 0.4846656</span></a>
<a class="sourceLine" id="cb16-228" title="228"><span class="co">#&gt; [22,] 0.4609920 0.4729034 0.4901881 0.4687718 0.4787710 0.4762996</span></a>
<a class="sourceLine" id="cb16-229" title="229"><span class="co">#&gt; [23,] 0.4700499 0.4704727 0.4780250 0.4674699 0.4798845 0.4733886</span></a>
<a class="sourceLine" id="cb16-230" title="230"><span class="co">#&gt; [24,] 0.4848413 0.4886300 0.4872373 0.4769543 0.4821392 0.4846783</span></a>
<a class="sourceLine" id="cb16-231" title="231"><span class="co">#&gt; [25,] 1.0000000 0.4699747 0.4779304 0.4717951 0.4680958 0.4700652</span></a>
<a class="sourceLine" id="cb16-232" title="232"><span class="co">#&gt; [26,] 0.4699747 1.0000000 0.4763509 0.4871698 0.4656716 0.4911607</span></a>
<a class="sourceLine" id="cb16-233" title="233"><span class="co">#&gt; [27,] 0.4779304 0.4763509 1.0000000 0.4836631 0.5020420 0.4722124</span></a>
<a class="sourceLine" id="cb16-234" title="234"><span class="co">#&gt; [28,] 0.4717951 0.4871698 0.4836631 1.0000000 0.4782590 0.4816880</span></a>
<a class="sourceLine" id="cb16-235" title="235"><span class="co">#&gt; [29,] 0.4680958 0.4656716 0.5020420 0.4782590 1.0000000 0.4748626</span></a>
<a class="sourceLine" id="cb16-236" title="236"><span class="co">#&gt; [30,] 0.4700652 0.4911607 0.4722124 0.4816880 0.4748626 1.0000000</span></a>
<a class="sourceLine" id="cb16-237" title="237"><span class="co">#&gt; [31,] 0.4579184 0.4658456 0.4628974 0.4719452 0.4553873 0.4594278</span></a>
<a class="sourceLine" id="cb16-238" title="238"><span class="co">#&gt; [32,] 0.4780924 0.4982092 0.4875129 0.4852813 0.4821608 0.4810879</span></a>
<a class="sourceLine" id="cb16-239" title="239"><span class="co">#&gt; [33,] 0.4915690 0.4748219 0.4762910 0.4844163 0.4659822 0.4866750</span></a>
<a class="sourceLine" id="cb16-240" title="240"><span class="co">#&gt; [34,] 0.4728123 0.4874426 0.4944155 0.4866585 0.4754472 0.4870758</span></a>
<a class="sourceLine" id="cb16-241" title="241"><span class="co">#&gt; [35,] 0.4890750 0.4838186 0.4842999 0.4951773 0.4843536 0.4927255</span></a>
<a class="sourceLine" id="cb16-242" title="242"><span class="co">#&gt; [36,] 0.4730801 0.4711464 0.5001751 0.4911746 0.4662002 0.4568438</span></a>
<a class="sourceLine" id="cb16-243" title="243"><span class="co">#&gt; [37,] 0.4740084 0.4937212 0.4869741 0.4755865 0.4753591 0.4831007</span></a>
<a class="sourceLine" id="cb16-244" title="244"><span class="co">#&gt; [38,] 0.4831256 0.4771822 0.4903145 0.4868266 0.4776044 0.4835967</span></a>
<a class="sourceLine" id="cb16-245" title="245"><span class="co">#&gt; [39,] 0.4750279 0.4771480 0.4874694 0.4940146 0.4514690 0.4675460</span></a>
<a class="sourceLine" id="cb16-246" title="246"><span class="co">#&gt; [40,] 0.4712893 0.4721605 0.4792008 0.4756311 0.4695367 0.4847623</span></a>
<a class="sourceLine" id="cb16-247" title="247"><span class="co">#&gt; [41,] 0.4664300 0.4677565 0.4910271 0.4764958 0.4631839 0.4854904</span></a>
<a class="sourceLine" id="cb16-248" title="248"><span class="co">#&gt; [42,] 0.4834758 0.4726972 0.5037978 0.4856906 0.4844951 0.4871197</span></a>
<a class="sourceLine" id="cb16-249" title="249"><span class="co">#&gt; [43,] 0.4575678 0.4627637 0.4674105 0.4783447 0.4635329 0.4724908</span></a>
<a class="sourceLine" id="cb16-250" title="250"><span class="co">#&gt; [44,] 0.4862799 0.4641265 0.4557391 0.4731525 0.4709091 0.4834571</span></a>
<a class="sourceLine" id="cb16-251" title="251"><span class="co">#&gt; [45,] 0.4728090 0.4824759 0.4935210 0.4725480 0.4846178 0.4698675</span></a>
<a class="sourceLine" id="cb16-252" title="252"><span class="co">#&gt; [46,] 0.4738857 0.4748842 0.4971801 0.4828262 0.4627529 0.4804461</span></a>
<a class="sourceLine" id="cb16-253" title="253"><span class="co">#&gt; [47,] 0.4599856 0.4708402 0.4705258 0.4665324 0.4565097 0.4670755</span></a>
<a class="sourceLine" id="cb16-254" title="254"><span class="co">#&gt; [48,] 0.4645498 0.4714618 0.4831064 0.4919194 0.4795932 0.4638801</span></a>
<a class="sourceLine" id="cb16-255" title="255"><span class="co">#&gt; [49,] 0.4743316 0.4734405 0.4951686 0.4845578 0.4780198 0.4794250</span></a>
<a class="sourceLine" id="cb16-256" title="256"><span class="co">#&gt; [50,] 0.4707225 0.4979159 0.4760636 0.4821654 0.4869966 0.4825466</span></a>
<a class="sourceLine" id="cb16-257" title="257"><span class="co">#&gt;           [,31]     [,32]     [,33]     [,34]     [,35]     [,36]</span></a>
<a class="sourceLine" id="cb16-258" title="258"><span class="co">#&gt;  [1,] 0.4783833 0.4873584 0.4640036 0.4792123 0.4901280 0.4725565</span></a>
<a class="sourceLine" id="cb16-259" title="259"><span class="co">#&gt;  [2,] 0.4748192 0.4826642 0.4813325 0.4777674 0.4862023 0.4894948</span></a>
<a class="sourceLine" id="cb16-260" title="260"><span class="co">#&gt;  [3,] 0.4309901 0.4780154 0.4652324 0.4716173 0.4759520 0.4625650</span></a>
<a class="sourceLine" id="cb16-261" title="261"><span class="co">#&gt;  [4,] 0.4816259 0.4854468 0.4990741 0.4870715 0.4949398 0.4954372</span></a>
<a class="sourceLine" id="cb16-262" title="262"><span class="co">#&gt;  [5,] 0.4576951 0.4827977 0.4855674 0.4947423 0.4953567 0.4948100</span></a>
<a class="sourceLine" id="cb16-263" title="263"><span class="co">#&gt;  [6,] 0.4656926 0.4901430 0.5095961 0.4848990 0.4964275 0.4765726</span></a>
<a class="sourceLine" id="cb16-264" title="264"><span class="co">#&gt;  [7,] 0.4771737 0.4910006 0.4915774 0.5020113 0.4955914 0.4781649</span></a>
<a class="sourceLine" id="cb16-265" title="265"><span class="co">#&gt;  [8,] 0.4757865 0.4774881 0.4885218 0.4831743 0.5002030 0.4888230</span></a>
<a class="sourceLine" id="cb16-266" title="266"><span class="co">#&gt;  [9,] 0.4646181 0.4892755 0.4760087 0.4828129 0.5050260 0.4759993</span></a>
<a class="sourceLine" id="cb16-267" title="267"><span class="co">#&gt; [10,] 0.4743184 0.4896759 0.5045791 0.4958861 0.4980666 0.4730603</span></a>
<a class="sourceLine" id="cb16-268" title="268"><span class="co">#&gt; [11,] 0.4703910 0.4762494 0.4916346 0.4857938 0.4861022 0.4865827</span></a>
<a class="sourceLine" id="cb16-269" title="269"><span class="co">#&gt; [12,] 0.4486803 0.4824998 0.4755129 0.4755785 0.4558443 0.4657525</span></a>
<a class="sourceLine" id="cb16-270" title="270"><span class="co">#&gt; [13,] 0.4588550 0.4773905 0.4758130 0.4791247 0.4973178 0.4747224</span></a>
<a class="sourceLine" id="cb16-271" title="271"><span class="co">#&gt; [14,] 0.4832689 0.4778628 0.4895344 0.4997541 0.4864749 0.4880573</span></a>
<a class="sourceLine" id="cb16-272" title="272"><span class="co">#&gt; [15,] 0.4516348 0.4875326 0.4911680 0.4869399 0.4723170 0.4602246</span></a>
<a class="sourceLine" id="cb16-273" title="273"><span class="co">#&gt; [16,] 0.4905987 0.4885809 0.4743478 0.4840939 0.4806243 0.4890472</span></a>
<a class="sourceLine" id="cb16-274" title="274"><span class="co">#&gt; [17,] 0.4514776 0.4862686 0.5003358 0.4948702 0.4990420 0.4755979</span></a>
<a class="sourceLine" id="cb16-275" title="275"><span class="co">#&gt; [18,] 0.4618579 0.4833852 0.4698409 0.4807103 0.4759839 0.4753483</span></a>
<a class="sourceLine" id="cb16-276" title="276"><span class="co">#&gt; [19,] 0.4702068 0.5072811 0.4940233 0.4812755 0.4926150 0.4892957</span></a>
<a class="sourceLine" id="cb16-277" title="277"><span class="co">#&gt; [20,] 0.4594470 0.4933209 0.4997758 0.4850456 0.4876836 0.4816092</span></a>
<a class="sourceLine" id="cb16-278" title="278"><span class="co">#&gt; [21,] 0.4675036 0.4838239 0.4748050 0.4972202 0.4947651 0.4724310</span></a>
<a class="sourceLine" id="cb16-279" title="279"><span class="co">#&gt; [22,] 0.4617597 0.4951008 0.4849792 0.4837688 0.4791834 0.4592440</span></a>
<a class="sourceLine" id="cb16-280" title="280"><span class="co">#&gt; [23,] 0.4592595 0.4774900 0.4847441 0.4830551 0.4831424 0.4592336</span></a>
<a class="sourceLine" id="cb16-281" title="281"><span class="co">#&gt; [24,] 0.4574785 0.4925186 0.5066660 0.4900148 0.4924625 0.4761788</span></a>
<a class="sourceLine" id="cb16-282" title="282"><span class="co">#&gt; [25,] 0.4579184 0.4780924 0.4915690 0.4728123 0.4890750 0.4730801</span></a>
<a class="sourceLine" id="cb16-283" title="283"><span class="co">#&gt; [26,] 0.4658456 0.4982092 0.4748219 0.4874426 0.4838186 0.4711464</span></a>
<a class="sourceLine" id="cb16-284" title="284"><span class="co">#&gt; [27,] 0.4628974 0.4875129 0.4762910 0.4944155 0.4842999 0.5001751</span></a>
<a class="sourceLine" id="cb16-285" title="285"><span class="co">#&gt; [28,] 0.4719452 0.4852813 0.4844163 0.4866585 0.4951773 0.4911746</span></a>
<a class="sourceLine" id="cb16-286" title="286"><span class="co">#&gt; [29,] 0.4553873 0.4821608 0.4659822 0.4754472 0.4843536 0.4662002</span></a>
<a class="sourceLine" id="cb16-287" title="287"><span class="co">#&gt; [30,] 0.4594278 0.4810879 0.4866750 0.4870758 0.4927255 0.4568438</span></a>
<a class="sourceLine" id="cb16-288" title="288"><span class="co">#&gt; [31,] 1.0000000 0.4620876 0.4716509 0.4636320 0.4719244 0.4626942</span></a>
<a class="sourceLine" id="cb16-289" title="289"><span class="co">#&gt; [32,] 0.4620876 1.0000000 0.4952083 0.4833661 0.4807045 0.4837289</span></a>
<a class="sourceLine" id="cb16-290" title="290"><span class="co">#&gt; [33,] 0.4716509 0.4952083 1.0000000 0.5073322 0.4993521 0.4815846</span></a>
<a class="sourceLine" id="cb16-291" title="291"><span class="co">#&gt; [34,] 0.4636320 0.4833661 0.5073322 1.0000000 0.4767452 0.4791649</span></a>
<a class="sourceLine" id="cb16-292" title="292"><span class="co">#&gt; [35,] 0.4719244 0.4807045 0.4993521 0.4767452 1.0000000 0.4954873</span></a>
<a class="sourceLine" id="cb16-293" title="293"><span class="co">#&gt; [36,] 0.4626942 0.4837289 0.4815846 0.4791649 0.4954873 1.0000000</span></a>
<a class="sourceLine" id="cb16-294" title="294"><span class="co">#&gt; [37,] 0.4295853 0.4813682 0.4874477 0.4947660 0.4834063 0.4955254</span></a>
<a class="sourceLine" id="cb16-295" title="295"><span class="co">#&gt; [38,] 0.4673628 0.4978741 0.4758514 0.4800969 0.4878552 0.4757290</span></a>
<a class="sourceLine" id="cb16-296" title="296"><span class="co">#&gt; [39,] 0.4672461 0.4846360 0.4990995 0.4711715 0.4863886 0.4821307</span></a>
<a class="sourceLine" id="cb16-297" title="297"><span class="co">#&gt; [40,] 0.4683702 0.4781131 0.4784026 0.4855561 0.4912253 0.4710253</span></a>
<a class="sourceLine" id="cb16-298" title="298"><span class="co">#&gt; [41,] 0.4633036 0.4731635 0.4887457 0.4808570 0.4895117 0.4781087</span></a>
<a class="sourceLine" id="cb16-299" title="299"><span class="co">#&gt; [42,] 0.4706382 0.4943782 0.4951537 0.4742021 0.4886105 0.4820123</span></a>
<a class="sourceLine" id="cb16-300" title="300"><span class="co">#&gt; [43,] 0.4526292 0.4572038 0.4726292 0.4692623 0.4784463 0.4486976</span></a>
<a class="sourceLine" id="cb16-301" title="301"><span class="co">#&gt; [44,] 0.4604001 0.4717885 0.4795662 0.4800765 0.4751296 0.4937968</span></a>
<a class="sourceLine" id="cb16-302" title="302"><span class="co">#&gt; [45,] 0.4482102 0.4791983 0.4843833 0.4741117 0.4959109 0.4776127</span></a>
<a class="sourceLine" id="cb16-303" title="303"><span class="co">#&gt; [46,] 0.4555084 0.4811093 0.4775211 0.4948839 0.4803134 0.4784982</span></a>
<a class="sourceLine" id="cb16-304" title="304"><span class="co">#&gt; [47,] 0.4569849 0.4879905 0.4732806 0.4789830 0.4920558 0.4649036</span></a>
<a class="sourceLine" id="cb16-305" title="305"><span class="co">#&gt; [48,] 0.4668865 0.4870814 0.4790007 0.4875484 0.4844537 0.4917520</span></a>
<a class="sourceLine" id="cb16-306" title="306"><span class="co">#&gt; [49,] 0.4746189 0.4982155 0.4892072 0.4882770 0.4935922 0.4824333</span></a>
<a class="sourceLine" id="cb16-307" title="307"><span class="co">#&gt; [50,] 0.4801893 0.4886662 0.4882084 0.5020961 0.4882049 0.4799757</span></a>
<a class="sourceLine" id="cb16-308" title="308"><span class="co">#&gt;           [,37]     [,38]     [,39]     [,40]     [,41]     [,42]</span></a>
<a class="sourceLine" id="cb16-309" title="309"><span class="co">#&gt;  [1,] 0.4719593 0.4779563 0.4721031 0.4869209 0.4755148 0.4933048</span></a>
<a class="sourceLine" id="cb16-310" title="310"><span class="co">#&gt;  [2,] 0.4855221 0.4774590 0.4674040 0.4722870 0.4802082 0.4961259</span></a>
<a class="sourceLine" id="cb16-311" title="311"><span class="co">#&gt;  [3,] 0.4831415 0.4749940 0.4705461 0.4853659 0.4678359 0.4716815</span></a>
<a class="sourceLine" id="cb16-312" title="312"><span class="co">#&gt;  [4,] 0.4754273 0.4717642 0.4714857 0.4973100 0.4840367 0.4952857</span></a>
<a class="sourceLine" id="cb16-313" title="313"><span class="co">#&gt;  [5,] 0.4637818 0.4883992 0.4787467 0.4887614 0.4915594 0.4705448</span></a>
<a class="sourceLine" id="cb16-314" title="314"><span class="co">#&gt;  [6,] 0.4865522 0.4740700 0.4947978 0.4910427 0.4872499 0.5021658</span></a>
<a class="sourceLine" id="cb16-315" title="315"><span class="co">#&gt;  [7,] 0.4781031 0.4727700 0.4911010 0.4820505 0.4825601 0.5018230</span></a>
<a class="sourceLine" id="cb16-316" title="316"><span class="co">#&gt;  [8,] 0.4791546 0.4974627 0.4762907 0.4817914 0.4836127 0.4744781</span></a>
<a class="sourceLine" id="cb16-317" title="317"><span class="co">#&gt;  [9,] 0.4750702 0.4985710 0.4720078 0.4738119 0.4860934 0.4740408</span></a>
<a class="sourceLine" id="cb16-318" title="318"><span class="co">#&gt; [10,] 0.4784534 0.4844597 0.4712645 0.4930812 0.4878069 0.4880989</span></a>
<a class="sourceLine" id="cb16-319" title="319"><span class="co">#&gt; [11,] 0.4849143 0.4828155 0.4578978 0.4830126 0.4759695 0.5045427</span></a>
<a class="sourceLine" id="cb16-320" title="320"><span class="co">#&gt; [12,] 0.4556314 0.4644094 0.4657783 0.4656365 0.4480472 0.4836311</span></a>
<a class="sourceLine" id="cb16-321" title="321"><span class="co">#&gt; [13,] 0.4693889 0.4806686 0.4692677 0.4701200 0.4793641 0.4848750</span></a>
<a class="sourceLine" id="cb16-322" title="322"><span class="co">#&gt; [14,] 0.4836012 0.5029385 0.4959553 0.4875910 0.4791292 0.5023458</span></a>
<a class="sourceLine" id="cb16-323" title="323"><span class="co">#&gt; [15,] 0.4577902 0.4685874 0.4742003 0.4596650 0.4799495 0.4740858</span></a>
<a class="sourceLine" id="cb16-324" title="324"><span class="co">#&gt; [16,] 0.4748452 0.4912245 0.4723223 0.4736314 0.4678382 0.4889578</span></a>
<a class="sourceLine" id="cb16-325" title="325"><span class="co">#&gt; [17,] 0.4850622 0.4858502 0.4836616 0.4810183 0.4750211 0.4908916</span></a>
<a class="sourceLine" id="cb16-326" title="326"><span class="co">#&gt; [18,] 0.4741645 0.4780472 0.4911557 0.5101570 0.4529480 0.4855618</span></a>
<a class="sourceLine" id="cb16-327" title="327"><span class="co">#&gt; [19,] 0.4851519 0.4699658 0.4909705 0.4756236 0.4853911 0.4958182</span></a>
<a class="sourceLine" id="cb16-328" title="328"><span class="co">#&gt; [20,] 0.4752952 0.4929048 0.4788635 0.4945769 0.4753834 0.4939242</span></a>
<a class="sourceLine" id="cb16-329" title="329"><span class="co">#&gt; [21,] 0.4922674 0.4846303 0.4943722 0.4789939 0.4896893 0.5008919</span></a>
<a class="sourceLine" id="cb16-330" title="330"><span class="co">#&gt; [22,] 0.4720202 0.4632892 0.4716981 0.4635965 0.4770920 0.4702595</span></a>
<a class="sourceLine" id="cb16-331" title="331"><span class="co">#&gt; [23,] 0.4775273 0.4934966 0.4677916 0.4816470 0.4851498 0.4792359</span></a>
<a class="sourceLine" id="cb16-332" title="332"><span class="co">#&gt; [24,] 0.4971348 0.4914950 0.4767960 0.4782357 0.4930042 0.5029623</span></a>
<a class="sourceLine" id="cb16-333" title="333"><span class="co">#&gt; [25,] 0.4740084 0.4831256 0.4750279 0.4712893 0.4664300 0.4834758</span></a>
<a class="sourceLine" id="cb16-334" title="334"><span class="co">#&gt; [26,] 0.4937212 0.4771822 0.4771480 0.4721605 0.4677565 0.4726972</span></a>
<a class="sourceLine" id="cb16-335" title="335"><span class="co">#&gt; [27,] 0.4869741 0.4903145 0.4874694 0.4792008 0.4910271 0.5037978</span></a>
<a class="sourceLine" id="cb16-336" title="336"><span class="co">#&gt; [28,] 0.4755865 0.4868266 0.4940146 0.4756311 0.4764958 0.4856906</span></a>
<a class="sourceLine" id="cb16-337" title="337"><span class="co">#&gt; [29,] 0.4753591 0.4776044 0.4514690 0.4695367 0.4631839 0.4844951</span></a>
<a class="sourceLine" id="cb16-338" title="338"><span class="co">#&gt; [30,] 0.4831007 0.4835967 0.4675460 0.4847623 0.4854904 0.4871197</span></a>
<a class="sourceLine" id="cb16-339" title="339"><span class="co">#&gt; [31,] 0.4295853 0.4673628 0.4672461 0.4683702 0.4633036 0.4706382</span></a>
<a class="sourceLine" id="cb16-340" title="340"><span class="co">#&gt; [32,] 0.4813682 0.4978741 0.4846360 0.4781131 0.4731635 0.4943782</span></a>
<a class="sourceLine" id="cb16-341" title="341"><span class="co">#&gt; [33,] 0.4874477 0.4758514 0.4990995 0.4784026 0.4887457 0.4951537</span></a>
<a class="sourceLine" id="cb16-342" title="342"><span class="co">#&gt; [34,] 0.4947660 0.4800969 0.4711715 0.4855561 0.4808570 0.4742021</span></a>
<a class="sourceLine" id="cb16-343" title="343"><span class="co">#&gt; [35,] 0.4834063 0.4878552 0.4863886 0.4912253 0.4895117 0.4886105</span></a>
<a class="sourceLine" id="cb16-344" title="344"><span class="co">#&gt; [36,] 0.4955254 0.4757290 0.4821307 0.4710253 0.4781087 0.4820123</span></a>
<a class="sourceLine" id="cb16-345" title="345"><span class="co">#&gt; [37,] 1.0000000 0.4867271 0.4853056 0.4729380 0.4768231 0.4818793</span></a>
<a class="sourceLine" id="cb16-346" title="346"><span class="co">#&gt; [38,] 0.4867271 1.0000000 0.4818559 0.4918865 0.4766136 0.4848464</span></a>
<a class="sourceLine" id="cb16-347" title="347"><span class="co">#&gt; [39,] 0.4853056 0.4818559 1.0000000 0.4797205 0.4656553 0.4964507</span></a>
<a class="sourceLine" id="cb16-348" title="348"><span class="co">#&gt; [40,] 0.4729380 0.4918865 0.4797205 1.0000000 0.4713233 0.4922323</span></a>
<a class="sourceLine" id="cb16-349" title="349"><span class="co">#&gt; [41,] 0.4768231 0.4766136 0.4656553 0.4713233 1.0000000 0.4751068</span></a>
<a class="sourceLine" id="cb16-350" title="350"><span class="co">#&gt; [42,] 0.4818793 0.4848464 0.4964507 0.4922323 0.4751068 1.0000000</span></a>
<a class="sourceLine" id="cb16-351" title="351"><span class="co">#&gt; [43,] 0.4717562 0.4701286 0.4661760 0.4783587 0.4620011 0.4740276</span></a>
<a class="sourceLine" id="cb16-352" title="352"><span class="co">#&gt; [44,] 0.4758286 0.4926909 0.4680499 0.4844188 0.4791978 0.4786672</span></a>
<a class="sourceLine" id="cb16-353" title="353"><span class="co">#&gt; [45,] 0.4683976 0.4665339 0.4737276 0.4734568 0.4637515 0.4845085</span></a>
<a class="sourceLine" id="cb16-354" title="354"><span class="co">#&gt; [46,] 0.4697897 0.4767203 0.4780609 0.4752724 0.4668417 0.5004129</span></a>
<a class="sourceLine" id="cb16-355" title="355"><span class="co">#&gt; [47,] 0.4746262 0.4798003 0.4612008 0.4762140 0.4601708 0.4809440</span></a>
<a class="sourceLine" id="cb16-356" title="356"><span class="co">#&gt; [48,] 0.4739155 0.4777139 0.4666671 0.4842808 0.4755113 0.4890844</span></a>
<a class="sourceLine" id="cb16-357" title="357"><span class="co">#&gt; [49,] 0.4823780 0.5007272 0.4700646 0.4724572 0.4785281 0.5093417</span></a>
<a class="sourceLine" id="cb16-358" title="358"><span class="co">#&gt; [50,] 0.4784760 0.5009613 0.4904122 0.4730043 0.4767526 0.4927077</span></a>
<a class="sourceLine" id="cb16-359" title="359"><span class="co">#&gt;           [,43]     [,44]     [,45]     [,46]     [,47]     [,48]</span></a>
<a class="sourceLine" id="cb16-360" title="360"><span class="co">#&gt;  [1,] 0.4692270 0.4764247 0.4899229 0.4889441 0.4698197 0.4764185</span></a>
<a class="sourceLine" id="cb16-361" title="361"><span class="co">#&gt;  [2,] 0.4563265 0.4608961 0.4851334 0.4802540 0.4668164 0.4806782</span></a>
<a class="sourceLine" id="cb16-362" title="362"><span class="co">#&gt;  [3,] 0.4744040 0.4579432 0.4746741 0.4709218 0.4669458 0.4692607</span></a>
<a class="sourceLine" id="cb16-363" title="363"><span class="co">#&gt;  [4,] 0.4750798 0.4963250 0.4920976 0.4870914 0.4767222 0.4887845</span></a>
<a class="sourceLine" id="cb16-364" title="364"><span class="co">#&gt;  [5,] 0.4793421 0.4669837 0.4682805 0.4806206 0.4708015 0.4810478</span></a>
<a class="sourceLine" id="cb16-365" title="365"><span class="co">#&gt;  [6,] 0.4945674 0.4832757 0.4816624 0.4772949 0.4843022 0.4804733</span></a>
<a class="sourceLine" id="cb16-366" title="366"><span class="co">#&gt;  [7,] 0.4735202 0.4651638 0.4711068 0.4655142 0.4806587 0.4782227</span></a>
<a class="sourceLine" id="cb16-367" title="367"><span class="co">#&gt;  [8,] 0.4580146 0.4733707 0.4831673 0.4876824 0.4705897 0.4798805</span></a>
<a class="sourceLine" id="cb16-368" title="368"><span class="co">#&gt;  [9,] 0.4619681 0.4682082 0.4937510 0.4871867 0.4614901 0.4735808</span></a>
<a class="sourceLine" id="cb16-369" title="369"><span class="co">#&gt; [10,] 0.4641387 0.4830317 0.4804080 0.4599700 0.4632926 0.4855319</span></a>
<a class="sourceLine" id="cb16-370" title="370"><span class="co">#&gt; [11,] 0.4643393 0.4781812 0.4842292 0.4759348 0.4781888 0.4567081</span></a>
<a class="sourceLine" id="cb16-371" title="371"><span class="co">#&gt; [12,] 0.4672788 0.4636922 0.4483362 0.4721072 0.4584353 0.4723551</span></a>
<a class="sourceLine" id="cb16-372" title="372"><span class="co">#&gt; [13,] 0.4641609 0.4798761 0.4715834 0.4745566 0.4748409 0.4710138</span></a>
<a class="sourceLine" id="cb16-373" title="373"><span class="co">#&gt; [14,] 0.4840716 0.4907868 0.4709005 0.4818530 0.4693787 0.4738168</span></a>
<a class="sourceLine" id="cb16-374" title="374"><span class="co">#&gt; [15,] 0.4646359 0.4823694 0.4673893 0.4810260 0.4617537 0.4780895</span></a>
<a class="sourceLine" id="cb16-375" title="375"><span class="co">#&gt; [16,] 0.4661313 0.4871395 0.4874867 0.4850721 0.4773809 0.4792191</span></a>
<a class="sourceLine" id="cb16-376" title="376"><span class="co">#&gt; [17,] 0.4623347 0.4749000 0.4819896 0.4746443 0.4615618 0.4875543</span></a>
<a class="sourceLine" id="cb16-377" title="377"><span class="co">#&gt; [18,] 0.4568615 0.4611081 0.4771831 0.4809699 0.4701352 0.4801255</span></a>
<a class="sourceLine" id="cb16-378" title="378"><span class="co">#&gt; [19,] 0.4606220 0.4819451 0.4997653 0.4797301 0.4684864 0.4934419</span></a>
<a class="sourceLine" id="cb16-379" title="379"><span class="co">#&gt; [20,] 0.4573481 0.4825397 0.4751397 0.4709663 0.4576279 0.4960229</span></a>
<a class="sourceLine" id="cb16-380" title="380"><span class="co">#&gt; [21,] 0.4703628 0.4845454 0.4875842 0.4696477 0.4692205 0.4860214</span></a>
<a class="sourceLine" id="cb16-381" title="381"><span class="co">#&gt; [22,] 0.4663938 0.4760472 0.4772941 0.4715926 0.4584452 0.4770425</span></a>
<a class="sourceLine" id="cb16-382" title="382"><span class="co">#&gt; [23,] 0.4512981 0.4596196 0.4666272 0.4824859 0.4809925 0.4724308</span></a>
<a class="sourceLine" id="cb16-383" title="383"><span class="co">#&gt; [24,] 0.4700375 0.4857422 0.4778772 0.4881119 0.4583363 0.4865465</span></a>
<a class="sourceLine" id="cb16-384" title="384"><span class="co">#&gt; [25,] 0.4575678 0.4862799 0.4728090 0.4738857 0.4599856 0.4645498</span></a>
<a class="sourceLine" id="cb16-385" title="385"><span class="co">#&gt; [26,] 0.4627637 0.4641265 0.4824759 0.4748842 0.4708402 0.4714618</span></a>
<a class="sourceLine" id="cb16-386" title="386"><span class="co">#&gt; [27,] 0.4674105 0.4557391 0.4935210 0.4971801 0.4705258 0.4831064</span></a>
<a class="sourceLine" id="cb16-387" title="387"><span class="co">#&gt; [28,] 0.4783447 0.4731525 0.4725480 0.4828262 0.4665324 0.4919194</span></a>
<a class="sourceLine" id="cb16-388" title="388"><span class="co">#&gt; [29,] 0.4635329 0.4709091 0.4846178 0.4627529 0.4565097 0.4795932</span></a>
<a class="sourceLine" id="cb16-389" title="389"><span class="co">#&gt; [30,] 0.4724908 0.4834571 0.4698675 0.4804461 0.4670755 0.4638801</span></a>
<a class="sourceLine" id="cb16-390" title="390"><span class="co">#&gt; [31,] 0.4526292 0.4604001 0.4482102 0.4555084 0.4569849 0.4668865</span></a>
<a class="sourceLine" id="cb16-391" title="391"><span class="co">#&gt; [32,] 0.4572038 0.4717885 0.4791983 0.4811093 0.4879905 0.4870814</span></a>
<a class="sourceLine" id="cb16-392" title="392"><span class="co">#&gt; [33,] 0.4726292 0.4795662 0.4843833 0.4775211 0.4732806 0.4790007</span></a>
<a class="sourceLine" id="cb16-393" title="393"><span class="co">#&gt; [34,] 0.4692623 0.4800765 0.4741117 0.4948839 0.4789830 0.4875484</span></a>
<a class="sourceLine" id="cb16-394" title="394"><span class="co">#&gt; [35,] 0.4784463 0.4751296 0.4959109 0.4803134 0.4920558 0.4844537</span></a>
<a class="sourceLine" id="cb16-395" title="395"><span class="co">#&gt; [36,] 0.4486976 0.4937968 0.4776127 0.4784982 0.4649036 0.4917520</span></a>
<a class="sourceLine" id="cb16-396" title="396"><span class="co">#&gt; [37,] 0.4717562 0.4758286 0.4683976 0.4697897 0.4746262 0.4739155</span></a>
<a class="sourceLine" id="cb16-397" title="397"><span class="co">#&gt; [38,] 0.4701286 0.4926909 0.4665339 0.4767203 0.4798003 0.4777139</span></a>
<a class="sourceLine" id="cb16-398" title="398"><span class="co">#&gt; [39,] 0.4661760 0.4680499 0.4737276 0.4780609 0.4612008 0.4666671</span></a>
<a class="sourceLine" id="cb16-399" title="399"><span class="co">#&gt; [40,] 0.4783587 0.4844188 0.4734568 0.4752724 0.4762140 0.4842808</span></a>
<a class="sourceLine" id="cb16-400" title="400"><span class="co">#&gt; [41,] 0.4620011 0.4791978 0.4637515 0.4668417 0.4601708 0.4755113</span></a>
<a class="sourceLine" id="cb16-401" title="401"><span class="co">#&gt; [42,] 0.4740276 0.4786672 0.4845085 0.5004129 0.4809440 0.4890844</span></a>
<a class="sourceLine" id="cb16-402" title="402"><span class="co">#&gt; [43,] 1.0000000 0.4664148 0.4566511 0.4649348 0.4538675 0.4565943</span></a>
<a class="sourceLine" id="cb16-403" title="403"><span class="co">#&gt; [44,] 0.4664148 1.0000000 0.4806406 0.4821230 0.4633071 0.4726662</span></a>
<a class="sourceLine" id="cb16-404" title="404"><span class="co">#&gt; [45,] 0.4566511 0.4806406 1.0000000 0.4715756 0.4708753 0.4785339</span></a>
<a class="sourceLine" id="cb16-405" title="405"><span class="co">#&gt; [46,] 0.4649348 0.4821230 0.4715756 1.0000000 0.4585907 0.4972861</span></a>
<a class="sourceLine" id="cb16-406" title="406"><span class="co">#&gt; [47,] 0.4538675 0.4633071 0.4708753 0.4585907 1.0000000 0.4743991</span></a>
<a class="sourceLine" id="cb16-407" title="407"><span class="co">#&gt; [48,] 0.4565943 0.4726662 0.4785339 0.4972861 0.4743991 1.0000000</span></a>
<a class="sourceLine" id="cb16-408" title="408"><span class="co">#&gt; [49,] 0.4727540 0.4906404 0.4803063 0.4910970 0.4863589 0.4804347</span></a>
<a class="sourceLine" id="cb16-409" title="409"><span class="co">#&gt; [50,] 0.4630208 0.4897802 0.4881130 0.4830903 0.4792652 0.4807874</span></a>
<a class="sourceLine" id="cb16-410" title="410"><span class="co">#&gt;           [,49]     [,50]</span></a>
<a class="sourceLine" id="cb16-411" title="411"><span class="co">#&gt;  [1,] 0.4784021 0.4849035</span></a>
<a class="sourceLine" id="cb16-412" title="412"><span class="co">#&gt;  [2,] 0.4907013 0.4764679</span></a>
<a class="sourceLine" id="cb16-413" title="413"><span class="co">#&gt;  [3,] 0.4636844 0.4687569</span></a>
<a class="sourceLine" id="cb16-414" title="414"><span class="co">#&gt;  [4,] 0.4862231 0.4909447</span></a>
<a class="sourceLine" id="cb16-415" title="415"><span class="co">#&gt;  [5,] 0.4718067 0.4699619</span></a>
<a class="sourceLine" id="cb16-416" title="416"><span class="co">#&gt;  [6,] 0.4974101 0.4921324</span></a>
<a class="sourceLine" id="cb16-417" title="417"><span class="co">#&gt;  [7,] 0.4801952 0.4860767</span></a>
<a class="sourceLine" id="cb16-418" title="418"><span class="co">#&gt;  [8,] 0.4833423 0.4836131</span></a>
<a class="sourceLine" id="cb16-419" title="419"><span class="co">#&gt;  [9,] 0.4692315 0.4878037</span></a>
<a class="sourceLine" id="cb16-420" title="420"><span class="co">#&gt; [10,] 0.4660855 0.4935527</span></a>
<a class="sourceLine" id="cb16-421" title="421"><span class="co">#&gt; [11,] 0.4922189 0.4784185</span></a>
<a class="sourceLine" id="cb16-422" title="422"><span class="co">#&gt; [12,] 0.4715573 0.4713054</span></a>
<a class="sourceLine" id="cb16-423" title="423"><span class="co">#&gt; [13,] 0.4668038 0.4795008</span></a>
<a class="sourceLine" id="cb16-424" title="424"><span class="co">#&gt; [14,] 0.4910078 0.4920537</span></a>
<a class="sourceLine" id="cb16-425" title="425"><span class="co">#&gt; [15,] 0.4686349 0.4783105</span></a>
<a class="sourceLine" id="cb16-426" title="426"><span class="co">#&gt; [16,] 0.4800444 0.4997076</span></a>
<a class="sourceLine" id="cb16-427" title="427"><span class="co">#&gt; [17,] 0.4859594 0.5038590</span></a>
<a class="sourceLine" id="cb16-428" title="428"><span class="co">#&gt; [18,] 0.4822453 0.4980590</span></a>
<a class="sourceLine" id="cb16-429" title="429"><span class="co">#&gt; [19,] 0.5032821 0.4915269</span></a>
<a class="sourceLine" id="cb16-430" title="430"><span class="co">#&gt; [20,] 0.4704966 0.4757791</span></a>
<a class="sourceLine" id="cb16-431" title="431"><span class="co">#&gt; [21,] 0.4712555 0.4872415</span></a>
<a class="sourceLine" id="cb16-432" title="432"><span class="co">#&gt; [22,] 0.4919867 0.4909845</span></a>
<a class="sourceLine" id="cb16-433" title="433"><span class="co">#&gt; [23,] 0.4832319 0.4680224</span></a>
<a class="sourceLine" id="cb16-434" title="434"><span class="co">#&gt; [24,] 0.4999334 0.4811636</span></a>
<a class="sourceLine" id="cb16-435" title="435"><span class="co">#&gt; [25,] 0.4743316 0.4707225</span></a>
<a class="sourceLine" id="cb16-436" title="436"><span class="co">#&gt; [26,] 0.4734405 0.4979159</span></a>
<a class="sourceLine" id="cb16-437" title="437"><span class="co">#&gt; [27,] 0.4951686 0.4760636</span></a>
<a class="sourceLine" id="cb16-438" title="438"><span class="co">#&gt; [28,] 0.4845578 0.4821654</span></a>
<a class="sourceLine" id="cb16-439" title="439"><span class="co">#&gt; [29,] 0.4780198 0.4869966</span></a>
<a class="sourceLine" id="cb16-440" title="440"><span class="co">#&gt; [30,] 0.4794250 0.4825466</span></a>
<a class="sourceLine" id="cb16-441" title="441"><span class="co">#&gt; [31,] 0.4746189 0.4801893</span></a>
<a class="sourceLine" id="cb16-442" title="442"><span class="co">#&gt; [32,] 0.4982155 0.4886662</span></a>
<a class="sourceLine" id="cb16-443" title="443"><span class="co">#&gt; [33,] 0.4892072 0.4882084</span></a>
<a class="sourceLine" id="cb16-444" title="444"><span class="co">#&gt; [34,] 0.4882770 0.5020961</span></a>
<a class="sourceLine" id="cb16-445" title="445"><span class="co">#&gt; [35,] 0.4935922 0.4882049</span></a>
<a class="sourceLine" id="cb16-446" title="446"><span class="co">#&gt; [36,] 0.4824333 0.4799757</span></a>
<a class="sourceLine" id="cb16-447" title="447"><span class="co">#&gt; [37,] 0.4823780 0.4784760</span></a>
<a class="sourceLine" id="cb16-448" title="448"><span class="co">#&gt; [38,] 0.5007272 0.5009613</span></a>
<a class="sourceLine" id="cb16-449" title="449"><span class="co">#&gt; [39,] 0.4700646 0.4904122</span></a>
<a class="sourceLine" id="cb16-450" title="450"><span class="co">#&gt; [40,] 0.4724572 0.4730043</span></a>
<a class="sourceLine" id="cb16-451" title="451"><span class="co">#&gt; [41,] 0.4785281 0.4767526</span></a>
<a class="sourceLine" id="cb16-452" title="452"><span class="co">#&gt; [42,] 0.5093417 0.4927077</span></a>
<a class="sourceLine" id="cb16-453" title="453"><span class="co">#&gt; [43,] 0.4727540 0.4630208</span></a>
<a class="sourceLine" id="cb16-454" title="454"><span class="co">#&gt; [44,] 0.4906404 0.4897802</span></a>
<a class="sourceLine" id="cb16-455" title="455"><span class="co">#&gt; [45,] 0.4803063 0.4881130</span></a>
<a class="sourceLine" id="cb16-456" title="456"><span class="co">#&gt; [46,] 0.4910970 0.4830903</span></a>
<a class="sourceLine" id="cb16-457" title="457"><span class="co">#&gt; [47,] 0.4863589 0.4792652</span></a>
<a class="sourceLine" id="cb16-458" title="458"><span class="co">#&gt; [48,] 0.4804347 0.4807874</span></a>
<a class="sourceLine" id="cb16-459" title="459"><span class="co">#&gt; [49,] 1.0000000 0.4920005</span></a>
<a class="sourceLine" id="cb16-460" title="460"><span class="co">#&gt; [50,] 0.4920005 1.0000000</span></a>
<a class="sourceLine" id="cb16-461" title="461"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(corr_mean))</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-16-1.png" width="576"></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">coef_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb17-2" title="2">coef_lasso_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb17-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb17-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_lasso_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb17-5" title="5">error_counter=<span class="dv">0</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb17-7" title="7">tempdf=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="dt">Y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple2_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y,</a>
<a class="sourceLine" id="cb17-8" title="8">                        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple2_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X))</a>
<a class="sourceLine" id="cb17-9" title="9">tempcoef=<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(Y<span class="op">~</span>.<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>tempdf))</a>
<a class="sourceLine" id="cb17-10" title="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(lars)</a>
<a class="sourceLine" id="cb17-11" title="11">lasso<span class="fl">.1</span> &lt;-<span class="st"> </span>lars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/lars/topics/lars">lars</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple2_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb17-12" title="12">              <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple2_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y, <span class="dt">type=</span><span class="st">"lasso"</span>, </a>
<a class="sourceLine" id="cb17-13" title="13">              <span class="dt">trace=</span><span class="ot">FALSE</span>, <span class="dt">normalize=</span><span class="ot">FALSE</span>, <span class="dt">intercept =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb17-14" title="14"><span class="co"># cv.lars() uses crossvalidation to estimate optimal position in path</span></a>
<a class="sourceLine" id="cb17-15" title="15">cv.lasso<span class="fl">.1</span> &lt;-<span class="st"> </span>lars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/lars/topics/cv.lars">cv.lars</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple2_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb17-16" title="16">              <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple2_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y, </a>
<a class="sourceLine" id="cb17-17" title="17">              <span class="dt">plot.it=</span><span class="ot">FALSE</span>, <span class="dt">type=</span><span class="st">"lasso"</span>)</a>
<a class="sourceLine" id="cb17-18" title="18"><span class="co"># Use the "+1SE rule" to find best model: </span></a>
<a class="sourceLine" id="cb17-19" title="19"><span class="co">#    Take the min CV and add its SE ("limit").  </span></a>
<a class="sourceLine" id="cb17-20" title="20"><span class="co">#    Find smallest model that has its own CV within this limit (at "s.cv.1")</span></a>
<a class="sourceLine" id="cb17-21" title="21">limit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv) <span class="op">+</span><span class="st"> </span>cv.lasso<span class="fl">.1</span><span class="op">$</span>cv.error[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which.min">which.min</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv)]</a>
<a class="sourceLine" id="cb17-22" title="22">s.cv<span class="fl">.1</span> &lt;-<span class="st"> </span>cv.lasso<span class="fl">.1</span><span class="op">$</span>index[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv <span class="op">&lt;</span><span class="st"> </span>limit))]</a>
<a class="sourceLine" id="cb17-23" title="23"><span class="co"># Print out coefficients at optimal s.</span></a>
<a class="sourceLine" id="cb17-24" title="24">coef_lasso_sum=coef_lasso_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(lasso<span class="fl">.1</span>, <span class="dt">s=</span>s.cv<span class="fl">.1</span>, <span class="dt">mode=</span><span class="st">"fraction"</span>))</a>
<a class="sourceLine" id="cb17-25" title="25"><span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(tempcoef)){</a>
<a class="sourceLine" id="cb17-26" title="26"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"Error in lm fit, skip coefficients</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb17-27" title="27">error_counter=error_counter<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb17-28" title="28">  } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb17-29" title="29">coef_sum=coef_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(tempcoef)</a>
<a class="sourceLine" id="cb17-30" title="30">}</a>
<a class="sourceLine" id="cb17-31" title="31">}</a>
<a class="sourceLine" id="cb17-32" title="32">error_counter</a>
<a class="sourceLine" id="cb17-33" title="33"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb17-34" title="34">coef_mean=coef_sum<span class="op">/</span>NDatasets</a>
<a class="sourceLine" id="cb17-35" title="35">coef_lasso_mean=coef_lasso_sum<span class="op">/</span>NDatasets</a></code></pre></div>
<p>With regular least squares and lasso estimators all fits were sucessful, yet only 20 variables coefficients could be estimated with regular least squares estimates for the linear model. Then we display and plot that the mean coefficient vector values for the least squares estimates.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">coef_mean</a>
<a class="sourceLine" id="cb18-2" title="2"><span class="co">#&gt;           x1           x2           x3           x4           x5 </span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="co">#&gt; 1.500084e+00 1.492942e+00 1.496050e+00 1.528043e+00 1.497537e+00 </span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="co">#&gt;           x6           x7           x8           x9          x10 </span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="co">#&gt; 2.577168e-15 6.820231e-15 3.386509e-15 4.297997e-15 7.216331e-15 </span></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="co">#&gt;          x11          x12          x13          x14          x15 </span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="co">#&gt; 3.528058e-15 1.001056e-14 6.068207e-15 9.640427e-15 5.351262e-15 </span></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="co">#&gt;          x16          x17          x18          x19          x20 </span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="co">#&gt; 9.276245e-15 5.295417e-15 8.227904e-15 5.860229e-15 4.724224e-15 </span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="co">#&gt;          x21          x22          x23          x24          x25 </span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb18-12" title="12"><span class="co">#&gt;          x26          x27          x28          x29          x30 </span></a>
<a class="sourceLine" id="cb18-13" title="13"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb18-14" title="14"><span class="co">#&gt;          x31          x32          x33          x34          x35 </span></a>
<a class="sourceLine" id="cb18-15" title="15"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb18-16" title="16"><span class="co">#&gt;          x36          x37          x38          x39          x40 </span></a>
<a class="sourceLine" id="cb18-17" title="17"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb18-18" title="18"><span class="co">#&gt;          x41          x42          x43          x44          x45 </span></a>
<a class="sourceLine" id="cb18-19" title="19"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb18-20" title="20"><span class="co">#&gt;          x46          x47          x48          x49          x50 </span></a>
<a class="sourceLine" id="cb18-21" title="21"><span class="co">#&gt;           NA           NA           NA           NA           NA</span></a>
<a class="sourceLine" id="cb18-22" title="22"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_mean)</a>
<a class="sourceLine" id="cb18-23" title="23"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">coef_lasso_mean</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="co">#&gt;          x1          x2          x3          x4          x5          x6 </span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="co">#&gt; 1.020781655 1.018889052 1.035031482 1.054163515 1.000623344 0.007473859 </span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="co">#&gt;          x7          x8          x9         x10         x11         x12 </span></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="co">#&gt; 0.013204392 0.007431535 0.026662059 0.013108710 0.012142233 0.026704364 </span></a>
<a class="sourceLine" id="cb19-6" title="6"><span class="co">#&gt;         x13         x14         x15         x16         x17         x18 </span></a>
<a class="sourceLine" id="cb19-7" title="7"><span class="co">#&gt; 0.017173946 0.013759071 0.014971375 0.009803102 0.010638803 0.020817110 </span></a>
<a class="sourceLine" id="cb19-8" title="8"><span class="co">#&gt;         x19         x20         x21         x22         x23         x24 </span></a>
<a class="sourceLine" id="cb19-9" title="9"><span class="co">#&gt; 0.011776302 0.017783853 0.026576799 0.024363441 0.017900876 0.009379815 </span></a>
<a class="sourceLine" id="cb19-10" title="10"><span class="co">#&gt;         x25         x26         x27         x28         x29         x30 </span></a>
<a class="sourceLine" id="cb19-11" title="11"><span class="co">#&gt; 0.016408982 0.014971089 0.020829301 0.008885959 0.004586297 0.025270340 </span></a>
<a class="sourceLine" id="cb19-12" title="12"><span class="co">#&gt;         x31         x32         x33         x34         x35         x36 </span></a>
<a class="sourceLine" id="cb19-13" title="13"><span class="co">#&gt; 0.013851242 0.010282197 0.017552250 0.007138873 0.008011145 0.025243278 </span></a>
<a class="sourceLine" id="cb19-14" title="14"><span class="co">#&gt;         x37         x38         x39         x40         x41         x42 </span></a>
<a class="sourceLine" id="cb19-15" title="15"><span class="co">#&gt; 0.013782052 0.005243221 0.004626377 0.010275449 0.014070472 0.016684423 </span></a>
<a class="sourceLine" id="cb19-16" title="16"><span class="co">#&gt;         x43         x44         x45         x46         x47         x48 </span></a>
<a class="sourceLine" id="cb19-17" title="17"><span class="co">#&gt; 0.015994092 0.016769256 0.002942201 0.012305519 0.011827189 0.013573371 </span></a>
<a class="sourceLine" id="cb19-18" title="18"><span class="co">#&gt;         x49         x50 </span></a>
<a class="sourceLine" id="cb19-19" title="19"><span class="co">#&gt; 0.007764608 0.012717856</span></a>
<a class="sourceLine" id="cb19-20" title="20"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_lasso_mean,<span class="dt">ylim=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb19-21" title="21"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<p>The simulation process looks sucessfull: the lasso estimates retrives mostly the correct variables, yet the other ones are also selected sometimes. What are the confidence indices for those variables?</p>
</div>
</div>
<div id="third-example" class="section level1">
<h1 class="hasAnchor">
<a href="#third-example" class="anchor"></a>Third Example</h1>
<div id="aim-2" class="section level2">
<h2 class="hasAnchor">
<a href="#aim-2" class="anchor"></a>Aim</h2>
<p>We want to creates <span class="math inline">\(NDatasets=200\)</span> datasets with <span class="math inline">\(\textrm{length}(supp)=100\)</span> variables and <span class="math inline">\(N=24\)</span> observations. In that example we use real data for the <code>X</code> variables that we sample from all the <span class="math inline">\(1650\)</span> probesets that are differentially expressed between the two conditions US and S. The main interest of that simulation is that the correlation structure of the <code>X</code> dataset will be a real one.</p>
</div>
<div id="data-and-response-generations" class="section level2">
<h2 class="hasAnchor">
<a href="#data-and-response-generations" class="anchor"></a>Data and response generations</h2>
<p>First retrieve the datasets and get the differentially expressed probesets.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(CascadeData)</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(micro_S)</a>
<a class="sourceLine" id="cb20-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(micro_US)</a>
<a class="sourceLine" id="cb20-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(Cascade)</a>
<a class="sourceLine" id="cb20-5" title="5">micro_US&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/Cascade/topics/as.micro_array">as.micro_array</a></span>(micro_US,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">60</span>,<span class="dv">90</span>,<span class="dv">240</span>,<span class="dv">390</span>),<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb20-6" title="6">micro_S&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/Cascade/topics/as.micro_array">as.micro_array</a></span>(micro_S,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">60</span>,<span class="dv">90</span>,<span class="dv">240</span>,<span class="dv">390</span>),<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb20-7" title="7">S&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/Cascade/topics/genePeakSelection-methods">geneSelection</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(micro_S,micro_US),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="st">"condition"</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">1</span>),<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb20-8" title="8">Sel&lt;-micro_S<span class="op">@</span>microarray[S<span class="op">@</span>name,]</a>
<a class="sourceLine" id="cb20-9" title="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(S)</a>
<a class="sourceLine" id="cb20-10" title="10"><span class="co">#&gt;    N1_US_T60          N1_US_T90           N1_US_T210       </span></a>
<a class="sourceLine" id="cb20-11" title="11"><span class="co">#&gt;  Min.   :-3.24588   Min.   :-2.740840   Min.   :-4.056378  </span></a>
<a class="sourceLine" id="cb20-12" title="12"><span class="co">#&gt;  1st Qu.:-0.13240   1st Qu.:-0.116239   1st Qu.:-0.298263  </span></a>
<a class="sourceLine" id="cb20-13" title="13"><span class="co">#&gt;  Median :-0.04406   Median : 0.007188   Median :-0.002423  </span></a>
<a class="sourceLine" id="cb20-14" title="14"><span class="co">#&gt;  Mean   : 0.02723   Mean   : 0.008828   Mean   :-0.062663  </span></a>
<a class="sourceLine" id="cb20-15" title="15"><span class="co">#&gt;  3rd Qu.: 0.07049   3rd Qu.: 0.143812   3rd Qu.: 0.218037  </span></a>
<a class="sourceLine" id="cb20-16" title="16"><span class="co">#&gt;  Max.   : 3.00403   Max.   : 2.581014   Max.   : 3.068053  </span></a>
<a class="sourceLine" id="cb20-17" title="17"><span class="co">#&gt;    N1_US_T390        N2_US_T60         N2_US_T90          N2_US_T210      </span></a>
<a class="sourceLine" id="cb20-18" title="18"><span class="co">#&gt;  Min.   :-4.6843   Min.   :-3.1490   Min.   :-3.26105   Min.   :-3.69272  </span></a>
<a class="sourceLine" id="cb20-19" title="19"><span class="co">#&gt;  1st Qu.:-0.4123   1st Qu.: 0.1957   1st Qu.:-0.20630   1st Qu.:-0.18419  </span></a>
<a class="sourceLine" id="cb20-20" title="20"><span class="co">#&gt;  Median :-0.1167   Median : 0.3917   Median :-0.10981   Median : 0.03299  </span></a>
<a class="sourceLine" id="cb20-21" title="21"><span class="co">#&gt;  Mean   :-0.1144   Mean   : 0.4016   Mean   :-0.13583   Mean   : 0.01174  </span></a>
<a class="sourceLine" id="cb20-22" title="22"><span class="co">#&gt;  3rd Qu.: 0.1270   3rd Qu.: 0.5908   3rd Qu.:-0.02678   3rd Qu.: 0.22894  </span></a>
<a class="sourceLine" id="cb20-23" title="23"><span class="co">#&gt;  Max.   : 3.1434   Max.   : 3.7878   Max.   : 3.54337   Max.   : 2.46752  </span></a>
<a class="sourceLine" id="cb20-24" title="24"><span class="co">#&gt;    N2_US_T390         N3_US_T60          N3_US_T90       </span></a>
<a class="sourceLine" id="cb20-25" title="25"><span class="co">#&gt;  Min.   :-4.61130   Min.   :-3.66185   Min.   :-3.44746  </span></a>
<a class="sourceLine" id="cb20-26" title="26"><span class="co">#&gt;  1st Qu.:-0.21195   1st Qu.:-0.16978   1st Qu.:-0.07454  </span></a>
<a class="sourceLine" id="cb20-27" title="27"><span class="co">#&gt;  Median :-0.01994   Median :-0.03868   Median : 0.04864  </span></a>
<a class="sourceLine" id="cb20-28" title="28"><span class="co">#&gt;  Mean   :-0.04728   Mean   :-0.05892   Mean   : 0.01881  </span></a>
<a class="sourceLine" id="cb20-29" title="29"><span class="co">#&gt;  3rd Qu.: 0.16975   3rd Qu.: 0.07801   3rd Qu.: 0.15696  </span></a>
<a class="sourceLine" id="cb20-30" title="30"><span class="co">#&gt;  Max.   : 2.36837   Max.   : 3.17208   Max.   : 2.22462  </span></a>
<a class="sourceLine" id="cb20-31" title="31"><span class="co">#&gt;    N3_US_T210        N3_US_T390         N4_US_T60       </span></a>
<a class="sourceLine" id="cb20-32" title="32"><span class="co">#&gt;  Min.   :-4.2709   Min.   :-4.73460   Min.   :-1.80952  </span></a>
<a class="sourceLine" id="cb20-33" title="33"><span class="co">#&gt;  1st Qu.:-0.6869   1st Qu.:-0.21676   1st Qu.:-0.08733  </span></a>
<a class="sourceLine" id="cb20-34" title="34"><span class="co">#&gt;  Median :-0.2507   Median : 0.04391   Median :-0.03024  </span></a>
<a class="sourceLine" id="cb20-35" title="35"><span class="co">#&gt;  Mean   :-0.2593   Mean   : 0.02288   Mean   :-0.02583  </span></a>
<a class="sourceLine" id="cb20-36" title="36"><span class="co">#&gt;  3rd Qu.: 0.1073   3rd Qu.: 0.28173   3rd Qu.: 0.02099  </span></a>
<a class="sourceLine" id="cb20-37" title="37"><span class="co">#&gt;  Max.   : 3.2871   Max.   : 3.67975   Max.   : 2.20727  </span></a>
<a class="sourceLine" id="cb20-38" title="38"><span class="co">#&gt;    N4_US_T90           N4_US_T210         N4_US_T390      </span></a>
<a class="sourceLine" id="cb20-39" title="39"><span class="co">#&gt;  Min.   :-3.555348   Min.   :-2.95869   Min.   :-3.21158  </span></a>
<a class="sourceLine" id="cb20-40" title="40"><span class="co">#&gt;  1st Qu.: 0.001517   1st Qu.:-0.23332   1st Qu.:-0.17235  </span></a>
<a class="sourceLine" id="cb20-41" title="41"><span class="co">#&gt;  Median : 0.076508   Median :-0.09978   Median :-0.05177  </span></a>
<a class="sourceLine" id="cb20-42" title="42"><span class="co">#&gt;  Mean   : 0.055968   Mean   :-0.11058   Mean   :-0.06072  </span></a>
<a class="sourceLine" id="cb20-43" title="43"><span class="co">#&gt;  3rd Qu.: 0.147247   3rd Qu.: 0.02792   3rd Qu.: 0.05336  </span></a>
<a class="sourceLine" id="cb20-44" title="44"><span class="co">#&gt;  Max.   : 1.719786   Max.   : 2.91531   Max.   : 2.15722  </span></a>
<a class="sourceLine" id="cb20-45" title="45"><span class="co">#&gt;    N5_US_T60          N5_US_T90          N5_US_T210      </span></a>
<a class="sourceLine" id="cb20-46" title="46"><span class="co">#&gt;  Min.   :-2.04861   Min.   :-2.14086   Min.   :-3.61826  </span></a>
<a class="sourceLine" id="cb20-47" title="47"><span class="co">#&gt;  1st Qu.: 0.01025   1st Qu.:-0.10201   1st Qu.:-0.22499  </span></a>
<a class="sourceLine" id="cb20-48" title="48"><span class="co">#&gt;  Median : 0.09644   Median :-0.01021   Median :-0.06266  </span></a>
<a class="sourceLine" id="cb20-49" title="49"><span class="co">#&gt;  Mean   : 0.06829   Mean   :-0.02281   Mean   :-0.08268  </span></a>
<a class="sourceLine" id="cb20-50" title="50"><span class="co">#&gt;  3rd Qu.: 0.17637   3rd Qu.: 0.06101   3rd Qu.: 0.08834  </span></a>
<a class="sourceLine" id="cb20-51" title="51"><span class="co">#&gt;  Max.   : 2.23614   Max.   : 2.62104   Max.   : 2.81091  </span></a>
<a class="sourceLine" id="cb20-52" title="52"><span class="co">#&gt;    N5_US_T390         N6_US_T60           N6_US_T90       </span></a>
<a class="sourceLine" id="cb20-53" title="53"><span class="co">#&gt;  Min.   :-3.42995   Min.   :-2.814716   Min.   :-2.46213  </span></a>
<a class="sourceLine" id="cb20-54" title="54"><span class="co">#&gt;  1st Qu.:-0.11192   1st Qu.:-0.054682   1st Qu.:-0.10794  </span></a>
<a class="sourceLine" id="cb20-55" title="55"><span class="co">#&gt;  Median : 0.05497   Median : 0.008866   Median :-0.01223  </span></a>
<a class="sourceLine" id="cb20-56" title="56"><span class="co">#&gt;  Mean   : 0.02813   Mean   : 0.008599   Mean   : 0.01019  </span></a>
<a class="sourceLine" id="cb20-57" title="57"><span class="co">#&gt;  3rd Qu.: 0.20603   3rd Qu.: 0.077924   3rd Qu.: 0.09869  </span></a>
<a class="sourceLine" id="cb20-58" title="58"><span class="co">#&gt;  Max.   : 3.38922   Max.   : 2.789490   Max.   : 2.58776  </span></a>
<a class="sourceLine" id="cb20-59" title="59"><span class="co">#&gt;    N6_US_T210         N6_US_T390      </span></a>
<a class="sourceLine" id="cb20-60" title="60"><span class="co">#&gt;  Min.   :-2.89696   Min.   :-4.15575  </span></a>
<a class="sourceLine" id="cb20-61" title="61"><span class="co">#&gt;  1st Qu.:-0.17750   1st Qu.:-0.24111  </span></a>
<a class="sourceLine" id="cb20-62" title="62"><span class="co">#&gt;  Median : 0.02146   Median :-0.03612  </span></a>
<a class="sourceLine" id="cb20-63" title="63"><span class="co">#&gt;  Mean   :-0.01274   Mean   :-0.06744  </span></a>
<a class="sourceLine" id="cb20-64" title="64"><span class="co">#&gt;  3rd Qu.: 0.19801   3rd Qu.: 0.14960  </span></a>
<a class="sourceLine" id="cb20-65" title="65"><span class="co">#&gt;  Max.   : 2.08709   Max.   : 2.97212</span></a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-20-1.png" width="700"><img src="sim-with-sb_files/figure-html/unnamed-chunk-20-2.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(S)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-20-3.png" width="700"></p>
<p>Generates the datasets sampling for each of them 100 probesets expressions among the 1650 that were selected and linking the response to the expressions of the first five probesets.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">3141</span>)</a>
<a class="sourceLine" id="cb22-2" title="2">supp&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="dv">95</span>))</a>
<a class="sourceLine" id="cb22-3" title="3">minB&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb22-4" title="4">maxB&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb22-5" title="5">stn&lt;-<span class="dv">50</span></a>
<a class="sourceLine" id="cb22-6" title="6">NDatasets=<span class="dv">200</span></a>
<a class="sourceLine" id="cb22-7" title="7"></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb22-9" title="9">X&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">as.matrix</a></span>(Sel[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(Sel),<span class="dv">100</span>),]))</a>
<a class="sourceLine" id="cb22-10" title="10">Xnorm&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(X)<span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">sqrt</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colSums">colSums</a></span>(X<span class="op">*</span>X)))</a>
<a class="sourceLine" id="cb22-11" title="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/assign">assign</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple3_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>),<span class="kw"><a href="../reference/simulation.html">simulation_DATA</a></span>(Xnorm,supp,minB,maxB,stn))</a>
<a class="sourceLine" id="cb22-12" title="12">}</a></code></pre></div>
</div>
<div id="checks-1" class="section level2">
<h2 class="hasAnchor">
<a href="#checks-1" class="anchor"></a>Checks</h2>
<p>Here are the plots of an example of correlation structure, namely for <code>DATA_exemple3_nb_200$X</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(Xnorm))</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-22-1.png" width="960"></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">mixOmics<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/mixOmics/topics/cim">cim</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(Xnorm))</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-22-2.png" width="960"></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">coef_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(supp))</a>
<a class="sourceLine" id="cb25-2" title="2">coef_lasso_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(supp))</a>
<a class="sourceLine" id="cb25-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(supp),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb25-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_lasso_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(supp),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb25-5" title="5">error_counter=<span class="dv">0</span></a>
<a class="sourceLine" id="cb25-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb25-7" title="7">tempdf=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="dt">Y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple3_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y,</a>
<a class="sourceLine" id="cb25-8" title="8">                        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple3_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X))</a>
<a class="sourceLine" id="cb25-9" title="9">tempcoef=<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(Y<span class="op">~</span>.<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>tempdf))</a>
<a class="sourceLine" id="cb25-10" title="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(lars)</a>
<a class="sourceLine" id="cb25-11" title="11">lasso<span class="fl">.1</span> &lt;-<span class="st"> </span>lars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/lars/topics/lars">lars</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple3_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb25-12" title="12">              <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple3_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y, <span class="dt">type=</span><span class="st">"lasso"</span>, </a>
<a class="sourceLine" id="cb25-13" title="13">              <span class="dt">trace=</span><span class="ot">FALSE</span>, <span class="dt">normalize=</span><span class="ot">FALSE</span>, <span class="dt">intercept =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb25-14" title="14"><span class="co"># cv.lars() uses crossvalidation to estimate optimal position in path</span></a>
<a class="sourceLine" id="cb25-15" title="15">cv.lasso<span class="fl">.1</span> &lt;-<span class="st"> </span>lars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/lars/topics/cv.lars">cv.lars</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple3_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb25-16" title="16">              <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple3_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y, </a>
<a class="sourceLine" id="cb25-17" title="17">              <span class="dt">plot.it=</span><span class="ot">FALSE</span>, <span class="dt">normalize=</span><span class="ot">FALSE</span>, <span class="dt">intercept =</span> <span class="ot">FALSE</span>, <span class="dt">type=</span><span class="st">"lasso"</span>)</a>
<a class="sourceLine" id="cb25-18" title="18"><span class="co"># Use the "+1SE rule" to find best model: </span></a>
<a class="sourceLine" id="cb25-19" title="19"><span class="co">#    Take the min CV and add its SE ("limit").  </span></a>
<a class="sourceLine" id="cb25-20" title="20"><span class="co">#    Find smallest model that has its own CV within this limit (at "s.cv.1")</span></a>
<a class="sourceLine" id="cb25-21" title="21">limit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv) <span class="op">+</span><span class="st"> </span>cv.lasso<span class="fl">.1</span><span class="op">$</span>cv.error[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which.min">which.min</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv)]</a>
<a class="sourceLine" id="cb25-22" title="22">s.cv<span class="fl">.1</span> &lt;-<span class="st"> </span>cv.lasso<span class="fl">.1</span><span class="op">$</span>index[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv <span class="op">&lt;</span><span class="st"> </span>limit))]</a>
<a class="sourceLine" id="cb25-23" title="23"><span class="co"># Print out coefficients at optimal s.</span></a>
<a class="sourceLine" id="cb25-24" title="24">coef_lasso_sum=coef_lasso_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(lasso<span class="fl">.1</span>, <span class="dt">s=</span>s.cv<span class="fl">.1</span>, <span class="dt">mode=</span><span class="st">"fraction"</span>))</a>
<a class="sourceLine" id="cb25-25" title="25"><span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(tempcoef)){</a>
<a class="sourceLine" id="cb25-26" title="26"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"Error in lm fit, skip coefficients</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb25-27" title="27">error_counter=error_counter<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb25-28" title="28">  } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb25-29" title="29">coef_sum=coef_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(tempcoef)</a>
<a class="sourceLine" id="cb25-30" title="30">}</a>
<a class="sourceLine" id="cb25-31" title="31">}</a>
<a class="sourceLine" id="cb25-32" title="32">error_counter</a>
<a class="sourceLine" id="cb25-33" title="33"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb25-34" title="34">coef_mean=coef_sum<span class="op">/</span>NDatasets</a>
<a class="sourceLine" id="cb25-35" title="35">coef_lasso_mean=coef_lasso_sum<span class="op">/</span>NDatasets</a></code></pre></div>
<p>With regular least squares and lasso estimators all fits were sucessful, yet only 20 variables coefficients could be estimated with regular least squares estimates for the linear model. Then we display and plot that the mean coefficient vector values for the least squares estimates.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">coef_mean</a>
<a class="sourceLine" id="cb26-2" title="2"><span class="co">#&gt;           x1           x2           x3           x4           x5 </span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="co">#&gt; 1.501658e+00 1.491585e+00 1.534548e+00 1.522715e+00 1.511629e+00 </span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="co">#&gt;           x6           x7           x8           x9          x10 </span></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="co">#&gt; 2.624549e-14 4.608434e-14 3.550026e-14 3.210486e-14 3.542358e-14 </span></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="co">#&gt;          x11          x12          x13          x14          x15 </span></a>
<a class="sourceLine" id="cb26-7" title="7"><span class="co">#&gt; 2.869408e-14 3.966015e-14 2.230723e-14 7.520949e-14 3.840902e-14 </span></a>
<a class="sourceLine" id="cb26-8" title="8"><span class="co">#&gt;          x16          x17          x18          x19          x20 </span></a>
<a class="sourceLine" id="cb26-9" title="9"><span class="co">#&gt; 7.495801e-14 3.313703e-14 4.944136e-14 2.860247e-14 4.037312e-14 </span></a>
<a class="sourceLine" id="cb26-10" title="10"><span class="co">#&gt;          x21          x22          x23          x24          x25 </span></a>
<a class="sourceLine" id="cb26-11" title="11"><span class="co">#&gt; 7.043877e-14 3.943254e-14 5.286839e-14 4.238572e-14           NA </span></a>
<a class="sourceLine" id="cb26-12" title="12"><span class="co">#&gt;          x26          x27          x28          x29          x30 </span></a>
<a class="sourceLine" id="cb26-13" title="13"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb26-14" title="14"><span class="co">#&gt;          x31          x32          x33          x34          x35 </span></a>
<a class="sourceLine" id="cb26-15" title="15"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb26-16" title="16"><span class="co">#&gt;          x36          x37          x38          x39          x40 </span></a>
<a class="sourceLine" id="cb26-17" title="17"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb26-18" title="18"><span class="co">#&gt;          x41          x42          x43          x44          x45 </span></a>
<a class="sourceLine" id="cb26-19" title="19"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb26-20" title="20"><span class="co">#&gt;          x46          x47          x48          x49          x50 </span></a>
<a class="sourceLine" id="cb26-21" title="21"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb26-22" title="22"><span class="co">#&gt;          x51          x52          x53          x54          x55 </span></a>
<a class="sourceLine" id="cb26-23" title="23"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb26-24" title="24"><span class="co">#&gt;          x56          x57          x58          x59          x60 </span></a>
<a class="sourceLine" id="cb26-25" title="25"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb26-26" title="26"><span class="co">#&gt;          x61          x62          x63          x64          x65 </span></a>
<a class="sourceLine" id="cb26-27" title="27"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb26-28" title="28"><span class="co">#&gt;          x66          x67          x68          x69          x70 </span></a>
<a class="sourceLine" id="cb26-29" title="29"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb26-30" title="30"><span class="co">#&gt;          x71          x72          x73          x74          x75 </span></a>
<a class="sourceLine" id="cb26-31" title="31"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb26-32" title="32"><span class="co">#&gt;          x76          x77          x78          x79          x80 </span></a>
<a class="sourceLine" id="cb26-33" title="33"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb26-34" title="34"><span class="co">#&gt;          x81          x82          x83          x84          x85 </span></a>
<a class="sourceLine" id="cb26-35" title="35"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb26-36" title="36"><span class="co">#&gt;          x86          x87          x88          x89          x90 </span></a>
<a class="sourceLine" id="cb26-37" title="37"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb26-38" title="38"><span class="co">#&gt;          x91          x92          x93          x94          x95 </span></a>
<a class="sourceLine" id="cb26-39" title="39"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb26-40" title="40"><span class="co">#&gt;          x96          x97          x98          x99         x100 </span></a>
<a class="sourceLine" id="cb26-41" title="41"><span class="co">#&gt;           NA           NA           NA           NA           NA</span></a>
<a class="sourceLine" id="cb26-42" title="42"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_mean)</a>
<a class="sourceLine" id="cb26-43" title="43"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">coef_lasso_mean</a>
<a class="sourceLine" id="cb27-2" title="2"><span class="co">#&gt;          x1          x2          x3          x4          x5          x6 </span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="co">#&gt; 0.725467248 0.736588447 0.757629173 0.778850593 0.759460578 0.023313555 </span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="co">#&gt;          x7          x8          x9         x10         x11         x12 </span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="co">#&gt; 0.010584328 0.027035093 0.028712855 0.014620875 0.015099756 0.017231814 </span></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="co">#&gt;         x13         x14         x15         x16         x17         x18 </span></a>
<a class="sourceLine" id="cb27-7" title="7"><span class="co">#&gt; 0.014604397 0.027801891 0.015966838 0.018338899 0.021510447 0.013683420 </span></a>
<a class="sourceLine" id="cb27-8" title="8"><span class="co">#&gt;         x19         x20         x21         x22         x23         x24 </span></a>
<a class="sourceLine" id="cb27-9" title="9"><span class="co">#&gt; 0.010931428 0.017429941 0.026021800 0.017789975 0.012140286 0.021578170 </span></a>
<a class="sourceLine" id="cb27-10" title="10"><span class="co">#&gt;         x25         x26         x27         x28         x29         x30 </span></a>
<a class="sourceLine" id="cb27-11" title="11"><span class="co">#&gt; 0.023189907 0.016008623 0.025580763 0.021452401 0.014109307 0.014783762 </span></a>
<a class="sourceLine" id="cb27-12" title="12"><span class="co">#&gt;         x31         x32         x33         x34         x35         x36 </span></a>
<a class="sourceLine" id="cb27-13" title="13"><span class="co">#&gt; 0.024322728 0.015653647 0.011305903 0.016970461 0.023360732 0.022407182 </span></a>
<a class="sourceLine" id="cb27-14" title="14"><span class="co">#&gt;         x37         x38         x39         x40         x41         x42 </span></a>
<a class="sourceLine" id="cb27-15" title="15"><span class="co">#&gt; 0.007753430 0.011327233 0.021720839 0.009935474 0.023015633 0.012936345 </span></a>
<a class="sourceLine" id="cb27-16" title="16"><span class="co">#&gt;         x43         x44         x45         x46         x47         x48 </span></a>
<a class="sourceLine" id="cb27-17" title="17"><span class="co">#&gt; 0.015693366 0.026615612 0.010664589 0.018989056 0.012891640 0.022357984 </span></a>
<a class="sourceLine" id="cb27-18" title="18"><span class="co">#&gt;         x49         x50         x51         x52         x53         x54 </span></a>
<a class="sourceLine" id="cb27-19" title="19"><span class="co">#&gt; 0.015056362 0.021800685 0.010762423 0.021255999 0.013453485 0.019138590 </span></a>
<a class="sourceLine" id="cb27-20" title="20"><span class="co">#&gt;         x55         x56         x57         x58         x59         x60 </span></a>
<a class="sourceLine" id="cb27-21" title="21"><span class="co">#&gt; 0.015127400 0.015454598 0.014839734 0.019216979 0.017551305 0.010872447 </span></a>
<a class="sourceLine" id="cb27-22" title="22"><span class="co">#&gt;         x61         x62         x63         x64         x65         x66 </span></a>
<a class="sourceLine" id="cb27-23" title="23"><span class="co">#&gt; 0.015210900 0.018948936 0.018948696 0.019033506 0.024637671 0.011010832 </span></a>
<a class="sourceLine" id="cb27-24" title="24"><span class="co">#&gt;         x67         x68         x69         x70         x71         x72 </span></a>
<a class="sourceLine" id="cb27-25" title="25"><span class="co">#&gt; 0.020171886 0.019463645 0.012871427 0.015391142 0.021282438 0.013546175 </span></a>
<a class="sourceLine" id="cb27-26" title="26"><span class="co">#&gt;         x73         x74         x75         x76         x77         x78 </span></a>
<a class="sourceLine" id="cb27-27" title="27"><span class="co">#&gt; 0.015600153 0.026457189 0.006792839 0.019997887 0.025248118 0.017725968 </span></a>
<a class="sourceLine" id="cb27-28" title="28"><span class="co">#&gt;         x79         x80         x81         x82         x83         x84 </span></a>
<a class="sourceLine" id="cb27-29" title="29"><span class="co">#&gt; 0.014160855 0.019077533 0.022472040 0.014450753 0.021721598 0.016675160 </span></a>
<a class="sourceLine" id="cb27-30" title="30"><span class="co">#&gt;         x85         x86         x87         x88         x89         x90 </span></a>
<a class="sourceLine" id="cb27-31" title="31"><span class="co">#&gt; 0.027084835 0.008844269 0.016832882 0.022358191 0.025644246 0.016196235 </span></a>
<a class="sourceLine" id="cb27-32" title="32"><span class="co">#&gt;         x91         x92         x93         x94         x95         x96 </span></a>
<a class="sourceLine" id="cb27-33" title="33"><span class="co">#&gt; 0.024289125 0.017936576 0.020657207 0.011768473 0.021346851 0.022127919 </span></a>
<a class="sourceLine" id="cb27-34" title="34"><span class="co">#&gt;         x97         x98         x99        x100 </span></a>
<a class="sourceLine" id="cb27-35" title="35"><span class="co">#&gt; 0.019947735 0.010399517 0.017528605 0.019819379</span></a>
<a class="sourceLine" id="cb27-36" title="36"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_lasso_mean,<span class="dt">ylim=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb27-37" title="37"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>The simulation process looks sucessfull: the lasso estimates retrives mostly the correct variables, yet the other ones are also selected sometimes. What are the confidence indices for those variables?</p>
</div>
</div>
<div id="fourth-example" class="section level1">
<h1 class="hasAnchor">
<a href="#fourth-example" class="anchor"></a>Fourth Example</h1>
<div id="aim-3" class="section level2">
<h2 class="hasAnchor">
<a href="#aim-3" class="anchor"></a>Aim</h2>
<p>We want to creates <span class="math inline">\(NDatasets=101\)</span> datasets with <span class="math inline">\(\textrm{length}(supp)=100\)</span> variables and <span class="math inline">\(N=18\)</span> observations. In that example we use real data for the variables that are the <span class="math inline">\(101\)</span> probesets that are the more differentially expressed between the two conditions US and S. We create <span class="math inline">\(101\)</span> datasets by leaving one of the variables out each time and using it as the response that shall be predicted. We also only use for the explanatory variables the observations that are the measurements for the 1st, 2nd and 3rd timepoints and for the responses the observations that are the measurements of the same variables for the 2nd, 3rd and 4th timepoints. The main interest of that simulation is that the correlation structure of the <code>X</code> dataset will be a real one and that it is a typical setting for cascade network reverse-engineering in genomics or proteomics, see the <code>Cascade</code> package for more details.</p>
</div>
<div id="data-and-response-generations-1" class="section level2">
<h2 class="hasAnchor">
<a href="#data-and-response-generations-1" class="anchor"></a>Data and response generations</h2>
<p>First retrieve the datasets and get the differentially expressed probesets.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(CascadeData)</a>
<a class="sourceLine" id="cb28-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(micro_S)</a>
<a class="sourceLine" id="cb28-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(micro_US)</a>
<a class="sourceLine" id="cb28-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(Cascade)</a>
<a class="sourceLine" id="cb28-5" title="5">micro_US&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/Cascade/topics/as.micro_array">as.micro_array</a></span>(micro_US,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">60</span>,<span class="dv">90</span>,<span class="dv">240</span>,<span class="dv">390</span>),<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb28-6" title="6">micro_S&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/Cascade/topics/as.micro_array">as.micro_array</a></span>(micro_S,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">60</span>,<span class="dv">90</span>,<span class="dv">240</span>,<span class="dv">390</span>),<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb28-7" title="7">S&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/Cascade/topics/genePeakSelection-methods">geneSelection</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(micro_S,micro_US),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="st">"condition"</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">1</span>),<span class="dv">101</span>)</a>
<a class="sourceLine" id="cb28-8" title="8">Sel&lt;-micro_S<span class="op">@</span>microarray[S<span class="op">@</span>name,]</a>
<a class="sourceLine" id="cb28-9" title="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(S)</a>
<a class="sourceLine" id="cb28-10" title="10"><span class="co">#&gt;    N1_US_T60          N1_US_T90           N1_US_T210       </span></a>
<a class="sourceLine" id="cb28-11" title="11"><span class="co">#&gt;  Min.   :-0.89276   Min.   :-0.773190   Min.   :-2.079442  </span></a>
<a class="sourceLine" id="cb28-12" title="12"><span class="co">#&gt;  1st Qu.:-0.11132   1st Qu.:-0.082888   1st Qu.:-0.283990  </span></a>
<a class="sourceLine" id="cb28-13" title="13"><span class="co">#&gt;  Median :-0.03030   Median :-0.002073   Median : 0.006005  </span></a>
<a class="sourceLine" id="cb28-14" title="14"><span class="co">#&gt;  Mean   : 0.04941   Mean   : 0.015356   Mean   :-0.074991  </span></a>
<a class="sourceLine" id="cb28-15" title="15"><span class="co">#&gt;  3rd Qu.: 0.08370   3rd Qu.: 0.127301   3rd Qu.: 0.204382  </span></a>
<a class="sourceLine" id="cb28-16" title="16"><span class="co">#&gt;  Max.   : 2.53897   Max.   : 0.938891   Max.   : 1.155634  </span></a>
<a class="sourceLine" id="cb28-17" title="17"><span class="co">#&gt;    N1_US_T390         N2_US_T60         N2_US_T90       </span></a>
<a class="sourceLine" id="cb28-18" title="18"><span class="co">#&gt;  Min.   :-1.30745   Min.   :-1.6422   Min.   :-3.26105  </span></a>
<a class="sourceLine" id="cb28-19" title="19"><span class="co">#&gt;  1st Qu.:-0.44631   1st Qu.: 0.1499   1st Qu.:-0.21748  </span></a>
<a class="sourceLine" id="cb28-20" title="20"><span class="co">#&gt;  Median :-0.10464   Median : 0.3358   Median :-0.12623  </span></a>
<a class="sourceLine" id="cb28-21" title="21"><span class="co">#&gt;  Mean   :-0.03396   Mean   : 0.3331   Mean   :-0.13730  </span></a>
<a class="sourceLine" id="cb28-22" title="22"><span class="co">#&gt;  3rd Qu.: 0.23266   3rd Qu.: 0.5210   3rd Qu.:-0.04215  </span></a>
<a class="sourceLine" id="cb28-23" title="23"><span class="co">#&gt;  Max.   : 2.96588   Max.   : 2.7005   Max.   : 1.56541  </span></a>
<a class="sourceLine" id="cb28-24" title="24"><span class="co">#&gt;    N2_US_T210         N2_US_T390         N3_US_T60       </span></a>
<a class="sourceLine" id="cb28-25" title="25"><span class="co">#&gt;  Min.   :-2.55852   Min.   :-2.71910   Min.   :-2.37749  </span></a>
<a class="sourceLine" id="cb28-26" title="26"><span class="co">#&gt;  1st Qu.:-0.16896   1st Qu.:-0.31993   1st Qu.:-0.18448  </span></a>
<a class="sourceLine" id="cb28-27" title="27"><span class="co">#&gt;  Median : 0.01873   Median :-0.02216   Median :-0.06051  </span></a>
<a class="sourceLine" id="cb28-28" title="28"><span class="co">#&gt;  Mean   :-0.01445   Mean   :-0.08521   Mean   :-0.06439  </span></a>
<a class="sourceLine" id="cb28-29" title="29"><span class="co">#&gt;  3rd Qu.: 0.16535   3rd Qu.: 0.18161   3rd Qu.: 0.08545  </span></a>
<a class="sourceLine" id="cb28-30" title="30"><span class="co">#&gt;  Max.   : 1.16299   Max.   : 0.95946   Max.   : 1.00636  </span></a>
<a class="sourceLine" id="cb28-31" title="31"><span class="co">#&gt;    N3_US_T90          N3_US_T210        N3_US_T390       </span></a>
<a class="sourceLine" id="cb28-32" title="32"><span class="co">#&gt;  Min.   :-0.76029   Min.   :-1.9716   Min.   :-3.225327  </span></a>
<a class="sourceLine" id="cb28-33" title="33"><span class="co">#&gt;  1st Qu.:-0.03858   1st Qu.:-0.6713   1st Qu.:-0.258856  </span></a>
<a class="sourceLine" id="cb28-34" title="34"><span class="co">#&gt;  Median : 0.03977   Median :-0.1636   Median :-0.017611  </span></a>
<a class="sourceLine" id="cb28-35" title="35"><span class="co">#&gt;  Mean   : 0.03449   Mean   :-0.2324   Mean   :-0.004301  </span></a>
<a class="sourceLine" id="cb28-36" title="36"><span class="co">#&gt;  3rd Qu.: 0.14177   3rd Qu.: 0.2057   3rd Qu.: 0.287566  </span></a>
<a class="sourceLine" id="cb28-37" title="37"><span class="co">#&gt;  Max.   : 0.52193   Max.   : 1.3350   Max.   : 3.679747  </span></a>
<a class="sourceLine" id="cb28-38" title="38"><span class="co">#&gt;    N4_US_T60           N4_US_T90          N4_US_T210      </span></a>
<a class="sourceLine" id="cb28-39" title="39"><span class="co">#&gt;  Min.   :-0.376767   Min.   :-0.52425   Min.   :-1.38629  </span></a>
<a class="sourceLine" id="cb28-40" title="40"><span class="co">#&gt;  1st Qu.:-0.095907   1st Qu.:-0.01274   1st Qu.:-0.23321  </span></a>
<a class="sourceLine" id="cb28-41" title="41"><span class="co">#&gt;  Median :-0.032177   Median : 0.07226   Median :-0.12920  </span></a>
<a class="sourceLine" id="cb28-42" title="42"><span class="co">#&gt;  Mean   :-0.007576   Mean   : 0.06410   Mean   :-0.12071  </span></a>
<a class="sourceLine" id="cb28-43" title="43"><span class="co">#&gt;  3rd Qu.: 0.024612   3rd Qu.: 0.15332   3rd Qu.: 0.02794  </span></a>
<a class="sourceLine" id="cb28-44" title="44"><span class="co">#&gt;  Max.   : 0.734820   Max.   : 0.52910   Max.   : 0.57303  </span></a>
<a class="sourceLine" id="cb28-45" title="45"><span class="co">#&gt;    N4_US_T390         N5_US_T60          N5_US_T90        </span></a>
<a class="sourceLine" id="cb28-46" title="46"><span class="co">#&gt;  Min.   :-0.65678   Min.   :-0.92734   Min.   :-2.025374  </span></a>
<a class="sourceLine" id="cb28-47" title="47"><span class="co">#&gt;  1st Qu.:-0.19730   1st Qu.:-0.03818   1st Qu.:-0.080528  </span></a>
<a class="sourceLine" id="cb28-48" title="48"><span class="co">#&gt;  Median :-0.05158   Median : 0.05680   Median : 0.004812  </span></a>
<a class="sourceLine" id="cb28-49" title="49"><span class="co">#&gt;  Mean   :-0.07142   Mean   : 0.01675   Mean   :-0.025334  </span></a>
<a class="sourceLine" id="cb28-50" title="50"><span class="co">#&gt;  3rd Qu.: 0.07118   3rd Qu.: 0.14034   3rd Qu.: 0.055367  </span></a>
<a class="sourceLine" id="cb28-51" title="51"><span class="co">#&gt;  Max.   : 0.74194   Max.   : 0.35555   Max.   : 1.193922  </span></a>
<a class="sourceLine" id="cb28-52" title="52"><span class="co">#&gt;    N5_US_T210         N5_US_T390          N6_US_T60       </span></a>
<a class="sourceLine" id="cb28-53" title="53"><span class="co">#&gt;  Min.   :-0.87925   Min.   :-1.791759   Min.   :-1.30077  </span></a>
<a class="sourceLine" id="cb28-54" title="54"><span class="co">#&gt;  1st Qu.:-0.23615   1st Qu.:-0.167992   1st Qu.:-0.03809  </span></a>
<a class="sourceLine" id="cb28-55" title="55"><span class="co">#&gt;  Median :-0.08791   Median : 0.001692   Median : 0.01202  </span></a>
<a class="sourceLine" id="cb28-56" title="56"><span class="co">#&gt;  Mean   :-0.04003   Mean   :-0.008130   Mean   : 0.02745  </span></a>
<a class="sourceLine" id="cb28-57" title="57"><span class="co">#&gt;  3rd Qu.: 0.11900   3rd Qu.: 0.165985   3rd Qu.: 0.08639  </span></a>
<a class="sourceLine" id="cb28-58" title="58"><span class="co">#&gt;  Max.   : 2.80103   Max.   : 2.280781   Max.   : 1.29689  </span></a>
<a class="sourceLine" id="cb28-59" title="59"><span class="co">#&gt;    N6_US_T90           N6_US_T210         N6_US_T390       </span></a>
<a class="sourceLine" id="cb28-60" title="60"><span class="co">#&gt;  Min.   :-0.606136   Min.   :-1.96944   Min.   :-0.835295  </span></a>
<a class="sourceLine" id="cb28-61" title="61"><span class="co">#&gt;  1st Qu.:-0.096129   1st Qu.:-0.17553   1st Qu.:-0.282883  </span></a>
<a class="sourceLine" id="cb28-62" title="62"><span class="co">#&gt;  Median : 0.003016   Median :-0.00207   Median : 0.002766  </span></a>
<a class="sourceLine" id="cb28-63" title="63"><span class="co">#&gt;  Mean   : 0.023406   Mean   :-0.01794   Mean   :-0.046176  </span></a>
<a class="sourceLine" id="cb28-64" title="64"><span class="co">#&gt;  3rd Qu.: 0.072245   3rd Qu.: 0.20799   3rd Qu.: 0.186650  </span></a>
<a class="sourceLine" id="cb28-65" title="65"><span class="co">#&gt;  Max.   : 0.971099   Max.   : 0.96286   Max.   : 1.098612</span></a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-26-1.png" width="700"><img src="sim-with-sb_files/figure-html/unnamed-chunk-26-2.png" width="700"><img src="sim-with-sb_files/figure-html/unnamed-chunk-26-3.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(S)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-26-4.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">suppt&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb30-2" title="2">supp&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="dv">95</span>)) <span class="co">#not used since we use one of the probeset expressions as response</span></a>
<a class="sourceLine" id="cb30-3" title="3">minB&lt;-<span class="dv">1</span> <span class="co">#not used since we use one of the probeset expressions as response</span></a>
<a class="sourceLine" id="cb30-4" title="4">maxB&lt;-<span class="dv">2</span> <span class="co">#not used since we use one of the probeset expressions as response</span></a>
<a class="sourceLine" id="cb30-5" title="5">stn&lt;-<span class="dv">50</span> <span class="co">#not used since we use one of the probeset expressions as response</span></a>
<a class="sourceLine" id="cb30-6" title="6">NDatasets&lt;-<span class="dv">101</span></a>
<a class="sourceLine" id="cb30-7" title="7"></a>
<a class="sourceLine" id="cb30-8" title="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">3141</span>)</a>
<a class="sourceLine" id="cb30-9" title="9"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb30-10" title="10">  <span class="co">#the explanatory variables are the values for the 1st, 2nd and 3rd timepoints</span></a>
<a class="sourceLine" id="cb30-11" title="11">  X&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">as.matrix</a></span>(Sel[<span class="op">-</span>i,suppt<span class="op">!=</span><span class="dv">4</span>]))</a>
<a class="sourceLine" id="cb30-12" title="12">  Xnorm&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(X)<span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">sqrt</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colSums">colSums</a></span>(X<span class="op">*</span>X)))</a>
<a class="sourceLine" id="cb30-13" title="13">  DATA&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_DATA</a></span>(Xnorm,supp,minB,maxB,stn)</a>
<a class="sourceLine" id="cb30-14" title="14">  <span class="co">#the reponses are the values for the 2nd, 3rd and 4th timepoints</span></a>
<a class="sourceLine" id="cb30-15" title="15">  DATA<span class="op">$</span>Y&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/vector">as.vector</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(Sel[i,suppt<span class="op">!=</span><span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb30-16" title="16">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/assign">assign</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple4_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>),DATA)</a>
<a class="sourceLine" id="cb30-17" title="17">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rm">rm</a></span>(DATA)</a>
<a class="sourceLine" id="cb30-18" title="18">}</a></code></pre></div>
</div>
<div id="checks-2" class="section level2">
<h2 class="hasAnchor">
<a href="#checks-2" class="anchor"></a>Checks</h2>
<p>Here are the plots of an example of correlation structure, namely for <code>DATA_exemple3_nb_200$X</code>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(Xnorm))</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-28-1.png" width="960"></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">mixOmics<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/mixOmics/topics/cim">cim</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(Xnorm))</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-28-2.png" width="960"></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">coef_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(supp)<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb33-2" title="2">coef_lasso_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(supp)<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb33-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(supp)<span class="op">+</span><span class="dv">1</span>),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb33-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_lasso_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(supp)<span class="op">+</span><span class="dv">1</span>),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb33-5" title="5">error_counter=<span class="dv">0</span></a>
<a class="sourceLine" id="cb33-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb33-7" title="7">tempdf=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="dt">Y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple4_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y,</a>
<a class="sourceLine" id="cb33-8" title="8">                        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple4_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X))</a>
<a class="sourceLine" id="cb33-9" title="9">tempcoef=<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(Y<span class="op">~</span>.<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>tempdf))</a>
<a class="sourceLine" id="cb33-10" title="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(lars)</a>
<a class="sourceLine" id="cb33-11" title="11">lasso<span class="fl">.1</span> &lt;-<span class="st"> </span>lars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/lars/topics/lars">lars</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple4_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb33-12" title="12">              <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple4_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y, <span class="dt">type=</span><span class="st">"lasso"</span>, </a>
<a class="sourceLine" id="cb33-13" title="13">              <span class="dt">trace=</span><span class="ot">FALSE</span>, <span class="dt">normalize=</span><span class="ot">FALSE</span>, <span class="dt">intercept =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb33-14" title="14"><span class="co"># cv.lars() uses crossvalidation to estimate optimal position in path</span></a>
<a class="sourceLine" id="cb33-15" title="15">cv.lasso<span class="fl">.1</span> &lt;-<span class="st"> </span>lars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/lars/topics/cv.lars">cv.lars</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple4_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb33-16" title="16">              <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple4_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y, </a>
<a class="sourceLine" id="cb33-17" title="17">              <span class="dt">plot.it=</span><span class="ot">FALSE</span>, <span class="dt">normalize=</span><span class="ot">FALSE</span>, <span class="dt">intercept =</span> <span class="ot">FALSE</span>, <span class="dt">type=</span><span class="st">"lasso"</span>)</a>
<a class="sourceLine" id="cb33-18" title="18"><span class="co"># Use the "+1SE rule" to find best model: </span></a>
<a class="sourceLine" id="cb33-19" title="19"><span class="co">#    Take the min CV and add its SE ("limit").  </span></a>
<a class="sourceLine" id="cb33-20" title="20"><span class="co">#    Find smallest model that has its own CV within this limit (at "s.cv.1")</span></a>
<a class="sourceLine" id="cb33-21" title="21">limit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv) <span class="op">+</span><span class="st"> </span>cv.lasso<span class="fl">.1</span><span class="op">$</span>cv.error[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which.min">which.min</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv)]</a>
<a class="sourceLine" id="cb33-22" title="22">s.cv<span class="fl">.1</span> &lt;-<span class="st"> </span>cv.lasso<span class="fl">.1</span><span class="op">$</span>index[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv <span class="op">&lt;</span><span class="st"> </span>limit))]</a>
<a class="sourceLine" id="cb33-23" title="23"><span class="co"># Print out coefficients at optimal s.</span></a>
<a class="sourceLine" id="cb33-24" title="24">coef_lasso_sum[<span class="op">-</span>i]=coef_lasso_sum[<span class="op">-</span>i]<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(lasso<span class="fl">.1</span>, <span class="dt">s=</span>s.cv<span class="fl">.1</span>, <span class="dt">mode=</span><span class="st">"fraction"</span>))</a>
<a class="sourceLine" id="cb33-25" title="25"><span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(tempcoef)){</a>
<a class="sourceLine" id="cb33-26" title="26"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"Error in lm fit, skip coefficients</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb33-27" title="27">error_counter=error_counter<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb33-28" title="28">  } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb33-29" title="29">coef_sum[<span class="op">-</span>i]=coef_sum[<span class="op">-</span>i]<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(tempcoef)</a>
<a class="sourceLine" id="cb33-30" title="30">}</a>
<a class="sourceLine" id="cb33-31" title="31">}</a>
<a class="sourceLine" id="cb33-32" title="32">error_counter</a>
<a class="sourceLine" id="cb33-33" title="33"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb33-34" title="34">coef_mean=coef_sum<span class="op">/</span>NDatasets</a>
<a class="sourceLine" id="cb33-35" title="35">coef_lasso_mean=coef_lasso_sum<span class="op">/</span>NDatasets</a></code></pre></div>
<p>With regular least squares and lasso estimators all fits were sucessful, yet only 20 variables coefficients could be estimated with regular least squares estimates for the linear model. Then we display and plot that the mean coefficient vector values for the least squares estimates.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">coef_mean</a>
<a class="sourceLine" id="cb34-2" title="2"><span class="co">#&gt;         x1         x2         x3         x4         x5         x6 </span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="co">#&gt; 14349.4269  8154.5511 14420.0396  5840.7360 15688.8442 12563.4724 </span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="co">#&gt;         x7         x8         x9        x10        x11        x12 </span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="co">#&gt;   603.4098  8310.8567 13063.4258  9127.8669  6589.8195  6108.8444 </span></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="co">#&gt;        x13        x14        x15        x16        x17        x18 </span></a>
<a class="sourceLine" id="cb34-7" title="7"><span class="co">#&gt; 17045.1586  1160.3101 13911.5637  1626.6271  7104.9765 22361.0928 </span></a>
<a class="sourceLine" id="cb34-8" title="8"><span class="co">#&gt;        x19        x20        x21        x22        x23        x24 </span></a>
<a class="sourceLine" id="cb34-9" title="9"><span class="co">#&gt;         NA         NA         NA         NA         NA         NA </span></a>
<a class="sourceLine" id="cb34-10" title="10"><span class="co">#&gt;        x25        x26        x27        x28        x29        x30 </span></a>
<a class="sourceLine" id="cb34-11" title="11"><span class="co">#&gt;         NA         NA         NA         NA         NA         NA </span></a>
<a class="sourceLine" id="cb34-12" title="12"><span class="co">#&gt;        x31        x32        x33        x34        x35        x36 </span></a>
<a class="sourceLine" id="cb34-13" title="13"><span class="co">#&gt;         NA         NA         NA         NA         NA         NA </span></a>
<a class="sourceLine" id="cb34-14" title="14"><span class="co">#&gt;        x37        x38        x39        x40        x41        x42 </span></a>
<a class="sourceLine" id="cb34-15" title="15"><span class="co">#&gt;         NA         NA         NA         NA         NA         NA </span></a>
<a class="sourceLine" id="cb34-16" title="16"><span class="co">#&gt;        x43        x44        x45        x46        x47        x48 </span></a>
<a class="sourceLine" id="cb34-17" title="17"><span class="co">#&gt;         NA         NA         NA         NA         NA         NA </span></a>
<a class="sourceLine" id="cb34-18" title="18"><span class="co">#&gt;        x49        x50        x51        x52        x53        x54 </span></a>
<a class="sourceLine" id="cb34-19" title="19"><span class="co">#&gt;         NA         NA         NA         NA         NA         NA </span></a>
<a class="sourceLine" id="cb34-20" title="20"><span class="co">#&gt;        x55        x56        x57        x58        x59        x60 </span></a>
<a class="sourceLine" id="cb34-21" title="21"><span class="co">#&gt;         NA         NA         NA         NA         NA         NA </span></a>
<a class="sourceLine" id="cb34-22" title="22"><span class="co">#&gt;        x61        x62        x63        x64        x65        x66 </span></a>
<a class="sourceLine" id="cb34-23" title="23"><span class="co">#&gt;         NA         NA         NA         NA         NA         NA </span></a>
<a class="sourceLine" id="cb34-24" title="24"><span class="co">#&gt;        x67        x68        x69        x70        x71        x72 </span></a>
<a class="sourceLine" id="cb34-25" title="25"><span class="co">#&gt;         NA         NA         NA         NA         NA         NA </span></a>
<a class="sourceLine" id="cb34-26" title="26"><span class="co">#&gt;        x73        x74        x75        x76        x77        x78 </span></a>
<a class="sourceLine" id="cb34-27" title="27"><span class="co">#&gt;         NA         NA         NA         NA         NA         NA </span></a>
<a class="sourceLine" id="cb34-28" title="28"><span class="co">#&gt;        x79        x80        x81        x82        x83        x84 </span></a>
<a class="sourceLine" id="cb34-29" title="29"><span class="co">#&gt;         NA         NA         NA         NA         NA         NA </span></a>
<a class="sourceLine" id="cb34-30" title="30"><span class="co">#&gt;        x85        x86        x87        x88        x89        x90 </span></a>
<a class="sourceLine" id="cb34-31" title="31"><span class="co">#&gt;         NA         NA         NA         NA         NA         NA </span></a>
<a class="sourceLine" id="cb34-32" title="32"><span class="co">#&gt;        x91        x92        x93        x94        x95        x96 </span></a>
<a class="sourceLine" id="cb34-33" title="33"><span class="co">#&gt;         NA         NA         NA         NA         NA         NA </span></a>
<a class="sourceLine" id="cb34-34" title="34"><span class="co">#&gt;        x97        x98        x99       x100       x101 </span></a>
<a class="sourceLine" id="cb34-35" title="35"><span class="co">#&gt;         NA         NA         NA         NA         NA</span></a>
<a class="sourceLine" id="cb34-36" title="36"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_mean)</a>
<a class="sourceLine" id="cb34-37" title="37"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">coef_lasso_mean</a>
<a class="sourceLine" id="cb35-2" title="2"><span class="co">#&gt;          x1          x2          x3          x4          x5          x6 </span></a>
<a class="sourceLine" id="cb35-3" title="3"><span class="co">#&gt;  34.1504603   5.2295703  16.0580418  22.5403179   0.0000000   5.6362939 </span></a>
<a class="sourceLine" id="cb35-4" title="4"><span class="co">#&gt;          x7          x8          x9         x10         x11         x12 </span></a>
<a class="sourceLine" id="cb35-5" title="5"><span class="co">#&gt;  79.4055345   2.1769133   0.0000000   5.6261241  13.2812293   3.6692784 </span></a>
<a class="sourceLine" id="cb35-6" title="6"><span class="co">#&gt;         x13         x14         x15         x16         x17         x18 </span></a>
<a class="sourceLine" id="cb35-7" title="7"><span class="co">#&gt;   0.1028558  49.0576280   0.0000000  69.8242035   0.5811578   7.9486446 </span></a>
<a class="sourceLine" id="cb35-8" title="8"><span class="co">#&gt;         x19         x20         x21         x22         x23         x24 </span></a>
<a class="sourceLine" id="cb35-9" title="9"><span class="co">#&gt;   3.8336803   0.7873400   0.0000000  10.6088266   1.0496033  16.0519509 </span></a>
<a class="sourceLine" id="cb35-10" title="10"><span class="co">#&gt;         x25         x26         x27         x28         x29         x30 </span></a>
<a class="sourceLine" id="cb35-11" title="11"><span class="co">#&gt;   7.4600895   0.7876123  53.5049108   1.0376747  26.1218414   1.2841470 </span></a>
<a class="sourceLine" id="cb35-12" title="12"><span class="co">#&gt;         x31         x32         x33         x34         x35         x36 </span></a>
<a class="sourceLine" id="cb35-13" title="13"><span class="co">#&gt; 185.3155279  48.2326971   0.0000000   1.4045820  35.4478409   8.6865785 </span></a>
<a class="sourceLine" id="cb35-14" title="14"><span class="co">#&gt;         x37         x38         x39         x40         x41         x42 </span></a>
<a class="sourceLine" id="cb35-15" title="15"><span class="co">#&gt; 132.1076764  14.1994829  10.2714212   0.1735742   0.0000000 106.1815426 </span></a>
<a class="sourceLine" id="cb35-16" title="16"><span class="co">#&gt;         x43         x44         x45         x46         x47         x48 </span></a>
<a class="sourceLine" id="cb35-17" title="17"><span class="co">#&gt;  25.8901378   0.2626190  53.9414390  11.9194494   1.1852541  20.7142474 </span></a>
<a class="sourceLine" id="cb35-18" title="18"><span class="co">#&gt;         x49         x50         x51         x52         x53         x54 </span></a>
<a class="sourceLine" id="cb35-19" title="19"><span class="co">#&gt;   0.0000000  40.0453376  38.6999328   1.6672213  88.4485257   0.1891424 </span></a>
<a class="sourceLine" id="cb35-20" title="20"><span class="co">#&gt;         x55         x56         x57         x58         x59         x60 </span></a>
<a class="sourceLine" id="cb35-21" title="21"><span class="co">#&gt;  70.6141345   0.3899913  69.4407836   0.0000000 128.4853512  46.3457980 </span></a>
<a class="sourceLine" id="cb35-22" title="22"><span class="co">#&gt;         x61         x62         x63         x64         x65         x66 </span></a>
<a class="sourceLine" id="cb35-23" title="23"><span class="co">#&gt;  42.2754601 157.5271831   7.8330356  45.9190285   0.0000000  15.1299956 </span></a>
<a class="sourceLine" id="cb35-24" title="24"><span class="co">#&gt;         x67         x68         x69         x70         x71         x72 </span></a>
<a class="sourceLine" id="cb35-25" title="25"><span class="co">#&gt;   0.0732220   0.0000000  34.0048887  10.9746506   0.0000000  83.6781253 </span></a>
<a class="sourceLine" id="cb35-26" title="26"><span class="co">#&gt;         x73         x74         x75         x76         x77         x78 </span></a>
<a class="sourceLine" id="cb35-27" title="27"><span class="co">#&gt;   0.0000000  65.4600101   0.0000000   4.8108369   6.6390045  51.9617069 </span></a>
<a class="sourceLine" id="cb35-28" title="28"><span class="co">#&gt;         x79         x80         x81         x82         x83         x84 </span></a>
<a class="sourceLine" id="cb35-29" title="29"><span class="co">#&gt;   0.0000000  44.8637916  40.6399803  81.6186745 115.1664178 187.7889433 </span></a>
<a class="sourceLine" id="cb35-30" title="30"><span class="co">#&gt;         x85         x86         x87         x88         x89         x90 </span></a>
<a class="sourceLine" id="cb35-31" title="31"><span class="co">#&gt;  12.6215228   3.7075067  34.6494263  87.5871756  19.5481442   0.0000000 </span></a>
<a class="sourceLine" id="cb35-32" title="32"><span class="co">#&gt;         x91         x92         x93         x94         x95         x96 </span></a>
<a class="sourceLine" id="cb35-33" title="33"><span class="co">#&gt;  37.5572698   7.6228246  12.3126556  43.4391316   8.0776320   0.5393882 </span></a>
<a class="sourceLine" id="cb35-34" title="34"><span class="co">#&gt;         x97         x98         x99        x100        x101 </span></a>
<a class="sourceLine" id="cb35-35" title="35"><span class="co">#&gt;  11.3428544  40.3550817   2.3701894  18.8452724   9.3627109</span></a>
<a class="sourceLine" id="cb35-36" title="36"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_lasso_mean)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<p>Some probesets seem explanatory for many other ones (=hubs). What are the confidence indices for those variables?</p>
</div>
</div>
<div id="fifth-example" class="section level1">
<h1 class="hasAnchor">
<a href="#fifth-example" class="anchor"></a>Fifth Example</h1>
<div id="aim-4" class="section level2">
<h2 class="hasAnchor">
<a href="#aim-4" class="anchor"></a>Aim</h2>
<p>We want to creates <span class="math inline">\(NDatasets=200\)</span> datasets with <span class="math inline">\(\textrm{length}(group)=500\)</span> variables and <span class="math inline">\(N=25\)</span> observations. In that example we want <span class="math inline">\(1\)</span> group:</p>
<ul>
<li>
<span class="math inline">\(x_1\)</span>, , <span class="math inline">\(x_{500}\)</span> belong to the same group and the intra-group Pearson correlation for this group is equal to <span class="math inline">\(.5\)</span>.</li>
<li>only the first five variables <span class="math inline">\(x_1\)</span>, , <span class="math inline">\(x_{5}\)</span> are explanatory variables for the response.</li>
</ul>
</div>
<div id="correlation-structure-2" class="section level2">
<h2 class="hasAnchor">
<a href="#correlation-structure-2" class="anchor"></a>Correlation structure</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">  group&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">1</span>,<span class="dv">500</span>) <span class="co">#500 variables</span></a>
<a class="sourceLine" id="cb36-2" title="2">  cor_group&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="fl">0.5</span>,<span class="dv">1</span>)</a></code></pre></div>
</div>
<div id="explanatory-variables-and-response-1" class="section level2">
<h2 class="hasAnchor">
<a href="#explanatory-variables-and-response-1" class="anchor"></a>Explanatory variables and response</h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">3141</span>)</a>
<a class="sourceLine" id="cb37-2" title="2">N&lt;-<span class="dv">25</span></a>
<a class="sourceLine" id="cb37-3" title="3">supp&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="dv">495</span>))</a>
<a class="sourceLine" id="cb37-4" title="4">minB&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb37-5" title="5">maxB&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb37-6" title="6">stn&lt;-<span class="dv">50</span></a>
<a class="sourceLine" id="cb37-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb37-8" title="8">  C&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_cor</a></span>(group,cor_group)</a>
<a class="sourceLine" id="cb37-9" title="9">  X&lt;-<span class="kw"><a href="../reference/simulation.html">simulation_X</a></span>(N,C)</a>
<a class="sourceLine" id="cb37-10" title="10">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/assign">assign</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple5_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>),<span class="kw"><a href="../reference/simulation.html">simulation_DATA</a></span>(X,supp,minB,maxB,stn))</a>
<a class="sourceLine" id="cb37-11" title="11">}</a></code></pre></div>
</div>
<div id="checks-3" class="section level2">
<h2 class="hasAnchor">
<a href="#checks-3" class="anchor"></a>Checks</h2>
<p>We now check the correlation structure of the explanatory variable. First we compute the mean correlation matrix.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">corr_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb38-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb38-3" title="3">corr_sum=corr_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple5_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X)</a>
<a class="sourceLine" id="cb38-4" title="4">}</a>
<a class="sourceLine" id="cb38-5" title="5">corr_mean=corr_sum<span class="op">/</span>NDatasets</a></code></pre></div>
<p>Then we display and plot that the mean correlation matrix.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">corr_mean[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]</a>
<a class="sourceLine" id="cb39-2" title="2"><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]</span></a>
<a class="sourceLine" id="cb39-3" title="3"><span class="co">#&gt; [1,] 1.0000000 0.4684444 0.4944331 0.4628645 0.4961487 0.4956996</span></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="co">#&gt; [2,] 0.4684444 1.0000000 0.5102506 0.5026134 0.4960774 0.4948349</span></a>
<a class="sourceLine" id="cb39-5" title="5"><span class="co">#&gt; [3,] 0.4944331 0.5102506 1.0000000 0.4853991 0.4907725 0.5089649</span></a>
<a class="sourceLine" id="cb39-6" title="6"><span class="co">#&gt; [4,] 0.4628645 0.5026134 0.4853991 1.0000000 0.4670240 0.4837113</span></a>
<a class="sourceLine" id="cb39-7" title="7"><span class="co">#&gt; [5,] 0.4961487 0.4960774 0.4907725 0.4670240 1.0000000 0.4932811</span></a>
<a class="sourceLine" id="cb39-8" title="8"><span class="co">#&gt; [6,] 0.4956996 0.4948349 0.5089649 0.4837113 0.4932811 1.0000000</span></a>
<a class="sourceLine" id="cb39-9" title="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(corr_mean))</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-35-1.png" width="576"></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">coef_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb40-2" title="2">coef_lasso_sum=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group))</a>
<a class="sourceLine" id="cb40-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb40-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(coef_lasso_sum)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"x"</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(group),<span class="dt">sep=</span><span class="st">""</span>)</a>
<a class="sourceLine" id="cb40-5" title="5">error_counter=<span class="dv">0</span></a>
<a class="sourceLine" id="cb40-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NDatasets){</a>
<a class="sourceLine" id="cb40-7" title="7">tempdf=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="dt">Y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple5_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y,</a>
<a class="sourceLine" id="cb40-8" title="8">                        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple5_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X))</a>
<a class="sourceLine" id="cb40-9" title="9">tempcoef=<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(Y<span class="op">~</span>.<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>tempdf))</a>
<a class="sourceLine" id="cb40-10" title="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(lars)</a>
<a class="sourceLine" id="cb40-11" title="11">lasso<span class="fl">.1</span> &lt;-<span class="st"> </span>lars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/lars/topics/lars">lars</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple5_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb40-12" title="12">              <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple5_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y, <span class="dt">type=</span><span class="st">"lasso"</span>, </a>
<a class="sourceLine" id="cb40-13" title="13">              <span class="dt">trace=</span><span class="ot">FALSE</span>, <span class="dt">normalize=</span><span class="ot">FALSE</span>, <span class="dt">intercept =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb40-14" title="14"><span class="co"># cv.lars() uses crossvalidation to estimate optimal position in path</span></a>
<a class="sourceLine" id="cb40-15" title="15">cv.lasso<span class="fl">.1</span> &lt;-<span class="st"> </span>lars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/lars/topics/cv.lars">cv.lars</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple5_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb40-16" title="16">              <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"DATA_exemple5_nb_"</span>,i,<span class="dt">sep=</span><span class="st">""</span>))<span class="op">$</span>Y, </a>
<a class="sourceLine" id="cb40-17" title="17">              <span class="dt">plot.it=</span><span class="ot">FALSE</span>, <span class="dt">type=</span><span class="st">"lasso"</span>)</a>
<a class="sourceLine" id="cb40-18" title="18"><span class="co"># Use the "+1SE rule" to find best model: </span></a>
<a class="sourceLine" id="cb40-19" title="19"><span class="co">#    Take the min CV and add its SE ("limit").  </span></a>
<a class="sourceLine" id="cb40-20" title="20"><span class="co">#    Find smallest model that has its own CV within this limit (at "s.cv.1")</span></a>
<a class="sourceLine" id="cb40-21" title="21">limit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv) <span class="op">+</span><span class="st"> </span>cv.lasso<span class="fl">.1</span><span class="op">$</span>cv.error[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which.min">which.min</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv)]</a>
<a class="sourceLine" id="cb40-22" title="22">s.cv<span class="fl">.1</span> &lt;-<span class="st"> </span>cv.lasso<span class="fl">.1</span><span class="op">$</span>index[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(cv.lasso<span class="fl">.1</span><span class="op">$</span>cv <span class="op">&lt;</span><span class="st"> </span>limit))]</a>
<a class="sourceLine" id="cb40-23" title="23"><span class="co"># Print out coefficients at optimal s.</span></a>
<a class="sourceLine" id="cb40-24" title="24">coef_lasso_sum=coef_lasso_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(lasso<span class="fl">.1</span>, <span class="dt">s=</span>s.cv<span class="fl">.1</span>, <span class="dt">mode=</span><span class="st">"fraction"</span>))</a>
<a class="sourceLine" id="cb40-25" title="25"><span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(tempcoef)){</a>
<a class="sourceLine" id="cb40-26" title="26"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"Error in lm fit, skip coefficients</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb40-27" title="27">error_counter=error_counter<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb40-28" title="28">  } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb40-29" title="29">coef_sum=coef_sum<span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(tempcoef)</a>
<a class="sourceLine" id="cb40-30" title="30">}</a>
<a class="sourceLine" id="cb40-31" title="31">}</a>
<a class="sourceLine" id="cb40-32" title="32">error_counter</a>
<a class="sourceLine" id="cb40-33" title="33"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb40-34" title="34">coef_mean=coef_sum<span class="op">/</span>NDatasets</a>
<a class="sourceLine" id="cb40-35" title="35">coef_lasso_mean=coef_lasso_sum<span class="op">/</span>NDatasets</a></code></pre></div>
<p>With regular least squares and lasso estimators all fits were sucessful, yet only 20 variables coefficients could be estimated with regular least squares estimates for the linear model. Then we display and plot that the mean coefficient vector values for the least squares estimates.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">coef_mean</a>
<a class="sourceLine" id="cb41-2" title="2"><span class="co">#&gt;           x1           x2           x3           x4           x5 </span></a>
<a class="sourceLine" id="cb41-3" title="3"><span class="co">#&gt; 1.503770e+00 1.535116e+00 1.484148e+00 1.509255e+00 1.514028e+00 </span></a>
<a class="sourceLine" id="cb41-4" title="4"><span class="co">#&gt;           x6           x7           x8           x9          x10 </span></a>
<a class="sourceLine" id="cb41-5" title="5"><span class="co">#&gt; 3.173485e-15 3.037102e-15 2.889551e-15 3.154865e-15 7.183429e-15 </span></a>
<a class="sourceLine" id="cb41-6" title="6"><span class="co">#&gt;          x11          x12          x13          x14          x15 </span></a>
<a class="sourceLine" id="cb41-7" title="7"><span class="co">#&gt; 3.394267e-15 2.841336e-15 3.716311e-15 3.182421e-15 3.427576e-15 </span></a>
<a class="sourceLine" id="cb41-8" title="8"><span class="co">#&gt;          x16          x17          x18          x19          x20 </span></a>
<a class="sourceLine" id="cb41-9" title="9"><span class="co">#&gt; 3.919400e-15 4.673144e-15 3.955783e-15 3.303872e-15 5.303571e-15 </span></a>
<a class="sourceLine" id="cb41-10" title="10"><span class="co">#&gt;          x21          x22          x23          x24          x25 </span></a>
<a class="sourceLine" id="cb41-11" title="11"><span class="co">#&gt; 5.550495e-15 3.081008e-15 2.254520e-15 3.381582e-15 3.730642e-15 </span></a>
<a class="sourceLine" id="cb41-12" title="12"><span class="co">#&gt;          x26          x27          x28          x29          x30 </span></a>
<a class="sourceLine" id="cb41-13" title="13"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-14" title="14"><span class="co">#&gt;          x31          x32          x33          x34          x35 </span></a>
<a class="sourceLine" id="cb41-15" title="15"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-16" title="16"><span class="co">#&gt;          x36          x37          x38          x39          x40 </span></a>
<a class="sourceLine" id="cb41-17" title="17"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-18" title="18"><span class="co">#&gt;          x41          x42          x43          x44          x45 </span></a>
<a class="sourceLine" id="cb41-19" title="19"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-20" title="20"><span class="co">#&gt;          x46          x47          x48          x49          x50 </span></a>
<a class="sourceLine" id="cb41-21" title="21"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-22" title="22"><span class="co">#&gt;          x51          x52          x53          x54          x55 </span></a>
<a class="sourceLine" id="cb41-23" title="23"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-24" title="24"><span class="co">#&gt;          x56          x57          x58          x59          x60 </span></a>
<a class="sourceLine" id="cb41-25" title="25"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-26" title="26"><span class="co">#&gt;          x61          x62          x63          x64          x65 </span></a>
<a class="sourceLine" id="cb41-27" title="27"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-28" title="28"><span class="co">#&gt;          x66          x67          x68          x69          x70 </span></a>
<a class="sourceLine" id="cb41-29" title="29"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-30" title="30"><span class="co">#&gt;          x71          x72          x73          x74          x75 </span></a>
<a class="sourceLine" id="cb41-31" title="31"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-32" title="32"><span class="co">#&gt;          x76          x77          x78          x79          x80 </span></a>
<a class="sourceLine" id="cb41-33" title="33"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-34" title="34"><span class="co">#&gt;          x81          x82          x83          x84          x85 </span></a>
<a class="sourceLine" id="cb41-35" title="35"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-36" title="36"><span class="co">#&gt;          x86          x87          x88          x89          x90 </span></a>
<a class="sourceLine" id="cb41-37" title="37"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-38" title="38"><span class="co">#&gt;          x91          x92          x93          x94          x95 </span></a>
<a class="sourceLine" id="cb41-39" title="39"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-40" title="40"><span class="co">#&gt;          x96          x97          x98          x99         x100 </span></a>
<a class="sourceLine" id="cb41-41" title="41"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-42" title="42"><span class="co">#&gt;         x101         x102         x103         x104         x105 </span></a>
<a class="sourceLine" id="cb41-43" title="43"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-44" title="44"><span class="co">#&gt;         x106         x107         x108         x109         x110 </span></a>
<a class="sourceLine" id="cb41-45" title="45"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-46" title="46"><span class="co">#&gt;         x111         x112         x113         x114         x115 </span></a>
<a class="sourceLine" id="cb41-47" title="47"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-48" title="48"><span class="co">#&gt;         x116         x117         x118         x119         x120 </span></a>
<a class="sourceLine" id="cb41-49" title="49"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-50" title="50"><span class="co">#&gt;         x121         x122         x123         x124         x125 </span></a>
<a class="sourceLine" id="cb41-51" title="51"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-52" title="52"><span class="co">#&gt;         x126         x127         x128         x129         x130 </span></a>
<a class="sourceLine" id="cb41-53" title="53"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-54" title="54"><span class="co">#&gt;         x131         x132         x133         x134         x135 </span></a>
<a class="sourceLine" id="cb41-55" title="55"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-56" title="56"><span class="co">#&gt;         x136         x137         x138         x139         x140 </span></a>
<a class="sourceLine" id="cb41-57" title="57"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-58" title="58"><span class="co">#&gt;         x141         x142         x143         x144         x145 </span></a>
<a class="sourceLine" id="cb41-59" title="59"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-60" title="60"><span class="co">#&gt;         x146         x147         x148         x149         x150 </span></a>
<a class="sourceLine" id="cb41-61" title="61"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-62" title="62"><span class="co">#&gt;         x151         x152         x153         x154         x155 </span></a>
<a class="sourceLine" id="cb41-63" title="63"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-64" title="64"><span class="co">#&gt;         x156         x157         x158         x159         x160 </span></a>
<a class="sourceLine" id="cb41-65" title="65"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-66" title="66"><span class="co">#&gt;         x161         x162         x163         x164         x165 </span></a>
<a class="sourceLine" id="cb41-67" title="67"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-68" title="68"><span class="co">#&gt;         x166         x167         x168         x169         x170 </span></a>
<a class="sourceLine" id="cb41-69" title="69"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-70" title="70"><span class="co">#&gt;         x171         x172         x173         x174         x175 </span></a>
<a class="sourceLine" id="cb41-71" title="71"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-72" title="72"><span class="co">#&gt;         x176         x177         x178         x179         x180 </span></a>
<a class="sourceLine" id="cb41-73" title="73"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-74" title="74"><span class="co">#&gt;         x181         x182         x183         x184         x185 </span></a>
<a class="sourceLine" id="cb41-75" title="75"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-76" title="76"><span class="co">#&gt;         x186         x187         x188         x189         x190 </span></a>
<a class="sourceLine" id="cb41-77" title="77"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-78" title="78"><span class="co">#&gt;         x191         x192         x193         x194         x195 </span></a>
<a class="sourceLine" id="cb41-79" title="79"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-80" title="80"><span class="co">#&gt;         x196         x197         x198         x199         x200 </span></a>
<a class="sourceLine" id="cb41-81" title="81"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-82" title="82"><span class="co">#&gt;         x201         x202         x203         x204         x205 </span></a>
<a class="sourceLine" id="cb41-83" title="83"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-84" title="84"><span class="co">#&gt;         x206         x207         x208         x209         x210 </span></a>
<a class="sourceLine" id="cb41-85" title="85"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-86" title="86"><span class="co">#&gt;         x211         x212         x213         x214         x215 </span></a>
<a class="sourceLine" id="cb41-87" title="87"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-88" title="88"><span class="co">#&gt;         x216         x217         x218         x219         x220 </span></a>
<a class="sourceLine" id="cb41-89" title="89"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-90" title="90"><span class="co">#&gt;         x221         x222         x223         x224         x225 </span></a>
<a class="sourceLine" id="cb41-91" title="91"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-92" title="92"><span class="co">#&gt;         x226         x227         x228         x229         x230 </span></a>
<a class="sourceLine" id="cb41-93" title="93"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-94" title="94"><span class="co">#&gt;         x231         x232         x233         x234         x235 </span></a>
<a class="sourceLine" id="cb41-95" title="95"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-96" title="96"><span class="co">#&gt;         x236         x237         x238         x239         x240 </span></a>
<a class="sourceLine" id="cb41-97" title="97"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-98" title="98"><span class="co">#&gt;         x241         x242         x243         x244         x245 </span></a>
<a class="sourceLine" id="cb41-99" title="99"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-100" title="100"><span class="co">#&gt;         x246         x247         x248         x249         x250 </span></a>
<a class="sourceLine" id="cb41-101" title="101"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-102" title="102"><span class="co">#&gt;         x251         x252         x253         x254         x255 </span></a>
<a class="sourceLine" id="cb41-103" title="103"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-104" title="104"><span class="co">#&gt;         x256         x257         x258         x259         x260 </span></a>
<a class="sourceLine" id="cb41-105" title="105"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-106" title="106"><span class="co">#&gt;         x261         x262         x263         x264         x265 </span></a>
<a class="sourceLine" id="cb41-107" title="107"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-108" title="108"><span class="co">#&gt;         x266         x267         x268         x269         x270 </span></a>
<a class="sourceLine" id="cb41-109" title="109"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-110" title="110"><span class="co">#&gt;         x271         x272         x273         x274         x275 </span></a>
<a class="sourceLine" id="cb41-111" title="111"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-112" title="112"><span class="co">#&gt;         x276         x277         x278         x279         x280 </span></a>
<a class="sourceLine" id="cb41-113" title="113"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-114" title="114"><span class="co">#&gt;         x281         x282         x283         x284         x285 </span></a>
<a class="sourceLine" id="cb41-115" title="115"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-116" title="116"><span class="co">#&gt;         x286         x287         x288         x289         x290 </span></a>
<a class="sourceLine" id="cb41-117" title="117"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-118" title="118"><span class="co">#&gt;         x291         x292         x293         x294         x295 </span></a>
<a class="sourceLine" id="cb41-119" title="119"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-120" title="120"><span class="co">#&gt;         x296         x297         x298         x299         x300 </span></a>
<a class="sourceLine" id="cb41-121" title="121"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-122" title="122"><span class="co">#&gt;         x301         x302         x303         x304         x305 </span></a>
<a class="sourceLine" id="cb41-123" title="123"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-124" title="124"><span class="co">#&gt;         x306         x307         x308         x309         x310 </span></a>
<a class="sourceLine" id="cb41-125" title="125"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-126" title="126"><span class="co">#&gt;         x311         x312         x313         x314         x315 </span></a>
<a class="sourceLine" id="cb41-127" title="127"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-128" title="128"><span class="co">#&gt;         x316         x317         x318         x319         x320 </span></a>
<a class="sourceLine" id="cb41-129" title="129"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-130" title="130"><span class="co">#&gt;         x321         x322         x323         x324         x325 </span></a>
<a class="sourceLine" id="cb41-131" title="131"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-132" title="132"><span class="co">#&gt;         x326         x327         x328         x329         x330 </span></a>
<a class="sourceLine" id="cb41-133" title="133"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-134" title="134"><span class="co">#&gt;         x331         x332         x333         x334         x335 </span></a>
<a class="sourceLine" id="cb41-135" title="135"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-136" title="136"><span class="co">#&gt;         x336         x337         x338         x339         x340 </span></a>
<a class="sourceLine" id="cb41-137" title="137"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-138" title="138"><span class="co">#&gt;         x341         x342         x343         x344         x345 </span></a>
<a class="sourceLine" id="cb41-139" title="139"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-140" title="140"><span class="co">#&gt;         x346         x347         x348         x349         x350 </span></a>
<a class="sourceLine" id="cb41-141" title="141"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-142" title="142"><span class="co">#&gt;         x351         x352         x353         x354         x355 </span></a>
<a class="sourceLine" id="cb41-143" title="143"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-144" title="144"><span class="co">#&gt;         x356         x357         x358         x359         x360 </span></a>
<a class="sourceLine" id="cb41-145" title="145"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-146" title="146"><span class="co">#&gt;         x361         x362         x363         x364         x365 </span></a>
<a class="sourceLine" id="cb41-147" title="147"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-148" title="148"><span class="co">#&gt;         x366         x367         x368         x369         x370 </span></a>
<a class="sourceLine" id="cb41-149" title="149"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-150" title="150"><span class="co">#&gt;         x371         x372         x373         x374         x375 </span></a>
<a class="sourceLine" id="cb41-151" title="151"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-152" title="152"><span class="co">#&gt;         x376         x377         x378         x379         x380 </span></a>
<a class="sourceLine" id="cb41-153" title="153"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-154" title="154"><span class="co">#&gt;         x381         x382         x383         x384         x385 </span></a>
<a class="sourceLine" id="cb41-155" title="155"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-156" title="156"><span class="co">#&gt;         x386         x387         x388         x389         x390 </span></a>
<a class="sourceLine" id="cb41-157" title="157"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-158" title="158"><span class="co">#&gt;         x391         x392         x393         x394         x395 </span></a>
<a class="sourceLine" id="cb41-159" title="159"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-160" title="160"><span class="co">#&gt;         x396         x397         x398         x399         x400 </span></a>
<a class="sourceLine" id="cb41-161" title="161"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-162" title="162"><span class="co">#&gt;         x401         x402         x403         x404         x405 </span></a>
<a class="sourceLine" id="cb41-163" title="163"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-164" title="164"><span class="co">#&gt;         x406         x407         x408         x409         x410 </span></a>
<a class="sourceLine" id="cb41-165" title="165"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-166" title="166"><span class="co">#&gt;         x411         x412         x413         x414         x415 </span></a>
<a class="sourceLine" id="cb41-167" title="167"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-168" title="168"><span class="co">#&gt;         x416         x417         x418         x419         x420 </span></a>
<a class="sourceLine" id="cb41-169" title="169"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-170" title="170"><span class="co">#&gt;         x421         x422         x423         x424         x425 </span></a>
<a class="sourceLine" id="cb41-171" title="171"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-172" title="172"><span class="co">#&gt;         x426         x427         x428         x429         x430 </span></a>
<a class="sourceLine" id="cb41-173" title="173"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-174" title="174"><span class="co">#&gt;         x431         x432         x433         x434         x435 </span></a>
<a class="sourceLine" id="cb41-175" title="175"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-176" title="176"><span class="co">#&gt;         x436         x437         x438         x439         x440 </span></a>
<a class="sourceLine" id="cb41-177" title="177"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-178" title="178"><span class="co">#&gt;         x441         x442         x443         x444         x445 </span></a>
<a class="sourceLine" id="cb41-179" title="179"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-180" title="180"><span class="co">#&gt;         x446         x447         x448         x449         x450 </span></a>
<a class="sourceLine" id="cb41-181" title="181"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-182" title="182"><span class="co">#&gt;         x451         x452         x453         x454         x455 </span></a>
<a class="sourceLine" id="cb41-183" title="183"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-184" title="184"><span class="co">#&gt;         x456         x457         x458         x459         x460 </span></a>
<a class="sourceLine" id="cb41-185" title="185"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-186" title="186"><span class="co">#&gt;         x461         x462         x463         x464         x465 </span></a>
<a class="sourceLine" id="cb41-187" title="187"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-188" title="188"><span class="co">#&gt;         x466         x467         x468         x469         x470 </span></a>
<a class="sourceLine" id="cb41-189" title="189"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-190" title="190"><span class="co">#&gt;         x471         x472         x473         x474         x475 </span></a>
<a class="sourceLine" id="cb41-191" title="191"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-192" title="192"><span class="co">#&gt;         x476         x477         x478         x479         x480 </span></a>
<a class="sourceLine" id="cb41-193" title="193"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-194" title="194"><span class="co">#&gt;         x481         x482         x483         x484         x485 </span></a>
<a class="sourceLine" id="cb41-195" title="195"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-196" title="196"><span class="co">#&gt;         x486         x487         x488         x489         x490 </span></a>
<a class="sourceLine" id="cb41-197" title="197"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-198" title="198"><span class="co">#&gt;         x491         x492         x493         x494         x495 </span></a>
<a class="sourceLine" id="cb41-199" title="199"><span class="co">#&gt;           NA           NA           NA           NA           NA </span></a>
<a class="sourceLine" id="cb41-200" title="200"><span class="co">#&gt;         x496         x497         x498         x499         x500 </span></a>
<a class="sourceLine" id="cb41-201" title="201"><span class="co">#&gt;           NA           NA           NA           NA           NA</span></a>
<a class="sourceLine" id="cb41-202" title="202"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_mean)</a>
<a class="sourceLine" id="cb41-203" title="203"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">coef_lasso_mean</a>
<a class="sourceLine" id="cb42-2" title="2"><span class="co">#&gt;           x1           x2           x3           x4           x5 </span></a>
<a class="sourceLine" id="cb42-3" title="3"><span class="co">#&gt; 2.884748e-01 2.901325e-01 2.551364e-01 2.539998e-01 2.806796e-01 </span></a>
<a class="sourceLine" id="cb42-4" title="4"><span class="co">#&gt;           x6           x7           x8           x9          x10 </span></a>
<a class="sourceLine" id="cb42-5" title="5"><span class="co">#&gt; 1.054459e-03 1.150511e-02 3.461256e-03 0.000000e+00 5.735264e-03 </span></a>
<a class="sourceLine" id="cb42-6" title="6"><span class="co">#&gt;          x11          x12          x13          x14          x15 </span></a>
<a class="sourceLine" id="cb42-7" title="7"><span class="co">#&gt; 8.909294e-04 8.091381e-03 4.200223e-03 6.154204e-03 3.300430e-03 </span></a>
<a class="sourceLine" id="cb42-8" title="8"><span class="co">#&gt;          x16          x17          x18          x19          x20 </span></a>
<a class="sourceLine" id="cb42-9" title="9"><span class="co">#&gt; 0.000000e+00 7.378325e-04 1.474426e-03 7.912583e-04 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-10" title="10"><span class="co">#&gt;          x21          x22          x23          x24          x25 </span></a>
<a class="sourceLine" id="cb42-11" title="11"><span class="co">#&gt; 3.561937e-03 1.344935e-02 2.796454e-03 0.000000e+00 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-12" title="12"><span class="co">#&gt;          x26          x27          x28          x29          x30 </span></a>
<a class="sourceLine" id="cb42-13" title="13"><span class="co">#&gt; 6.596085e-03 1.182465e-03 0.000000e+00 0.000000e+00 5.313226e-04 </span></a>
<a class="sourceLine" id="cb42-14" title="14"><span class="co">#&gt;          x31          x32          x33          x34          x35 </span></a>
<a class="sourceLine" id="cb42-15" title="15"><span class="co">#&gt; 2.671555e-03 9.870718e-04 0.000000e+00 4.098509e-03 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-16" title="16"><span class="co">#&gt;          x36          x37          x38          x39          x40 </span></a>
<a class="sourceLine" id="cb42-17" title="17"><span class="co">#&gt; 6.317726e-03 1.714907e-03 5.818642e-03 1.806977e-04 4.823576e-03 </span></a>
<a class="sourceLine" id="cb42-18" title="18"><span class="co">#&gt;          x41          x42          x43          x44          x45 </span></a>
<a class="sourceLine" id="cb42-19" title="19"><span class="co">#&gt; 0.000000e+00 5.894325e-03 3.464169e-03 1.929152e-03 3.145499e-03 </span></a>
<a class="sourceLine" id="cb42-20" title="20"><span class="co">#&gt;          x46          x47          x48          x49          x50 </span></a>
<a class="sourceLine" id="cb42-21" title="21"><span class="co">#&gt; 2.519983e-03 5.473620e-03 1.638998e-02 1.143931e-03 1.095974e-03 </span></a>
<a class="sourceLine" id="cb42-22" title="22"><span class="co">#&gt;          x51          x52          x53          x54          x55 </span></a>
<a class="sourceLine" id="cb42-23" title="23"><span class="co">#&gt; 1.664955e-04 0.000000e+00 6.398671e-03 0.000000e+00 4.706701e-04 </span></a>
<a class="sourceLine" id="cb42-24" title="24"><span class="co">#&gt;          x56          x57          x58          x59          x60 </span></a>
<a class="sourceLine" id="cb42-25" title="25"><span class="co">#&gt; 9.093795e-03 0.000000e+00 0.000000e+00 8.643983e-03 2.067534e-03 </span></a>
<a class="sourceLine" id="cb42-26" title="26"><span class="co">#&gt;          x61          x62          x63          x64          x65 </span></a>
<a class="sourceLine" id="cb42-27" title="27"><span class="co">#&gt; 2.135915e-04 1.844471e-03 0.000000e+00 0.000000e+00 3.752576e-03 </span></a>
<a class="sourceLine" id="cb42-28" title="28"><span class="co">#&gt;          x66          x67          x68          x69          x70 </span></a>
<a class="sourceLine" id="cb42-29" title="29"><span class="co">#&gt; 4.890721e-03 0.000000e+00 6.039112e-04 1.868299e-03 1.018851e-03 </span></a>
<a class="sourceLine" id="cb42-30" title="30"><span class="co">#&gt;          x71          x72          x73          x74          x75 </span></a>
<a class="sourceLine" id="cb42-31" title="31"><span class="co">#&gt; 1.646374e-03 2.403692e-03 6.026804e-03 6.962014e-03 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-32" title="32"><span class="co">#&gt;          x76          x77          x78          x79          x80 </span></a>
<a class="sourceLine" id="cb42-33" title="33"><span class="co">#&gt; 2.306817e-04 3.839730e-03 9.217950e-03 6.012937e-04 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-34" title="34"><span class="co">#&gt;          x81          x82          x83          x84          x85 </span></a>
<a class="sourceLine" id="cb42-35" title="35"><span class="co">#&gt; 6.979286e-03 0.000000e+00 0.000000e+00 2.401911e-03 4.909802e-03 </span></a>
<a class="sourceLine" id="cb42-36" title="36"><span class="co">#&gt;          x86          x87          x88          x89          x90 </span></a>
<a class="sourceLine" id="cb42-37" title="37"><span class="co">#&gt; 1.655423e-03 0.000000e+00 2.884180e-03 0.000000e+00 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-38" title="38"><span class="co">#&gt;          x91          x92          x93          x94          x95 </span></a>
<a class="sourceLine" id="cb42-39" title="39"><span class="co">#&gt; 2.372380e-03 3.029237e-03 2.877922e-03 2.744042e-03 1.640034e-03 </span></a>
<a class="sourceLine" id="cb42-40" title="40"><span class="co">#&gt;          x96          x97          x98          x99         x100 </span></a>
<a class="sourceLine" id="cb42-41" title="41"><span class="co">#&gt; 0.000000e+00 0.000000e+00 2.196352e-03 0.000000e+00 2.884404e-03 </span></a>
<a class="sourceLine" id="cb42-42" title="42"><span class="co">#&gt;         x101         x102         x103         x104         x105 </span></a>
<a class="sourceLine" id="cb42-43" title="43"><span class="co">#&gt; 2.545251e-04 8.404968e-04 8.677094e-04 0.000000e+00 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-44" title="44"><span class="co">#&gt;         x106         x107         x108         x109         x110 </span></a>
<a class="sourceLine" id="cb42-45" title="45"><span class="co">#&gt; 1.300548e-03 1.093227e-02 3.595613e-13 2.942981e-04 1.054983e-03 </span></a>
<a class="sourceLine" id="cb42-46" title="46"><span class="co">#&gt;         x111         x112         x113         x114         x115 </span></a>
<a class="sourceLine" id="cb42-47" title="47"><span class="co">#&gt; 7.851609e-03 8.393156e-03 6.675603e-05 3.756990e-03 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-48" title="48"><span class="co">#&gt;         x116         x117         x118         x119         x120 </span></a>
<a class="sourceLine" id="cb42-49" title="49"><span class="co">#&gt; 9.512716e-03 0.000000e+00 3.465779e-03 0.000000e+00 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-50" title="50"><span class="co">#&gt;         x121         x122         x123         x124         x125 </span></a>
<a class="sourceLine" id="cb42-51" title="51"><span class="co">#&gt; 6.053096e-03 1.680116e-03 3.157865e-03 1.803751e-03 1.963759e-04 </span></a>
<a class="sourceLine" id="cb42-52" title="52"><span class="co">#&gt;         x126         x127         x128         x129         x130 </span></a>
<a class="sourceLine" id="cb42-53" title="53"><span class="co">#&gt; 8.011495e-03 3.091165e-03 9.283627e-03 7.783758e-03 7.388000e-04 </span></a>
<a class="sourceLine" id="cb42-54" title="54"><span class="co">#&gt;         x131         x132         x133         x134         x135 </span></a>
<a class="sourceLine" id="cb42-55" title="55"><span class="co">#&gt; 1.482911e-03 5.401912e-03 1.106355e-03 0.000000e+00 3.738097e-13 </span></a>
<a class="sourceLine" id="cb42-56" title="56"><span class="co">#&gt;         x136         x137         x138         x139         x140 </span></a>
<a class="sourceLine" id="cb42-57" title="57"><span class="co">#&gt; 1.062713e-03 2.754979e-03 4.499225e-03 0.000000e+00 8.640881e-05 </span></a>
<a class="sourceLine" id="cb42-58" title="58"><span class="co">#&gt;         x141         x142         x143         x144         x145 </span></a>
<a class="sourceLine" id="cb42-59" title="59"><span class="co">#&gt; 4.836961e-03 0.000000e+00 2.244729e-03 1.080932e-03 4.709850e-03 </span></a>
<a class="sourceLine" id="cb42-60" title="60"><span class="co">#&gt;         x146         x147         x148         x149         x150 </span></a>
<a class="sourceLine" id="cb42-61" title="61"><span class="co">#&gt; 8.922725e-05 4.335968e-03 0.000000e+00 7.932872e-03 1.552719e-03 </span></a>
<a class="sourceLine" id="cb42-62" title="62"><span class="co">#&gt;         x151         x152         x153         x154         x155 </span></a>
<a class="sourceLine" id="cb42-63" title="63"><span class="co">#&gt; 3.009082e-03 1.209795e-02 1.155424e-02 3.562763e-03 1.182077e-02 </span></a>
<a class="sourceLine" id="cb42-64" title="64"><span class="co">#&gt;         x156         x157         x158         x159         x160 </span></a>
<a class="sourceLine" id="cb42-65" title="65"><span class="co">#&gt; 2.588609e-03 3.805900e-03 6.526799e-03 0.000000e+00 4.724274e-03 </span></a>
<a class="sourceLine" id="cb42-66" title="66"><span class="co">#&gt;         x161         x162         x163         x164         x165 </span></a>
<a class="sourceLine" id="cb42-67" title="67"><span class="co">#&gt; 1.897259e-03 6.222351e-03 7.134727e-04 6.424847e-05 3.489814e-03 </span></a>
<a class="sourceLine" id="cb42-68" title="68"><span class="co">#&gt;         x166         x167         x168         x169         x170 </span></a>
<a class="sourceLine" id="cb42-69" title="69"><span class="co">#&gt; 1.465465e-03 6.930260e-04 2.519993e-03 1.600021e-03 7.287719e-04 </span></a>
<a class="sourceLine" id="cb42-70" title="70"><span class="co">#&gt;         x171         x172         x173         x174         x175 </span></a>
<a class="sourceLine" id="cb42-71" title="71"><span class="co">#&gt; 2.185756e-03 8.390096e-03 4.392137e-03 0.000000e+00 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-72" title="72"><span class="co">#&gt;         x176         x177         x178         x179         x180 </span></a>
<a class="sourceLine" id="cb42-73" title="73"><span class="co">#&gt; 4.338646e-03 3.698217e-04 7.418248e-04 3.251755e-04 2.408658e-13 </span></a>
<a class="sourceLine" id="cb42-74" title="74"><span class="co">#&gt;         x181         x182         x183         x184         x185 </span></a>
<a class="sourceLine" id="cb42-75" title="75"><span class="co">#&gt; 0.000000e+00 1.398158e-04 7.723147e-03 8.171550e-03 4.621357e-03 </span></a>
<a class="sourceLine" id="cb42-76" title="76"><span class="co">#&gt;         x186         x187         x188         x189         x190 </span></a>
<a class="sourceLine" id="cb42-77" title="77"><span class="co">#&gt; 0.000000e+00 6.432805e-04 2.641452e-03 2.063362e-03 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-78" title="78"><span class="co">#&gt;         x191         x192         x193         x194         x195 </span></a>
<a class="sourceLine" id="cb42-79" title="79"><span class="co">#&gt; 8.864699e-04 0.000000e+00 5.742162e-04 3.066370e-03 1.541211e-03 </span></a>
<a class="sourceLine" id="cb42-80" title="80"><span class="co">#&gt;         x196         x197         x198         x199         x200 </span></a>
<a class="sourceLine" id="cb42-81" title="81"><span class="co">#&gt; 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 9.127545e-03 </span></a>
<a class="sourceLine" id="cb42-82" title="82"><span class="co">#&gt;         x201         x202         x203         x204         x205 </span></a>
<a class="sourceLine" id="cb42-83" title="83"><span class="co">#&gt; 6.666864e-03 0.000000e+00 1.377348e-03 1.314059e-03 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-84" title="84"><span class="co">#&gt;         x206         x207         x208         x209         x210 </span></a>
<a class="sourceLine" id="cb42-85" title="85"><span class="co">#&gt; 2.648338e-03 2.355800e-03 1.921164e-03 2.659421e-03 5.426419e-03 </span></a>
<a class="sourceLine" id="cb42-86" title="86"><span class="co">#&gt;         x211         x212         x213         x214         x215 </span></a>
<a class="sourceLine" id="cb42-87" title="87"><span class="co">#&gt; 1.665848e-03 8.335670e-03 1.361967e-03 1.873715e-04 3.852283e-03 </span></a>
<a class="sourceLine" id="cb42-88" title="88"><span class="co">#&gt;         x216         x217         x218         x219         x220 </span></a>
<a class="sourceLine" id="cb42-89" title="89"><span class="co">#&gt; 0.000000e+00 5.219588e-03 4.769629e-03 3.414312e-03 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-90" title="90"><span class="co">#&gt;         x221         x222         x223         x224         x225 </span></a>
<a class="sourceLine" id="cb42-91" title="91"><span class="co">#&gt; 5.870329e-03 1.983912e-04 0.000000e+00 2.510588e-03 2.621387e-04 </span></a>
<a class="sourceLine" id="cb42-92" title="92"><span class="co">#&gt;         x226         x227         x228         x229         x230 </span></a>
<a class="sourceLine" id="cb42-93" title="93"><span class="co">#&gt; 5.005981e-03 1.661935e-03 1.964637e-03 0.000000e+00 4.189824e-03 </span></a>
<a class="sourceLine" id="cb42-94" title="94"><span class="co">#&gt;         x231         x232         x233         x234         x235 </span></a>
<a class="sourceLine" id="cb42-95" title="95"><span class="co">#&gt; 0.000000e+00 5.055007e-03 1.051940e-04 2.391811e-03 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-96" title="96"><span class="co">#&gt;         x236         x237         x238         x239         x240 </span></a>
<a class="sourceLine" id="cb42-97" title="97"><span class="co">#&gt; 4.570089e-03 1.648793e-03 4.599661e-03 6.718207e-03 2.623970e-03 </span></a>
<a class="sourceLine" id="cb42-98" title="98"><span class="co">#&gt;         x241         x242         x243         x244         x245 </span></a>
<a class="sourceLine" id="cb42-99" title="99"><span class="co">#&gt; 5.617679e-03 3.835205e-03 0.000000e+00 1.097162e-04 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-100" title="100"><span class="co">#&gt;         x246         x247         x248         x249         x250 </span></a>
<a class="sourceLine" id="cb42-101" title="101"><span class="co">#&gt; 1.740902e-03 6.710349e-03 9.648295e-03 0.000000e+00 2.424279e-03 </span></a>
<a class="sourceLine" id="cb42-102" title="102"><span class="co">#&gt;         x251         x252         x253         x254         x255 </span></a>
<a class="sourceLine" id="cb42-103" title="103"><span class="co">#&gt; 4.392212e-13 0.000000e+00 2.415739e-03 2.856605e-03 1.950805e-03 </span></a>
<a class="sourceLine" id="cb42-104" title="104"><span class="co">#&gt;         x256         x257         x258         x259         x260 </span></a>
<a class="sourceLine" id="cb42-105" title="105"><span class="co">#&gt; 6.416515e-03 0.000000e+00 3.540890e-03 9.224404e-04 4.945168e-03 </span></a>
<a class="sourceLine" id="cb42-106" title="106"><span class="co">#&gt;         x261         x262         x263         x264         x265 </span></a>
<a class="sourceLine" id="cb42-107" title="107"><span class="co">#&gt; 3.018154e-03 0.000000e+00 6.590549e-03 1.661707e-04 2.177644e-03 </span></a>
<a class="sourceLine" id="cb42-108" title="108"><span class="co">#&gt;         x266         x267         x268         x269         x270 </span></a>
<a class="sourceLine" id="cb42-109" title="109"><span class="co">#&gt; 4.040275e-03 5.836884e-03 1.007461e-02 0.000000e+00 1.171146e-04 </span></a>
<a class="sourceLine" id="cb42-110" title="110"><span class="co">#&gt;         x271         x272         x273         x274         x275 </span></a>
<a class="sourceLine" id="cb42-111" title="111"><span class="co">#&gt; 4.767406e-03 8.748554e-04 2.193023e-03 1.677024e-03 5.337584e-04 </span></a>
<a class="sourceLine" id="cb42-112" title="112"><span class="co">#&gt;         x276         x277         x278         x279         x280 </span></a>
<a class="sourceLine" id="cb42-113" title="113"><span class="co">#&gt; 1.167369e-03 2.210347e-03 4.923696e-03 5.596199e-03 4.658485e-03 </span></a>
<a class="sourceLine" id="cb42-114" title="114"><span class="co">#&gt;         x281         x282         x283         x284         x285 </span></a>
<a class="sourceLine" id="cb42-115" title="115"><span class="co">#&gt; 4.262348e-04 1.064898e-03 0.000000e+00 0.000000e+00 4.156769e-03 </span></a>
<a class="sourceLine" id="cb42-116" title="116"><span class="co">#&gt;         x286         x287         x288         x289         x290 </span></a>
<a class="sourceLine" id="cb42-117" title="117"><span class="co">#&gt; 0.000000e+00 5.161943e-04 4.830806e-04 1.824153e-03 2.504789e-03 </span></a>
<a class="sourceLine" id="cb42-118" title="118"><span class="co">#&gt;         x291         x292         x293         x294         x295 </span></a>
<a class="sourceLine" id="cb42-119" title="119"><span class="co">#&gt; 5.602760e-03 1.967933e-03 5.196217e-04 0.000000e+00 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-120" title="120"><span class="co">#&gt;         x296         x297         x298         x299         x300 </span></a>
<a class="sourceLine" id="cb42-121" title="121"><span class="co">#&gt; 1.040225e-02 5.716943e-04 1.916809e-03 1.409348e-03 4.122752e-03 </span></a>
<a class="sourceLine" id="cb42-122" title="122"><span class="co">#&gt;         x301         x302         x303         x304         x305 </span></a>
<a class="sourceLine" id="cb42-123" title="123"><span class="co">#&gt; 1.800248e-03 0.000000e+00 1.251882e-03 1.324179e-02 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-124" title="124"><span class="co">#&gt;         x306         x307         x308         x309         x310 </span></a>
<a class="sourceLine" id="cb42-125" title="125"><span class="co">#&gt; 1.733981e-12 0.000000e+00 3.095729e-03 1.788746e-03 2.185994e-03 </span></a>
<a class="sourceLine" id="cb42-126" title="126"><span class="co">#&gt;         x311         x312         x313         x314         x315 </span></a>
<a class="sourceLine" id="cb42-127" title="127"><span class="co">#&gt; 0.000000e+00 8.622100e-05 5.805288e-03 0.000000e+00 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-128" title="128"><span class="co">#&gt;         x316         x317         x318         x319         x320 </span></a>
<a class="sourceLine" id="cb42-129" title="129"><span class="co">#&gt; 1.102265e-03 0.000000e+00 1.064316e-02 3.649962e-03 4.322998e-03 </span></a>
<a class="sourceLine" id="cb42-130" title="130"><span class="co">#&gt;         x321         x322         x323         x324         x325 </span></a>
<a class="sourceLine" id="cb42-131" title="131"><span class="co">#&gt; 2.219066e-03 0.000000e+00 1.022681e-02 1.492316e-03 6.349565e-03 </span></a>
<a class="sourceLine" id="cb42-132" title="132"><span class="co">#&gt;         x326         x327         x328         x329         x330 </span></a>
<a class="sourceLine" id="cb42-133" title="133"><span class="co">#&gt; 0.000000e+00 3.907393e-04 1.520033e-03 4.190562e-03 5.240449e-03 </span></a>
<a class="sourceLine" id="cb42-134" title="134"><span class="co">#&gt;         x331         x332         x333         x334         x335 </span></a>
<a class="sourceLine" id="cb42-135" title="135"><span class="co">#&gt; 5.838631e-03 6.418808e-03 5.217238e-03 5.826162e-03 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-136" title="136"><span class="co">#&gt;         x336         x337         x338         x339         x340 </span></a>
<a class="sourceLine" id="cb42-137" title="137"><span class="co">#&gt; 2.009058e-03 3.871620e-03 1.605692e-03 4.274339e-03 7.273319e-03 </span></a>
<a class="sourceLine" id="cb42-138" title="138"><span class="co">#&gt;         x341         x342         x343         x344         x345 </span></a>
<a class="sourceLine" id="cb42-139" title="139"><span class="co">#&gt; 7.768548e-03 0.000000e+00 3.344026e-04 3.728876e-03 2.276822e-03 </span></a>
<a class="sourceLine" id="cb42-140" title="140"><span class="co">#&gt;         x346         x347         x348         x349         x350 </span></a>
<a class="sourceLine" id="cb42-141" title="141"><span class="co">#&gt; 2.511963e-03 3.097435e-03 0.000000e+00 6.499804e-03 4.501913e-03 </span></a>
<a class="sourceLine" id="cb42-142" title="142"><span class="co">#&gt;         x351         x352         x353         x354         x355 </span></a>
<a class="sourceLine" id="cb42-143" title="143"><span class="co">#&gt; 3.973247e-03 2.141289e-03 3.350921e-03 4.198793e-03 3.015828e-03 </span></a>
<a class="sourceLine" id="cb42-144" title="144"><span class="co">#&gt;         x356         x357         x358         x359         x360 </span></a>
<a class="sourceLine" id="cb42-145" title="145"><span class="co">#&gt; 0.000000e+00 6.501069e-04 7.179943e-03 0.000000e+00 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-146" title="146"><span class="co">#&gt;         x361         x362         x363         x364         x365 </span></a>
<a class="sourceLine" id="cb42-147" title="147"><span class="co">#&gt; 2.943669e-03 4.114242e-13 1.897425e-03 1.655810e-04 2.796311e-03 </span></a>
<a class="sourceLine" id="cb42-148" title="148"><span class="co">#&gt;         x366         x367         x368         x369         x370 </span></a>
<a class="sourceLine" id="cb42-149" title="149"><span class="co">#&gt; 0.000000e+00 1.827503e-03 6.064246e-03 6.803701e-13 6.120250e-03 </span></a>
<a class="sourceLine" id="cb42-150" title="150"><span class="co">#&gt;         x371         x372         x373         x374         x375 </span></a>
<a class="sourceLine" id="cb42-151" title="151"><span class="co">#&gt; 0.000000e+00 4.126159e-03 9.301222e-03 1.678762e-03 4.312335e-03 </span></a>
<a class="sourceLine" id="cb42-152" title="152"><span class="co">#&gt;         x376         x377         x378         x379         x380 </span></a>
<a class="sourceLine" id="cb42-153" title="153"><span class="co">#&gt; 5.637099e-05 8.482848e-03 2.615446e-03 0.000000e+00 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-154" title="154"><span class="co">#&gt;         x381         x382         x383         x384         x385 </span></a>
<a class="sourceLine" id="cb42-155" title="155"><span class="co">#&gt; 3.816698e-14 4.739195e-04 1.972896e-03 1.118460e-03 9.129771e-04 </span></a>
<a class="sourceLine" id="cb42-156" title="156"><span class="co">#&gt;         x386         x387         x388         x389         x390 </span></a>
<a class="sourceLine" id="cb42-157" title="157"><span class="co">#&gt; 5.196785e-04 2.812467e-03 0.000000e+00 4.830530e-03 6.187864e-03 </span></a>
<a class="sourceLine" id="cb42-158" title="158"><span class="co">#&gt;         x391         x392         x393         x394         x395 </span></a>
<a class="sourceLine" id="cb42-159" title="159"><span class="co">#&gt; 1.073468e-03 0.000000e+00 1.695645e-03 0.000000e+00 3.719987e-03 </span></a>
<a class="sourceLine" id="cb42-160" title="160"><span class="co">#&gt;         x396         x397         x398         x399         x400 </span></a>
<a class="sourceLine" id="cb42-161" title="161"><span class="co">#&gt; 9.932976e-03 0.000000e+00 5.082249e-03 5.253822e-03 1.975627e-04 </span></a>
<a class="sourceLine" id="cb42-162" title="162"><span class="co">#&gt;         x401         x402         x403         x404         x405 </span></a>
<a class="sourceLine" id="cb42-163" title="163"><span class="co">#&gt; 1.547985e-03 6.758293e-03 1.749807e-03 1.104613e-02 3.483874e-04 </span></a>
<a class="sourceLine" id="cb42-164" title="164"><span class="co">#&gt;         x406         x407         x408         x409         x410 </span></a>
<a class="sourceLine" id="cb42-165" title="165"><span class="co">#&gt; 2.115091e-03 0.000000e+00 1.681861e-04 1.048318e-03 2.981392e-03 </span></a>
<a class="sourceLine" id="cb42-166" title="166"><span class="co">#&gt;         x411         x412         x413         x414         x415 </span></a>
<a class="sourceLine" id="cb42-167" title="167"><span class="co">#&gt; 0.000000e+00 1.356487e-02 7.943083e-03 5.804384e-04 2.785778e-03 </span></a>
<a class="sourceLine" id="cb42-168" title="168"><span class="co">#&gt;         x416         x417         x418         x419         x420 </span></a>
<a class="sourceLine" id="cb42-169" title="169"><span class="co">#&gt; 1.419673e-02 9.597402e-03 5.415102e-05 2.396467e-03 1.745279e-04 </span></a>
<a class="sourceLine" id="cb42-170" title="170"><span class="co">#&gt;         x421         x422         x423         x424         x425 </span></a>
<a class="sourceLine" id="cb42-171" title="171"><span class="co">#&gt; 0.000000e+00 3.025163e-03 0.000000e+00 7.828483e-03 4.448357e-03 </span></a>
<a class="sourceLine" id="cb42-172" title="172"><span class="co">#&gt;         x426         x427         x428         x429         x430 </span></a>
<a class="sourceLine" id="cb42-173" title="173"><span class="co">#&gt; 0.000000e+00 2.939679e-03 0.000000e+00 0.000000e+00 1.803727e-03 </span></a>
<a class="sourceLine" id="cb42-174" title="174"><span class="co">#&gt;         x431         x432         x433         x434         x435 </span></a>
<a class="sourceLine" id="cb42-175" title="175"><span class="co">#&gt; 5.564516e-03 2.548174e-03 0.000000e+00 0.000000e+00 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-176" title="176"><span class="co">#&gt;         x436         x437         x438         x439         x440 </span></a>
<a class="sourceLine" id="cb42-177" title="177"><span class="co">#&gt; 1.032089e-02 0.000000e+00 0.000000e+00 5.781873e-04 6.887266e-03 </span></a>
<a class="sourceLine" id="cb42-178" title="178"><span class="co">#&gt;         x441         x442         x443         x444         x445 </span></a>
<a class="sourceLine" id="cb42-179" title="179"><span class="co">#&gt; 0.000000e+00 2.235525e-03 4.720284e-03 1.065163e-03 4.153897e-03 </span></a>
<a class="sourceLine" id="cb42-180" title="180"><span class="co">#&gt;         x446         x447         x448         x449         x450 </span></a>
<a class="sourceLine" id="cb42-181" title="181"><span class="co">#&gt; 2.972775e-03 1.012259e-03 0.000000e+00 5.238939e-04 8.298564e-04 </span></a>
<a class="sourceLine" id="cb42-182" title="182"><span class="co">#&gt;         x451         x452         x453         x454         x455 </span></a>
<a class="sourceLine" id="cb42-183" title="183"><span class="co">#&gt; 0.000000e+00 3.252082e-04 1.736930e-03 1.647522e-03 1.866334e-03 </span></a>
<a class="sourceLine" id="cb42-184" title="184"><span class="co">#&gt;         x456         x457         x458         x459         x460 </span></a>
<a class="sourceLine" id="cb42-185" title="185"><span class="co">#&gt; 0.000000e+00 6.256973e-03 5.571299e-03 0.000000e+00 9.855614e-04 </span></a>
<a class="sourceLine" id="cb42-186" title="186"><span class="co">#&gt;         x461         x462         x463         x464         x465 </span></a>
<a class="sourceLine" id="cb42-187" title="187"><span class="co">#&gt; 3.480294e-03 3.875866e-03 4.083137e-03 6.786353e-04 6.176979e-03 </span></a>
<a class="sourceLine" id="cb42-188" title="188"><span class="co">#&gt;         x466         x467         x468         x469         x470 </span></a>
<a class="sourceLine" id="cb42-189" title="189"><span class="co">#&gt; 4.871904e-03 2.387778e-03 0.000000e+00 1.288935e-03 3.240110e-13 </span></a>
<a class="sourceLine" id="cb42-190" title="190"><span class="co">#&gt;         x471         x472         x473         x474         x475 </span></a>
<a class="sourceLine" id="cb42-191" title="191"><span class="co">#&gt; 2.679720e-03 1.846666e-03 9.498268e-03 0.000000e+00 3.172788e-03 </span></a>
<a class="sourceLine" id="cb42-192" title="192"><span class="co">#&gt;         x476         x477         x478         x479         x480 </span></a>
<a class="sourceLine" id="cb42-193" title="193"><span class="co">#&gt; 1.619901e-03 2.140906e-03 8.174133e-03 2.236198e-03 0.000000e+00 </span></a>
<a class="sourceLine" id="cb42-194" title="194"><span class="co">#&gt;         x481         x482         x483         x484         x485 </span></a>
<a class="sourceLine" id="cb42-195" title="195"><span class="co">#&gt; 1.052667e-03 0.000000e+00 1.610516e-03 0.000000e+00 4.248246e-03 </span></a>
<a class="sourceLine" id="cb42-196" title="196"><span class="co">#&gt;         x486         x487         x488         x489         x490 </span></a>
<a class="sourceLine" id="cb42-197" title="197"><span class="co">#&gt; 1.787803e-03 7.357930e-04 7.940949e-03 3.686511e-03 4.335508e-03 </span></a>
<a class="sourceLine" id="cb42-198" title="198"><span class="co">#&gt;         x491         x492         x493         x494         x495 </span></a>
<a class="sourceLine" id="cb42-199" title="199"><span class="co">#&gt; 1.628482e-03 5.044924e-04 5.611515e-03 1.671282e-05 4.156728e-04 </span></a>
<a class="sourceLine" id="cb42-200" title="200"><span class="co">#&gt;         x496         x497         x498         x499         x500 </span></a>
<a class="sourceLine" id="cb42-201" title="201"><span class="co">#&gt; 9.647665e-04 9.210339e-03 0.000000e+00 5.209398e-04 9.770671e-03</span></a>
<a class="sourceLine" id="cb42-202" title="202"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/barplot">barplot</a></span>(coef_lasso_mean,<span class="dt">ylim=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb42-203" title="203"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h=</span>(minB<span class="op">+</span>maxB)<span class="op">/</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="sim-with-sb_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
<p>The simulation process looks sucessfull: the lasso estimates retrives mostly the correct variables, yet the other ones are also selected sometimes. What are the confidence indices for those variables?</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#contents">Contents</a></li>
      <li>
<a href="#first-example">First example</a><ul class="nav nav-pills nav-stacked">
<li><a href="#aim">Aim</a></li>
      <li><a href="#correlation-structure">Correlation structure</a></li>
      <li><a href="#explanatory-dataset-generation">Explanatory dataset generation</a></li>
      <li><a href="#response-derivation">Response derivation</a></li>
      <li><a href="#multiple-datasets-and-checks">Multiple datasets and checks</a></li>
      </ul>
</li>
      <li>
<a href="#second-example">Second example</a><ul class="nav nav-pills nav-stacked">
<li><a href="#aim-1">Aim</a></li>
      <li><a href="#correlation-structure-1">Correlation structure</a></li>
      <li><a href="#explanatory-variables-and-response">Explanatory variables and response</a></li>
      <li><a href="#checks">Checks</a></li>
      </ul>
</li>
      <li>
<a href="#third-example">Third Example</a><ul class="nav nav-pills nav-stacked">
<li><a href="#aim-2">Aim</a></li>
      <li><a href="#data-and-response-generations">Data and response generations</a></li>
      <li><a href="#checks-1">Checks</a></li>
      </ul>
</li>
      <li>
<a href="#fourth-example">Fourth Example</a><ul class="nav nav-pills nav-stacked">
<li><a href="#aim-3">Aim</a></li>
      <li><a href="#data-and-response-generations-1">Data and response generations</a></li>
      <li><a href="#checks-2">Checks</a></li>
      </ul>
</li>
      <li>
<a href="#fifth-example">Fifth Example</a><ul class="nav nav-pills nav-stacked">
<li><a href="#aim-4">Aim</a></li>
      <li><a href="#correlation-structure-2">Correlation structure</a></li>
      <li><a href="#explanatory-variables-and-response-1">Explanatory variables and response</a></li>
      <li><a href="#checks-3">Checks</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Frederic Bertrand, Myriam Maumy-Bertrand.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
